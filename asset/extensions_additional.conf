;--------------------------------------------------------------------------------;
; Do NOT edit this file as it is auto-generated by IssabelPBX. All modifications ;
; to this file must be done via the web gui. There are alternative files to make ;
; custom modifications, details at: http://issabel.org/configuration_files       ;
;--------------------------------------------------------------------------------;
;

[globals]
QUEUETOGGLE = *45
QUEUEPAUSETOGGLE = *46
OPERATOR_XTN = 
VM_OPTS = 
VM_GAIN = 
VM_DDTYPE = u
VMX_OPTS_LOOP = 
VMX_OPTS_DOVM = 
VMX_TIMEOUT = 2
VMX_REPEAT = 1
VMX_LOOPS = 1
DYNAMIC_FEATURES = apprecord
INTERCOMCODE = nointercom
FAX_RX = system
FAX_RX_EMAIL = fax@mydomain.com
FAX_RX_FROM = fax@issabel.org
ASTETCDIR = /etc/asterisk
ASTMODDIR = /usr/lib64/asterisk/modules
ASTVARLIBDIR = /var/lib/asterisk
ASTAGIDIR = /var/lib/asterisk/agi-bin
ASTSPOOLDIR = /var/spool/asterisk
ASTRUNDIR = /var/run/asterisk
ASTLOGDIR = /var/log/asterisk
CWINUSEBUSY = true
AMPMGRUSER = admin
AMPMGRPASS = admin@2001
AMPDBENGINE = mysql
AMPDBHOST = localhost
AMPDBNAME = asterisk
AMPDBUSER = asteriskuser
AMPDBPASS = Stash@2001
VMX_CONTEXT = from-internal
VMX_PRI = 1
VMX_TIMEDEST_CONTEXT = 
VMX_TIMEDEST_EXT = dovm
VMX_TIMEDEST_PRI = 1
VMX_LOOPDEST_CONTEXT = 
VMX_LOOPDEST_EXT = dovm
VMX_LOOPDEST_PRI = 1
MIXMON_DIR = 
MIXMON_POST = 
DIAL_OPTIONS = tr
TRUNK_OPTIONS = T
TRUNK_RING_TIMER = 300
MIXMON_FORMAT = wav
REC_POLICY = caller
RINGTIMER_DEFAULT = 15
TRANSFER_CONTEXT = from-internal-xfer
ASTVERSION = 11.25.3
ASTCHANDAHDI = 1
NULL = ""
OUT_1 = DAHDI/g0
OUTCID_1 = 
OUTMAXCHANS_1 = 
OUTFAIL_1 = 
OUTPREFIX_1 = 
OUTDISABLE_1 = on
OUTKEEPCID_1 = off
FORCEDOUTCID_1 = 
PREFIX_TRUNK_1 = 
OUT_2 = SIP/1006
OUTCID_2 = 1234512345
OUTMAXCHANS_2 = 
OUTFAIL_2 = 
OUTPREFIX_2 = 
OUTDISABLE_2 = off
OUTKEEPCID_2 = off
FORCEDOUTCID_2 = 
PREFIX_TRUNK_2 = 1
OUT_3 = SIP/1002
OUTCID_3 = 1921681105
OUTMAXCHANS_3 = 32
OUTFAIL_3 = 
OUTPREFIX_3 = 
OUTDISABLE_3 = off
OUTKEEPCID_3 = off
FORCEDOUTCID_3 = 
PREFIX_TRUNK_3 = 1
OUT_4 = SIP/1001
OUTCID_4 = 1234567890
OUTMAXCHANS_4 = 32
OUTFAIL_4 = 
OUTPREFIX_4 = 
OUTDISABLE_4 = off
OUTKEEPCID_4 = off
FORCEDOUTCID_4 = 
PREFIX_TRUNK_4 = 1
OUT_5 = SIP/1004
OUTCID_5 = 
OUTMAXCHANS_5 = 
OUTFAIL_5 = 
OUTPREFIX_5 = 
OUTDISABLE_5 = off
OUTKEEPCID_5 = off
FORCEDOUTCID_5 = 
PREFIX_TRUNK_5 = 1
OUT_7 = SIP/1008
OUTCID_7 = 1122334455
OUTMAXCHANS_7 = 
OUTFAIL_7 = 
OUTPREFIX_7 = 
OUTDISABLE_7 = off
OUTKEEPCID_7 = off
FORCEDOUTCID_7 = 
PREFIX_TRUNK_7 = 
ALLOW_SIP_ANON = no
#include globals_custom.conf

;end of [globals]

[tc-maint]
include => tc-maint-custom
exten => s,1,NoCDR()
exten => s,n,Set(TCMAINT=RETURN)
exten => s,n,Answer
exten => s,n,Hangup

;--== end of [tc-maint] ==--;


[timeconditions]
include => timeconditions-custom
exten => 1,1(falsestate),GotoIf($["${DB(TC/1):0:4}" = "true"]?truegoto)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "false"]?Set(DB(TC/1)=))
exten => 1,n(falsegoto),GotoIf($["${TCMAINT}"!="RETURN"]?ivr-2,s,1)
exten => 1,n,Set(TCSTATE=false)
exten => 1,n,Set(TCOVERRIDE=${IF($["${DB(TC/1):0:5}" = "false"]?true:false)})
exten => 1,n,Return()
exten => 1,n(truestate),GotoIf($["${DB(TC/1):0:5}" = "false"]?falsegoto)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "true"]?Set(DB(TC/1)=))
exten => 1,n(truegoto),GotoIf($["${TCMAINT}"!="RETURN"]?ext-queues,810,1)
exten => 1,n,Set(TCSTATE=true)
exten => 1,n,Set(TCOVERRIDE=${IF($["${DB(TC/1):0:4}" = "true"]?true:false)})
exten => 1,n,Return()

exten => 2,1(falsestate),GotoIf($["${DB(TC/2):0:4}" = "true"]?truegoto)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "false"]?Set(DB(TC/2)=))
exten => 2,n(falsegoto),GotoIf($["${TCMAINT}"!="RETURN"]?ivr-2,s,1)
exten => 2,n,Set(TCSTATE=false)
exten => 2,n,Set(TCOVERRIDE=${IF($["${DB(TC/2):0:5}" = "false"]?true:false)})
exten => 2,n,Return()
exten => 2,n(truestate),GotoIf($["${DB(TC/2):0:5}" = "false"]?falsegoto)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "true"]?Set(DB(TC/2)=))
exten => 2,n(truegoto),GotoIf($["${TCMAINT}"!="RETURN"]?ext-queues,811,1)
exten => 2,n,Set(TCSTATE=true)
exten => 2,n,Set(TCOVERRIDE=${IF($["${DB(TC/2):0:4}" = "true"]?true:false)})
exten => 2,n,Return()

;--== end of [timeconditions] ==--;


[timeconditions-toggles]
include => timeconditions-toggles-custom
exten => *271,1,Macro(user-callerid,)
exten => *271,n,Macro(toggle-tc,1)
exten => *271,n,Hangup

exten => *272,1,Macro(user-callerid,)
exten => *272,n,Macro(toggle-tc,2)
exten => *272,n,Hangup

exten => *27,1,Goto(timeconditions-toggles,${EXTEN}*${AMPUSER},1)

exten => *27*0323,1,Macro(toggle-tc,1&2)

exten => *27*2001,1,Macro(toggle-tc,1&2)

exten => *27*2002,1,Macro(toggle-tc,1&2)

exten => *27*2003,1,Macro(toggle-tc,1&2)

exten => *27*2004,1,Macro(toggle-tc,1&2)

exten => *27*2005,1,Macro(toggle-tc,1&2)

exten => *27*2006,1,Macro(toggle-tc,1&2)

exten => *27*2021,1,Macro(toggle-tc,1&2)

exten => *27*2022,1,Macro(toggle-tc,1&2)

exten => *27*2023,1,Macro(toggle-tc,1&2)

exten => *27*2024,1,Macro(toggle-tc,1&2)

exten => *27*2025,1,Macro(toggle-tc,1&2)

exten => *27*2026,1,Macro(toggle-tc,1&2)

exten => *27*2027,1,Macro(toggle-tc,1&2)

exten => *27*2028,1,Macro(toggle-tc,1&2)

exten => *27*2029,1,Macro(toggle-tc,1&2)

exten => *27*2030,1,Macro(toggle-tc,1&2)

exten => *27*2031,1,Macro(toggle-tc,1&2)

exten => *27*2032,1,Macro(toggle-tc,1&2)

exten => *27*2033,1,Macro(toggle-tc,1&2)

exten => *27*2034,1,Macro(toggle-tc,1&2)

exten => *27*2035,1,Macro(toggle-tc,1&2)

exten => *27*2036,1,Macro(toggle-tc,1&2)

exten => *27*2037,1,Macro(toggle-tc,1&2)

exten => *27*2038,1,Macro(toggle-tc,1&2)

exten => *27*2039,1,Macro(toggle-tc,1&2)

exten => *27*2040,1,Macro(toggle-tc,1&2)

exten => *27*2041,1,Macro(toggle-tc,1&2)

exten => *27*2042,1,Macro(toggle-tc,1&2)

exten => *27*2043,1,Macro(toggle-tc,1&2)

exten => *27*2044,1,Macro(toggle-tc,1&2)

exten => *27*2045,1,Macro(toggle-tc,1&2)

exten => *27*2046,1,Macro(toggle-tc,1&2)

exten => *27*2047,1,Macro(toggle-tc,1&2)

exten => *27*2048,1,Macro(toggle-tc,1&2)

exten => *27*2049,1,Macro(toggle-tc,1&2)

exten => *27*2050,1,Macro(toggle-tc,1&2)

exten => *27*2051,1,Macro(toggle-tc,1&2)

exten => *27*2052,1,Macro(toggle-tc,1&2)

exten => *27*2053,1,Macro(toggle-tc,1&2)

exten => *27*2054,1,Macro(toggle-tc,1&2)

exten => *27*2055,1,Macro(toggle-tc,1&2)

exten => *27*2056,1,Macro(toggle-tc,1&2)

exten => *27*2057,1,Macro(toggle-tc,1&2)

exten => *27*2058,1,Macro(toggle-tc,1&2)

exten => *27*2059,1,Macro(toggle-tc,1&2)

exten => *27*2060,1,Macro(toggle-tc,1&2)

exten => *27*2061,1,Macro(toggle-tc,1&2)

exten => *27*2062,1,Macro(toggle-tc,1&2)

exten => *27*2063,1,Macro(toggle-tc,1&2)

exten => *27*2064,1,Macro(toggle-tc,1&2)

exten => *27*2065,1,Macro(toggle-tc,1&2)

exten => *27*2066,1,Macro(toggle-tc,1&2)

exten => *27*2067,1,Macro(toggle-tc,1&2)

exten => *27*2068,1,Macro(toggle-tc,1&2)

exten => *27*2069,1,Macro(toggle-tc,1&2)

exten => *27*2070,1,Macro(toggle-tc,1&2)

exten => *27*2071,1,Macro(toggle-tc,1&2)

exten => *27*2072,1,Macro(toggle-tc,1&2)

exten => *27*2073,1,Macro(toggle-tc,1&2)

exten => *27*2074,1,Macro(toggle-tc,1&2)

exten => *27*2075,1,Macro(toggle-tc,1&2)

exten => *27*2076,1,Macro(toggle-tc,1&2)

exten => *27*2077,1,Macro(toggle-tc,1&2)

exten => *27*2078,1,Macro(toggle-tc,1&2)

exten => *27*2079,1,Macro(toggle-tc,1&2)

exten => *27*2080,1,Macro(toggle-tc,1&2)

exten => *27*2081,1,Macro(toggle-tc,1&2)

exten => *27*2082,1,Macro(toggle-tc,1&2)

exten => *27*2083,1,Macro(toggle-tc,1&2)

exten => *27*2084,1,Macro(toggle-tc,1&2)

exten => *27*2085,1,Macro(toggle-tc,1&2)

exten => *27*2086,1,Macro(toggle-tc,1&2)

exten => *27*2087,1,Macro(toggle-tc,1&2)

exten => *27*2088,1,Macro(toggle-tc,1&2)

exten => *27*2089,1,Macro(toggle-tc,1&2)

exten => *27*2090,1,Macro(toggle-tc,1&2)

exten => *27*2091,1,Macro(toggle-tc,1&2)

exten => *27*2092,1,Macro(toggle-tc,1&2)

exten => *27*2093,1,Macro(toggle-tc,1&2)

exten => *27*2094,1,Macro(toggle-tc,1&2)

exten => *27*2095,1,Macro(toggle-tc,1&2)

exten => *27*2096,1,Macro(toggle-tc,1&2)

exten => *27*2097,1,Macro(toggle-tc,1&2)

exten => *27*2098,1,Macro(toggle-tc,1&2)

exten => *27*2099,1,Macro(toggle-tc,1&2)

exten => *27*2100,1,Macro(toggle-tc,1&2)

exten => *27*2101,1,Macro(toggle-tc,1&2)

exten => *27*2102,1,Macro(toggle-tc,1&2)

exten => *27*2103,1,Macro(toggle-tc,1&2)

exten => *27*2104,1,Macro(toggle-tc,1&2)

exten => *27*2105,1,Macro(toggle-tc,1&2)

exten => *27*2106,1,Macro(toggle-tc,1&2)

exten => *27*2107,1,Macro(toggle-tc,1&2)

exten => *27*2108,1,Macro(toggle-tc,1&2)

exten => *27*2109,1,Macro(toggle-tc,1&2)

exten => *27*2110,1,Macro(toggle-tc,1&2)

exten => *27*2111,1,Macro(toggle-tc,1&2)

exten => *27*2112,1,Macro(toggle-tc,1&2)

exten => *27*2113,1,Macro(toggle-tc,1&2)

exten => *27*2114,1,Macro(toggle-tc,1&2)

exten => *27*2115,1,Macro(toggle-tc,1&2)

exten => *27*2116,1,Macro(toggle-tc,1&2)

exten => *27*2117,1,Macro(toggle-tc,1&2)

exten => *27*2118,1,Macro(toggle-tc,1&2)

exten => *27*2119,1,Macro(toggle-tc,1&2)

exten => *27*2120,1,Macro(toggle-tc,1&2)

exten => h,1,Hangup

;--== end of [timeconditions-toggles] ==--;


[macro-toggle-tc]
include => macro-toggle-tc-custom
exten => s,1,Set(INDEXES=${ARG1})
exten => s,n,Set(TCMAINT=RETURN)
exten => s,n,Set(TCSTATE=false)
exten => s,n,Set(LOOPCNT=${FIELDQTY(INDEXES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin1),Set(INDEX=${CUT(INDEXES,&,${ITER})})
exten => s,n,Gosub(timeconditions,${INDEX},1())
exten => s,n,Set(TCSTATE_${INDEX}=${TCSTATE})
exten => s,n,ExecIf($["${TCOVERRIDE}" = "true"]?Set(OVERRIDE=true))
exten => s,n(end1),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin1)
exten => s,n,Set(LOOPCNT=${FIELDQTY(INDEXES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin2),Set(INDEX=${CUT(INDEXES,&,${ITER})})
exten => s,n,Set(DB(TC/${INDEX})=${IF($["${OVERRIDE}" = "true"]?:${IF($["${TCSTATE_${INDEX}}" == "true"]?false:true)})})
exten => s,n,Gosub(timeconditions,${INDEX},1())
exten => s,n(end2),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin2)
exten => s,n,GotoIf($["${STAT(e,/var/spool/asterisk/outgoing/schedtc.0.call)}"="1" | "${STAT(e,/var/spool/asterisk/outgoing/schedtc.1.call)}"="1"]?playback)
exten => s,n,System(/var/lib/asterisk/bin/schedtc.php 60 /var/spool/asterisk/outgoing 0)
exten => s,n(playback),Playback(beep&silence/1&time&${IF($["${TCSTATE}" = "true"]?de-activated:activated)})

;--== end of [macro-toggle-tc] ==--;


[ext-fax]
include => ext-fax-custom
exten => s,1,Macro(user-callerid,)
exten => s,n,Noop(Receiving Fax for: ${FAX_RX_EMAIL} , From: ${CALLERID(all)})
exten => s,n(receivefax),StopPlaytones
exten => s,n,ReceiveFAX(${ASTSPOOLDIR}/fax/${UNIQUEID}.tif,f)
exten => s,n,ExecIf($["${FAXSTATUS:0:6}"="FAILED" && "${FAXERROR}"!="INIT_ERROR"]?Set(FAXSTATUS="FAILED: error: ${FAXERROR} statusstr: ${FAXOPT(statusstr)}"))
exten => s,n,Hangup

exten => h,1,GotoIf($[${STAT(e,${ASTSPOOLDIR}/fax/${UNIQUEID}.tif)} = 0]?failed)
exten => h,n(process),GotoIf($[${LEN(${FAX_RX_EMAIL})} = 0]?noemail)
exten => h,n(delete_opt),Set(DELETE_AFTER_SEND=true)
exten => h,n,System(${ASTVARLIBDIR}/bin/fax2mail.php --to "${FAX_RX_EMAIL}" --dest "${FROM_DID}" --callerid '${STRREPLACE(CALLERID(all),',\\')}' --file ${ASTSPOOLDIR}/fax/${UNIQUEID}.tif --exten "${FAX_FOR}" --delete "${DELETE_AFTER_SEND}" --attachformat "${FAX_ATTACH_FORMAT}")
exten => h,n(end),Macro(hangupcall,)
exten => h,n(noemail),Noop(ERROR: No Email Address to send FAX: status: [${FAXSTATUS}],  From: [${CALLERID(all)}])
exten => h,n,Macro(hangupcall,)
exten => h,process+101(failed),Noop(FAX ${FAXSTATUS} for: ${FAX_RX_EMAIL} , From: ${CALLERID(all)})
exten => h,n,Macro(hangupcall,)

;--== end of [ext-fax] ==--;


[app-fax]
include => app-fax-custom
exten => 666,1,Set(FAX_RX_EMAIL=fax@mydomain.com)
exten => 666,n,Goto(ext-fax,s,1)

exten => h,1,Macro(hangupcall,)

;--== end of [app-fax] ==--;


[ext-did-0001]
include => ext-did-0001-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

;--== end of [ext-did-0001] ==--;


[ext-did-0002]
include => ext-did-0002-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => 101,1,Set(__FROM_DID=${EXTEN})
exten => 101,n,Gosub(app-blacklist-check,s,1())
exten => 101,n,Set(CDR(did)=${FROM_DID})
exten => 101,n,ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 101,n,Set(CHANNEL(musicclass)=default)
exten => 101,n,Set(__MOHCLASS=default)
exten => 101,n,Set(__CALLINGPRES_SV=${CALLERPRES()})
exten => 101,n,Set(CALLERPRES()=allowed_not_screened)
exten => 101,n(dest-ext),Goto(ext-queues,813,1)

exten => 128,1,Set(__FROM_DID=${EXTEN})
exten => 128,n,Gosub(app-blacklist-check,s,1())
exten => 128,n,Gosub(cidlookup,cidlookup_1,1())
exten => 128,n,Set(CDR(did)=${FROM_DID})
exten => 128,n,ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 128,n,Set(CHANNEL(musicclass)=default)
exten => 128,n,Set(__MOHCLASS=default)
exten => 128,n,Set(__CALLINGPRES_SV=${CALLERPRES()})
exten => 128,n,Set(CALLERPRES()=allowed_not_screened)
exten => 128,n(dest-ext),Goto(ext-queues,811,1)

exten => 7500,1,Set(__FROM_DID=${EXTEN})
exten => 7500,n,Gosub(app-blacklist-check,s,1())
exten => 7500,n,Set(CDR(did)=${FROM_DID})
exten => 7500,n,ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 7500,n,Set(CHANNEL(musicclass)=default)
exten => 7500,n,Set(__MOHCLASS=default)
exten => 7500,n,Set(__CALLINGPRES_SV=${CALLERPRES()})
exten => 7500,n,Set(CALLERPRES()=allowed_not_screened)
exten => 7500,n(dest-ext),Goto(ext-queues,818,1)

;--== end of [ext-did-0002] ==--;


[app-announcement-5]
include => app-announcement-5-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => s,1,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement After call abandan)
exten => s,n,Playback(custom/after_abandan,noanswer)
exten => s,n,Goto(app-blackhole,hangup,1)

;--== end of [app-announcement-5] ==--;


[app-announcement-4]
include => app-announcement-4-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => s,1,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement APPCALLBACK)
exten => s,n,Playback(custom/callback,noanswer)
exten => s,n,Goto(app-blackhole,hangup,1)

;--== end of [app-announcement-4] ==--;


[app-announcement-2]
include => app-announcement-2-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => s,1,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement INCOMING_SAURABH)
exten => s,n,Playback(custom/incoming_ivr,noanswer)
exten => s,n,Goto(ivr-2,s,1)

;--== end of [app-announcement-2] ==--;


[app-announcement-3]
include => app-announcement-3-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => s,1,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement Saurabh)
exten => s,n,Playback(custom/Saurabh,noanswer)
exten => s,n,Goto(app-blackhole,hangup,1)

;--== end of [app-announcement-3] ==--;


[app-announcement-1]
include => app-announcement-1-custom
exten => fax,1,Goto(${CUT(FAX_DEST,^,1)},${CUT(FAX_DEST,^,2)},${CUT(FAX_DEST,^,3)})

exten => s,1,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement test)
exten => s,n,Playback(custom/test,noanswer)
exten => s,n,Goto(app-blackhole,hangup,1)

;--== end of [app-announcement-1] ==--;


[ivr-2] ; Afteroffice
include => ivr-2-custom
exten => s,1,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/Afteroffice)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => i,1,Playback(sorry-youre-having-problems)
exten => i,n,Goto(hang,1)

exten => t,1,Playback(sorry-youre-having-problems)
exten => t,n,Goto(hang,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/Afteroffice)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-2] ==--;


[ivr-4] ; Call Abandan
include => ivr-4-custom
exten => s,1,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/after_abandan)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => i,1,Playback(sorry-youre-having-problems)
exten => i,n,Goto(hang,1)

exten => t,1,Playback(sorry-youre-having-problems)
exten => t,n,Goto(hang,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/after_abandan)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-4] ==--;


[ivr-3] ; saurabh_incoming
include => ivr-3-custom
exten => s,1,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/incoming_ivr)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => i,1,Playback(sorry-youre-having-problems)
exten => i,n,Goto(hang,1)

exten => t,1,Playback(sorry-youre-having-problems)
exten => t,n,Goto(hang,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/incoming_ivr)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-3] ==--;


[ivr-1] ; Unnamed
include => ivr-1-custom
include => from-did-direct-ivr
exten => s,1,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CDR(disposition)}" = "ANSWERED"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => i,1,Playback(sorry-youre-having-problems)
exten => i,n,Goto(hang,1)

exten => t,1,Playback(sorry-youre-having-problems)
exten => t,n,Goto(hang,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-1] ==--;


[app-queue-toggle]
include => app-queue-toggle-custom
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(QUEUESTAT=LOGGEDOUT)
exten => s,n,AGI(queue_devstate.agi,getqueues,${AMPUSER})
exten => s,n,GotoIf($["${QUEUESTAT}" = "LOGGEDOUT"]?activate)
exten => s,n,GotoIf($["${QUEUESTAT}" = "LOGGEDIN"]?deactivate)
exten => s,n,GotoIf($["${QUEUESTAT}" = "STATIC"]?static:end)
exten => s,n(deactivate),Noop(Agent Logged out)
exten => s,n,Macro(toggle-del-agent,)
exten => s,n(logout),Playback(agent-loggedoff)
exten => s,n,Macro(hangupcall,)
exten => s,n(activate),Noop(Agent Logged In)
exten => s,n,Macro(toggle-add-agent,)
exten => s,n,GotoIf($["${QAGENT_UNAUTHORIZED}"="1"]?logout)
exten => s,n,Playback(agent-loginok)
exten => s,n,SayDigits(${CALLBACKNUM})
exten => s,n,Macro(hangupcall,)
exten => s,n(static),Noop(User is a Static Agent)
exten => s,n,Playback(agent-loginok)
exten => s,n,Macro(hangupcall,)

;--== end of [app-queue-toggle] ==--;


[app-all-queue-toggle]
include => app-all-queue-toggle-custom
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,AGI(queue_devstate.agi,getall,${AMPUSER})
exten => s,n,GotoIf($["${QUEUESTAT}" = "NOQUEUES"]?skip)
exten => s,n,Set(TOGGLE_MACRO=${IF($["${QUEUESTAT}"="LOGGEDOUT"]?toggle-add-agent:toggle-del-agent)})
exten => s,n,Set(LOOPCNTALL=${FIELDQTY(USERQUEUES,-)})
exten => s,n,Set(ITERALL=1)
exten => s,n(begin),Set(QUEUENO=${CUT(USERQUEUES,-,${ITERALL})})
exten => s,n,Set(ITERALL=$[${ITERALL}+1])
exten => s,n,Macro(${TOGGLE_MACRO},)
exten => s,n,GotoIf($[${ITERALL} <= ${LOOPCNTALL}]?begin)
exten => s,n(skip),ExecIf($["${QUEUESTAT}"="LOGGEDIN" | "${QUEUESTAT}"="NOQUEUES"]?Playback(agent-loggedoff))
exten => s,n,ExecIf($["${QUEUESTAT}"="LOGGEDOUT"]?Playback(agent-loginok))
exten => s,n,ExecIf($["${QUEUESTAT}"="LOGGEDOUT"]?SayDigits(${AMPUSER}))
exten => s,n,Macro(hangupcall,)

;--== end of [app-all-queue-toggle] ==--;


[macro-toggle-del-agent]
include => macro-toggle-del-agent-custom
exten => s,1,Wait(1)
exten => s,n,Macro(user-callerid,SKIPTTL,)
exten => s,n,Set(CALLBACKNUM=${AMPUSER})
exten => s,n,RemoveQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n)
exten => s,n,RemoveQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-internal/n)
exten => s,n,UserEvent(RefreshQueue)
exten => s,n,QueueLog(${QUEUENO},MANAGER,${IF($[${LEN(${AMPUSERCIDNAME})}>0]?${AMPUSERCIDNAME}:${AMPUSER})},REMOVEMEMBER,)
exten => s,n,MacroExit()

;--== end of [macro-toggle-del-agent] ==--;


[macro-toggle-add-agent]
include => macro-toggle-add-agent-custom
exten => s,1,Wait(1)
exten => s,n,Macro(user-callerid,SKIPTTL,)
exten => s,n,Set(CALLBACKNUM=${AMPUSER})
exten => s,n,GotoIf($["${DB(QPENALTY/${QUEUENO}/dynmemberonly)}" = "yes" & ${DB_EXISTS(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})} != 1]?invalid)
exten => s,n,ExecIf($["${DB(AMPUSER/${CALLBACKNUM}/queues/qnostate)}" != "ignorestate"]?AddQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})},,${DB(AMPUSER/${CALLBACKNUM}/cidname)},hint:${CALLBACKNUM}@ext-local))
exten => s,n,ExecIf($["${DB(AMPUSER/${CALLBACKNUM}/queues/qnostate)}" = "ignorestate"]?AddQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})},,${DB(AMPUSER/${CALLBACKNUM}/cidname)}))
exten => s,n,UserEvent(AgentLogin,Agent: ${CALLBACKNUM})
exten => s,n,QueueLog(${QUEUENO},MANAGER,${IF($[${LEN(${AMPUSERCIDNAME})}>0]?${AMPUSERCIDNAME}:${AMPUSER})},ADDMEMBER,)
exten => s,n,MacroExit()
exten => s,n(invalid),Playback(pbx-invalid)
exten => s,n,Set(QAGENT_UNAUTHORIZED=1)
exten => s,n,MacroExit()

;--== end of [macro-toggle-add-agent] ==--;


[app-queue-pause-toggle]
include => app-queue-pause-toggle-custom
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(MEMBR=Local/${AMPUSER}@from-queue/n)
exten => s,n,Set(PAUSE_STATE=${QUEUE_MEMBER(${ARG1},paused,${MEMBR})})
exten => s,n,Set(QUEUE_MEMBER(${ARG1},paused,${MEMBR})=${IF($[${PAUSE_STATE}]?0:1)})
exten => s,n,Playback(dictate/pause&${IF($[${PAUSE_STATE}]?de-activated:activated)})
exten => s,n,ExecIf($[${ARG2}]?Return())
exten => s,n,Macro(hangupcall,)

;--== end of [app-queue-pause-toggle] ==--;


[app-all-queue-pause-toggle]
include => app-all-queue-pause-toggle-custom
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,AGI(queue_devstate.agi,toggle-pause-all,${AMPUSER})
exten => s,n,Playback(dictate/pause&${IF($[${TOGGLEPAUSED}]?activated:de-activated)})
exten => s,n,Macro(hangupcall,)

;--== end of [app-all-queue-pause-toggle] ==--;


[ext-queues]
include => ext-queues-custom
exten => 801,1,Macro(user-callerid,)
exten => 801,n,Answer
exten => 801,n,Macro(blkvm-set,reset)
exten => 801,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 801,n,Set(__NODEST=${EXTEN})
exten => 801,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 801,n,Set(VQ_CIDPP=)
exten => 801,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 801,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 801,n,Set(VQ_AINFO=)
exten => 801,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 801,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 801,n,Set(VQ_JOINMSG=)
exten => 801,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 801,n,Set(VQ_MOH=)
exten => 801,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 801,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 801,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 801,n,Set(VQ_RETRY=)
exten => 801,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 801,n,Set(VQ_OPTIONS=)
exten => 801,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 801,n,Set(VQ_GOSUB=)
exten => 801,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 801,n,Set(VQ_AGI=)
exten => 801,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 801,n,Set(VQ_RULE=)
exten => 801,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 801,n,Set(VQ_POSITION=)
exten => 801,n,Set(__MIXMON_FORMAT=wav)
exten => 801,n,Gosub(sub-record-check,s,1(q,801,always))
exten => 801,n,Set(__CWIGNORE=TRUE)
exten => 801,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 801,n,QueueLog(801,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 801,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 801,n,Set(VQ_AANNOUNCE=)
exten => 801,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 801,n,Set(VQ_MAXWAIT=)
exten => 801,n,Set(QUEUENUM=801)
exten => 801,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 801,n(qcall),Queue(801,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 801,n,Macro(blkvm-clr,)
exten => 801,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 801,n,Gosub(sub-record-cancel,s,1())
exten => 801,n,Set(__NODEST=)
exten => 801,n,Set(_QUEUE_PRIO=0)
exten => 801,n,Set(__CWIGNORE=)
exten => 801,n,Set(QDEST=${VQ_DEST})
exten => 801,n,Set(VQ_DEST=)
exten => 801,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 801*,1,Macro(agent-add,801,)

exten => 801**,1,Macro(agent-del,801)

exten => *45801,1,Set(QUEUENO=801)
exten => *45801,n,Goto(app-queue-toggle,s,start)

exten => *46801,1,Gosub(app-queue-pause-toggle,s,1(801))

exten => 802,1,Macro(user-callerid,)
exten => 802,n,Answer
exten => 802,n,Macro(blkvm-set,reset)
exten => 802,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 802,n,Set(__NODEST=${EXTEN})
exten => 802,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 802,n,Set(VQ_CIDPP=)
exten => 802,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 802,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 802,n,Set(VQ_AINFO=)
exten => 802,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 802,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 802,n,Set(VQ_JOINMSG=)
exten => 802,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 802,n,Set(VQ_MOH=)
exten => 802,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 802,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 802,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 802,n,Set(VQ_RETRY=)
exten => 802,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 802,n,Set(VQ_OPTIONS=)
exten => 802,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 802,n,Set(VQ_GOSUB=)
exten => 802,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 802,n,Set(VQ_AGI=)
exten => 802,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 802,n,Set(VQ_RULE=)
exten => 802,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 802,n,Set(VQ_POSITION=)
exten => 802,n,Set(__MIXMON_FORMAT=wav)
exten => 802,n,Gosub(sub-record-check,s,1(q,802,always))
exten => 802,n,Set(__CWIGNORE=TRUE)
exten => 802,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 802,n,QueueLog(802,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 802,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 802,n,Set(VQ_AANNOUNCE=)
exten => 802,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 802,n,Set(VQ_MAXWAIT=)
exten => 802,n,Set(QUEUENUM=802)
exten => 802,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 802,n(qcall),Queue(802,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 802,n,Macro(blkvm-clr,)
exten => 802,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 802,n,Gosub(sub-record-cancel,s,1())
exten => 802,n,Set(__NODEST=)
exten => 802,n,Set(_QUEUE_PRIO=0)
exten => 802,n,Set(__CWIGNORE=)
exten => 802,n,Set(QDEST=${VQ_DEST})
exten => 802,n,Set(VQ_DEST=)
exten => 802,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 802*,1,Macro(agent-add,802,)

exten => 802**,1,Macro(agent-del,802)

exten => *45802,1,Set(QUEUENO=802)
exten => *45802,n,Goto(app-queue-toggle,s,start)

exten => *46802,1,Gosub(app-queue-pause-toggle,s,1(802))

exten => 803,1,Macro(user-callerid,)
exten => 803,n,Answer
exten => 803,n,Macro(blkvm-set,reset)
exten => 803,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 803,n,Set(__NODEST=${EXTEN})
exten => 803,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 803,n,Set(VQ_CIDPP=)
exten => 803,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 803,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 803,n,Set(VQ_AINFO=)
exten => 803,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 803,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 803,n,Set(VQ_JOINMSG=)
exten => 803,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 803,n,Set(VQ_MOH=)
exten => 803,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 803,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 803,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 803,n,Set(VQ_RETRY=)
exten => 803,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 803,n,Set(VQ_OPTIONS=)
exten => 803,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 803,n,Set(VQ_GOSUB=)
exten => 803,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 803,n,Set(VQ_AGI=)
exten => 803,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 803,n,Set(VQ_RULE=)
exten => 803,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 803,n,Set(VQ_POSITION=)
exten => 803,n,Set(__MIXMON_FORMAT=wav)
exten => 803,n,Gosub(sub-record-check,s,1(q,803,always))
exten => 803,n,Set(__CWIGNORE=TRUE)
exten => 803,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 803,n,QueueLog(803,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 803,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 803,n,Set(VQ_AANNOUNCE=)
exten => 803,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 803,n,Set(VQ_MAXWAIT=)
exten => 803,n,Set(QUEUENUM=803)
exten => 803,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 803,n(qcall),Queue(803,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 803,n,Macro(blkvm-clr,)
exten => 803,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 803,n,Gosub(sub-record-cancel,s,1())
exten => 803,n,Set(__NODEST=)
exten => 803,n,Set(_QUEUE_PRIO=0)
exten => 803,n,Set(__CWIGNORE=)
exten => 803,n,Set(QDEST=${VQ_DEST})
exten => 803,n,Set(VQ_DEST=)
exten => 803,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 803*,1,Macro(agent-add,803,)

exten => 803**,1,Macro(agent-del,803)

exten => *45803,1,Set(QUEUENO=803)
exten => *45803,n,Goto(app-queue-toggle,s,start)

exten => *46803,1,Gosub(app-queue-pause-toggle,s,1(803))

exten => 804,1,Macro(user-callerid,)
exten => 804,n,Answer
exten => 804,n,Macro(blkvm-set,reset)
exten => 804,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 804,n,Set(__NODEST=${EXTEN})
exten => 804,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 804,n,Set(VQ_CIDPP=)
exten => 804,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 804,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 804,n,Set(VQ_AINFO=)
exten => 804,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 804,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 804,n,Set(VQ_JOINMSG=)
exten => 804,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 804,n,Set(VQ_MOH=)
exten => 804,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 804,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 804,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 804,n,Set(VQ_RETRY=)
exten => 804,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 804,n,Set(VQ_OPTIONS=)
exten => 804,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 804,n,Set(VQ_GOSUB=)
exten => 804,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 804,n,Set(VQ_AGI=)
exten => 804,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 804,n,Set(VQ_RULE=)
exten => 804,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 804,n,Set(VQ_POSITION=)
exten => 804,n,Set(__MIXMON_FORMAT=wav)
exten => 804,n,Gosub(sub-record-check,s,1(q,804,always))
exten => 804,n,Set(__CWIGNORE=TRUE)
exten => 804,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 804,n,QueueLog(804,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 804,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 804,n,Set(VQ_AANNOUNCE=)
exten => 804,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 804,n,Set(VQ_MAXWAIT=)
exten => 804,n,Set(QUEUENUM=804)
exten => 804,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 804,n(qcall),Queue(804,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 804,n,Macro(blkvm-clr,)
exten => 804,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 804,n,Gosub(sub-record-cancel,s,1())
exten => 804,n,Set(__NODEST=)
exten => 804,n,Set(_QUEUE_PRIO=0)
exten => 804,n,Set(__CWIGNORE=)
exten => 804,n,Set(QDEST=${VQ_DEST})
exten => 804,n,Set(VQ_DEST=)
exten => 804,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 804*,1,Macro(agent-add,804,)

exten => 804**,1,Macro(agent-del,804)

exten => *45804,1,Set(QUEUENO=804)
exten => *45804,n,Goto(app-queue-toggle,s,start)

exten => *46804,1,Gosub(app-queue-pause-toggle,s,1(804))

exten => 805,1,Macro(user-callerid,)
exten => 805,n,Answer
exten => 805,n,Macro(blkvm-set,reset)
exten => 805,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 805,n,Set(__NODEST=${EXTEN})
exten => 805,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 805,n,Set(VQ_CIDPP=)
exten => 805,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 805,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 805,n,Set(VQ_AINFO=)
exten => 805,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 805,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 805,n,Set(VQ_JOINMSG=)
exten => 805,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 805,n,Set(VQ_MOH=)
exten => 805,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 805,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 805,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 805,n,Set(VQ_RETRY=)
exten => 805,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 805,n,Set(VQ_OPTIONS=)
exten => 805,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 805,n,Set(VQ_GOSUB=)
exten => 805,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 805,n,Set(VQ_AGI=)
exten => 805,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 805,n,Set(VQ_RULE=)
exten => 805,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 805,n,Set(VQ_POSITION=)
exten => 805,n,Set(__MIXMON_FORMAT=wav)
exten => 805,n,Gosub(sub-record-check,s,1(q,805,always))
exten => 805,n,Set(__CWIGNORE=TRUE)
exten => 805,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 805,n,QueueLog(805,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 805,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 805,n,Set(VQ_AANNOUNCE=)
exten => 805,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 805,n,Set(VQ_MAXWAIT=)
exten => 805,n,Set(QUEUENUM=805)
exten => 805,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 805,n(qcall),Queue(805,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 805,n,Macro(blkvm-clr,)
exten => 805,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 805,n,Gosub(sub-record-cancel,s,1())
exten => 805,n,Set(__NODEST=)
exten => 805,n,Set(_QUEUE_PRIO=0)
exten => 805,n,Set(__CWIGNORE=)
exten => 805,n,Set(QDEST=${VQ_DEST})
exten => 805,n,Set(VQ_DEST=)
exten => 805,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 805*,1,Macro(agent-add,805,)

exten => 805**,1,Macro(agent-del,805)

exten => *45805,1,Set(QUEUENO=805)
exten => *45805,n,Goto(app-queue-toggle,s,start)

exten => *46805,1,Gosub(app-queue-pause-toggle,s,1(805))

exten => 806,1,Macro(user-callerid,)
exten => 806,n,Answer
exten => 806,n,Macro(blkvm-set,reset)
exten => 806,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 806,n,Set(__NODEST=${EXTEN})
exten => 806,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 806,n,Set(VQ_CIDPP=)
exten => 806,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 806,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 806,n,Set(VQ_AINFO=)
exten => 806,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 806,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 806,n,Set(VQ_JOINMSG=)
exten => 806,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 806,n,Set(VQ_MOH=)
exten => 806,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 806,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 806,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 806,n,Set(VQ_RETRY=)
exten => 806,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 806,n,Set(VQ_OPTIONS=)
exten => 806,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 806,n,Set(VQ_GOSUB=)
exten => 806,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 806,n,Set(VQ_AGI=)
exten => 806,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 806,n,Set(VQ_RULE=)
exten => 806,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 806,n,Set(VQ_POSITION=)
exten => 806,n,Set(__MIXMON_FORMAT=wav)
exten => 806,n,Gosub(sub-record-check,s,1(q,806,always))
exten => 806,n,Set(__CWIGNORE=TRUE)
exten => 806,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 806,n,QueueLog(806,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 806,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 806,n,Set(VQ_AANNOUNCE=)
exten => 806,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 806,n,Set(VQ_MAXWAIT=)
exten => 806,n,Set(QUEUENUM=806)
exten => 806,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 806,n(qcall),Queue(806,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 806,n,Macro(blkvm-clr,)
exten => 806,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 806,n,Gosub(sub-record-cancel,s,1())
exten => 806,n,Set(__NODEST=)
exten => 806,n,Set(_QUEUE_PRIO=0)
exten => 806,n,Set(__CWIGNORE=)
exten => 806,n,Set(QDEST=${VQ_DEST})
exten => 806,n,Set(VQ_DEST=)
exten => 806,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 806*,1,Macro(agent-add,806,)

exten => 806**,1,Macro(agent-del,806)

exten => *45806,1,Set(QUEUENO=806)
exten => *45806,n,Goto(app-queue-toggle,s,start)

exten => *46806,1,Gosub(app-queue-pause-toggle,s,1(806))

exten => 807,1,Macro(user-callerid,)
exten => 807,n,Answer
exten => 807,n,Macro(blkvm-set,reset)
exten => 807,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 807,n,Set(__NODEST=${EXTEN})
exten => 807,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 807,n,Set(VQ_CIDPP=)
exten => 807,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 807,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 807,n,Set(VQ_AINFO=)
exten => 807,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 807,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 807,n,Set(VQ_JOINMSG=)
exten => 807,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 807,n,Set(VQ_MOH=)
exten => 807,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 807,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 807,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 807,n,Set(VQ_RETRY=)
exten => 807,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 807,n,Set(VQ_OPTIONS=)
exten => 807,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 807,n,Set(VQ_GOSUB=)
exten => 807,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 807,n,Set(VQ_AGI=)
exten => 807,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 807,n,Set(VQ_RULE=)
exten => 807,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 807,n,Set(VQ_POSITION=)
exten => 807,n,Set(__MIXMON_FORMAT=wav)
exten => 807,n,Gosub(sub-record-check,s,1(q,807,always))
exten => 807,n,Set(__CWIGNORE=TRUE)
exten => 807,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 807,n,QueueLog(807,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 807,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 807,n,Set(VQ_AANNOUNCE=)
exten => 807,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 807,n,Set(VQ_MAXWAIT=)
exten => 807,n,Set(QUEUENUM=807)
exten => 807,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 807,n(qcall),Queue(807,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 807,n,Macro(blkvm-clr,)
exten => 807,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 807,n,Gosub(sub-record-cancel,s,1())
exten => 807,n,Set(__NODEST=)
exten => 807,n,Set(_QUEUE_PRIO=0)
exten => 807,n,Set(__CWIGNORE=)
exten => 807,n,Set(QDEST=${VQ_DEST})
exten => 807,n,Set(VQ_DEST=)
exten => 807,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 807*,1,Macro(agent-add,807,)

exten => 807**,1,Macro(agent-del,807)

exten => *45807,1,Set(QUEUENO=807)
exten => *45807,n,Goto(app-queue-toggle,s,start)

exten => *46807,1,Gosub(app-queue-pause-toggle,s,1(807))

exten => 808,1,Macro(user-callerid,)
exten => 808,n,Answer
exten => 808,n,Macro(blkvm-set,reset)
exten => 808,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 808,n,Set(__NODEST=${EXTEN})
exten => 808,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 808,n,Set(VQ_CIDPP=)
exten => 808,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 808,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 808,n,Set(VQ_AINFO=)
exten => 808,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 808,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 808,n,Set(VQ_JOINMSG=)
exten => 808,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 808,n,Set(VQ_MOH=)
exten => 808,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 808,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 808,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 808,n,Set(VQ_RETRY=)
exten => 808,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 808,n,Set(VQ_OPTIONS=)
exten => 808,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 808,n,Set(VQ_GOSUB=)
exten => 808,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 808,n,Set(VQ_AGI=)
exten => 808,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 808,n,Set(VQ_RULE=)
exten => 808,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 808,n,Set(VQ_POSITION=)
exten => 808,n,Set(__MIXMON_FORMAT=wav)
exten => 808,n,Gosub(sub-record-check,s,1(q,808,always))
exten => 808,n,Set(__CWIGNORE=TRUE)
exten => 808,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 808,n,QueueLog(808,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 808,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 808,n,Set(VQ_AANNOUNCE=)
exten => 808,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 808,n,Set(VQ_MAXWAIT=)
exten => 808,n,Set(QUEUENUM=808)
exten => 808,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 808,n(qcall),Queue(808,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 808,n,Macro(blkvm-clr,)
exten => 808,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 808,n,Gosub(sub-record-cancel,s,1())
exten => 808,n,Set(__NODEST=)
exten => 808,n,Set(_QUEUE_PRIO=0)
exten => 808,n,Set(__CWIGNORE=)
exten => 808,n,Set(QDEST=${VQ_DEST})
exten => 808,n,Set(VQ_DEST=)
exten => 808,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 808*,1,Macro(agent-add,808,)

exten => 808**,1,Macro(agent-del,808)

exten => *45808,1,Set(QUEUENO=808)
exten => *45808,n,Goto(app-queue-toggle,s,start)

exten => *46808,1,Gosub(app-queue-pause-toggle,s,1(808))

exten => 809,1,Macro(user-callerid,)
exten => 809,n,Answer
exten => 809,n,Macro(blkvm-set,reset)
exten => 809,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 809,n,Set(__NODEST=${EXTEN})
exten => 809,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 809,n,Set(VQ_CIDPP=)
exten => 809,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 809,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 809,n,Set(VQ_AINFO=)
exten => 809,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 809,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 809,n,Set(VQ_JOINMSG=)
exten => 809,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 809,n,Set(VQ_MOH=)
exten => 809,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 809,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 809,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 809,n,Set(VQ_RETRY=)
exten => 809,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 809,n,Set(VQ_OPTIONS=)
exten => 809,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 809,n,Set(VQ_GOSUB=)
exten => 809,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 809,n,Set(VQ_AGI=)
exten => 809,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 809,n,Set(VQ_RULE=)
exten => 809,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 809,n,Set(VQ_POSITION=)
exten => 809,n,Set(__MIXMON_FORMAT=wav)
exten => 809,n,Gosub(sub-record-check,s,1(q,809,always))
exten => 809,n,Set(__CWIGNORE=TRUE)
exten => 809,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 809,n,QueueLog(809,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 809,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 809,n,Set(VQ_AANNOUNCE=)
exten => 809,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 809,n,Set(VQ_MAXWAIT=)
exten => 809,n,Set(QUEUENUM=809)
exten => 809,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 809,n(qcall),Queue(809,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 809,n,Macro(blkvm-clr,)
exten => 809,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 809,n,Gosub(sub-record-cancel,s,1())
exten => 809,n,Set(__NODEST=)
exten => 809,n,Set(_QUEUE_PRIO=0)
exten => 809,n,Set(__CWIGNORE=)
exten => 809,n,Set(QDEST=${VQ_DEST})
exten => 809,n,Set(VQ_DEST=)
exten => 809,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 809*,1,Macro(agent-add,809,)

exten => 809**,1,Macro(agent-del,809)

exten => *45809,1,Set(QUEUENO=809)
exten => *45809,n,Goto(app-queue-toggle,s,start)

exten => *46809,1,Gosub(app-queue-pause-toggle,s,1(809))

exten => 810,1,Macro(user-callerid,)
exten => 810,n,Answer
exten => 810,n,Macro(blkvm-set,reset)
exten => 810,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 810,n,Set(__NODEST=${EXTEN})
exten => 810,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 810,n,Set(VQ_CIDPP=)
exten => 810,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 810,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 810,n,Set(VQ_AINFO=)
exten => 810,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 810,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 810,n,Set(VQ_JOINMSG=)
exten => 810,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 810,n,Set(VQ_MOH=)
exten => 810,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 810,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 810,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 810,n,Set(VQ_RETRY=)
exten => 810,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 810,n,Set(VQ_OPTIONS=)
exten => 810,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 810,n,Set(VQ_GOSUB=)
exten => 810,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 810,n,Set(VQ_AGI=)
exten => 810,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 810,n,Set(VQ_RULE=)
exten => 810,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 810,n,Set(VQ_POSITION=)
exten => 810,n,Set(__MIXMON_FORMAT=wav)
exten => 810,n,Gosub(sub-record-check,s,1(q,810,always))
exten => 810,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 810,n,QueueLog(810,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 810,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 810,n,Set(VQ_AANNOUNCE=)
exten => 810,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 810,n,Set(VQ_MAXWAIT=)
exten => 810,n,Set(QUEUENUM=810)
exten => 810,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 810,n(qcall),Queue(810,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 810,n,Macro(blkvm-clr,)
exten => 810,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 810,n,Gosub(sub-record-cancel,s,1())
exten => 810,n,Set(__NODEST=)
exten => 810,n,Set(_QUEUE_PRIO=0)
exten => 810,n,Set(QDEST=${VQ_DEST})
exten => 810,n,Set(VQ_DEST=)
exten => 810,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 810*,1,Macro(agent-add,810,)

exten => 810**,1,Macro(agent-del,810)

exten => *45810,1,Set(QUEUENO=810)
exten => *45810,n,Goto(app-queue-toggle,s,start)

exten => *46810,1,Gosub(app-queue-pause-toggle,s,1(810))

exten => 811,1,Macro(user-callerid,)
exten => 811,n,Answer
exten => 811,n,Macro(blkvm-set,reset)
exten => 811,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 811,n,Set(__NODEST=${EXTEN})
exten => 811,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 811,n,Set(VQ_CIDPP=)
exten => 811,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 811,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 811,n,Set(VQ_AINFO=)
exten => 811,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 811,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 811,n,Set(VQ_JOINMSG=)
exten => 811,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 811,n,Set(VQ_MOH=)
exten => 811,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 811,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 811,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 811,n,Set(VQ_RETRY=)
exten => 811,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 811,n,Set(VQ_OPTIONS=)
exten => 811,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 811,n,Set(VQ_GOSUB=)
exten => 811,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 811,n,Set(VQ_AGI=)
exten => 811,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 811,n,Set(VQ_RULE=)
exten => 811,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 811,n,Set(VQ_POSITION=)
exten => 811,n,Set(__MIXMON_FORMAT=wav)
exten => 811,n,Gosub(sub-record-check,s,1(q,811,always))
exten => 811,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 811,n,QueueLog(811,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 811,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 811,n,Set(VQ_AANNOUNCE=)
exten => 811,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 811,n,Set(VQ_MAXWAIT=)
exten => 811,n,Set(QUEUENUM=811)
exten => 811,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 811,n(qcall),Queue(811,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 811,n,Macro(blkvm-clr,)
exten => 811,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 811,n,Gosub(sub-record-cancel,s,1())
exten => 811,n,Set(__NODEST=)
exten => 811,n,Set(_QUEUE_PRIO=0)
exten => 811,n,Set(QDEST=${VQ_DEST})
exten => 811,n,Set(VQ_DEST=)
exten => 811,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 811*,1,Macro(agent-add,811,)

exten => 811**,1,Macro(agent-del,811)

exten => *45811,1,Set(QUEUENO=811)
exten => *45811,n,Goto(app-queue-toggle,s,start)

exten => *46811,1,Gosub(app-queue-pause-toggle,s,1(811))

exten => 812,1,Macro(user-callerid,)
exten => 812,n,Answer
exten => 812,n,Macro(blkvm-set,reset)
exten => 812,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 812,n,Set(__NODEST=${EXTEN})
exten => 812,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 812,n,Set(VQ_CIDPP=)
exten => 812,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 812,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 812,n,Set(VQ_AINFO=)
exten => 812,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 812,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 812,n,Set(VQ_JOINMSG=)
exten => 812,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 812,n,Set(VQ_MOH=)
exten => 812,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 812,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 812,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 812,n,Set(VQ_RETRY=)
exten => 812,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 812,n,Set(VQ_OPTIONS=)
exten => 812,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 812,n,Set(VQ_GOSUB=)
exten => 812,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 812,n,Set(VQ_AGI=)
exten => 812,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 812,n,Set(VQ_RULE=)
exten => 812,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 812,n,Set(VQ_POSITION=)
exten => 812,n,Set(__MIXMON_FORMAT=wav)
exten => 812,n,Gosub(sub-record-check,s,1(q,812,always))
exten => 812,n,Set(__CWIGNORE=TRUE)
exten => 812,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 812,n,QueueLog(812,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 812,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 812,n,Set(VQ_AANNOUNCE=)
exten => 812,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 812,n,Set(VQ_MAXWAIT=)
exten => 812,n,Set(QUEUENUM=812)
exten => 812,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 812,n(qcall),Queue(812,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 812,n,Macro(blkvm-clr,)
exten => 812,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 812,n,Gosub(sub-record-cancel,s,1())
exten => 812,n,Set(__NODEST=)
exten => 812,n,Set(_QUEUE_PRIO=0)
exten => 812,n,Set(__CWIGNORE=)
exten => 812,n,Set(QDEST=${VQ_DEST})
exten => 812,n,Set(VQ_DEST=)
exten => 812,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 812*,1,Macro(agent-add,812,)

exten => 812**,1,Macro(agent-del,812)

exten => *45812,1,Set(QUEUENO=812)
exten => *45812,n,Goto(app-queue-toggle,s,start)

exten => *46812,1,Gosub(app-queue-pause-toggle,s,1(812))

exten => 813,1,Macro(user-callerid,)
exten => 813,n,Answer
exten => 813,n,Macro(blkvm-set,reset)
exten => 813,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 813,n,Set(__NODEST=${EXTEN})
exten => 813,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 813,n,Set(VQ_CIDPP=)
exten => 813,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 813,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 813,n,Set(VQ_AINFO=)
exten => 813,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 813,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}:custom/incoming_ivr)})
exten => 813,n,Set(VQ_JOINMSG=)
exten => 813,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 813,n,Set(VQ_MOH=)
exten => 813,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 813,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 813,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 813,n,Set(VQ_RETRY=)
exten => 813,n,Set(VQ_CONTINUE=c)
exten => 813,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 813,n,Set(VQ_OPTIONS=)
exten => 813,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 813,n,Set(VQ_GOSUB=)
exten => 813,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 813,n,Set(VQ_AGI=)
exten => 813,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 813,n,Set(VQ_RULE=)
exten => 813,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 813,n,Set(VQ_POSITION=)
exten => 813,n,Gosub(sub-record-check,s,1(q,813,dontcare))
exten => 813,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 813,n,QueueLog(813,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 813,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}:custom/incoming_ivr)})
exten => 813,n,Set(VQ_AANNOUNCE=)
exten => 813,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}:1)})
exten => 813,n,Set(VQ_MAXWAIT=)
exten => 813,n,Set(QUEUENUM=813)
exten => 813,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 813,n(qcall),Queue(813,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 813,n,Macro(blkvm-clr,)
exten => 813,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 813,n,Gosub(sub-record-cancel,s,1())
exten => 813,n,Set(__NODEST=)
exten => 813,n,Set(_QUEUE_PRIO=0)
exten => 813,n,Set(QDEST=${VQ_DEST})
exten => 813,n,Set(VQ_DEST=)
exten => 813,n(gotocontinue),GotoIf($["${QUEUESTATUS}"="CONTINUE"]?ivr-3,s,1)
exten => 813,n(gotodest),GotoIf($["${QDEST}"=""]?ivr-3,s,1:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 813*,1,Macro(agent-add,813,)

exten => 813**,1,Macro(agent-del,813)

exten => *45813,1,Set(QUEUENO=813)
exten => *45813,n,Goto(app-queue-toggle,s,start)

exten => *46813,1,Gosub(app-queue-pause-toggle,s,1(813))

exten => 814,1,Macro(user-callerid,)
exten => 814,n,Answer
exten => 814,n,Macro(blkvm-set,reset)
exten => 814,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 814,n,Set(__NODEST=${EXTEN})
exten => 814,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 814,n,Set(VQ_CIDPP=)
exten => 814,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 814,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 814,n,Set(VQ_AINFO=)
exten => 814,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 814,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 814,n,Set(VQ_JOINMSG=)
exten => 814,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 814,n,Set(VQ_MOH=)
exten => 814,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 814,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 814,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 814,n,Set(VQ_RETRY=)
exten => 814,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 814,n,Set(VQ_OPTIONS=)
exten => 814,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 814,n,Set(VQ_GOSUB=)
exten => 814,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 814,n,Set(VQ_AGI=)
exten => 814,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 814,n,Set(VQ_RULE=)
exten => 814,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 814,n,Set(VQ_POSITION=)
exten => 814,n,Set(__MIXMON_FORMAT=wav)
exten => 814,n,Gosub(sub-record-check,s,1(q,814,always))
exten => 814,n,Set(__CWIGNORE=TRUE)
exten => 814,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 814,n,QueueLog(814,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 814,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 814,n,Set(VQ_AANNOUNCE=)
exten => 814,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 814,n,Set(VQ_MAXWAIT=)
exten => 814,n,Set(QUEUENUM=814)
exten => 814,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 814,n(qcall),Queue(814,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 814,n,Macro(blkvm-clr,)
exten => 814,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 814,n,Gosub(sub-record-cancel,s,1())
exten => 814,n,Set(__NODEST=)
exten => 814,n,Set(_QUEUE_PRIO=0)
exten => 814,n,Set(__CWIGNORE=)
exten => 814,n,Set(QDEST=${VQ_DEST})
exten => 814,n,Set(VQ_DEST=)
exten => 814,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 814*,1,Macro(agent-add,814,)

exten => 814**,1,Macro(agent-del,814)

exten => *45814,1,Set(QUEUENO=814)
exten => *45814,n,Goto(app-queue-toggle,s,start)

exten => *46814,1,Gosub(app-queue-pause-toggle,s,1(814))

exten => 815,1,Macro(user-callerid,)
exten => 815,n,Answer
exten => 815,n,Macro(blkvm-set,reset)
exten => 815,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 815,n,Set(__NODEST=${EXTEN})
exten => 815,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 815,n,Set(VQ_CIDPP=)
exten => 815,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 815,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 815,n,Set(VQ_AINFO=)
exten => 815,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 815,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 815,n,Set(VQ_JOINMSG=)
exten => 815,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 815,n,Set(VQ_MOH=)
exten => 815,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 815,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 815,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 815,n,Set(VQ_RETRY=)
exten => 815,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 815,n,Set(VQ_OPTIONS=)
exten => 815,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 815,n,Set(VQ_GOSUB=)
exten => 815,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 815,n,Set(VQ_AGI=)
exten => 815,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 815,n,Set(VQ_RULE=)
exten => 815,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 815,n,Set(VQ_POSITION=)
exten => 815,n,Set(__MIXMON_FORMAT=wav)
exten => 815,n,Gosub(sub-record-check,s,1(q,815,always))
exten => 815,n,Set(__CWIGNORE=TRUE)
exten => 815,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 815,n,QueueLog(815,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 815,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 815,n,Set(VQ_AANNOUNCE=)
exten => 815,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 815,n,Set(VQ_MAXWAIT=)
exten => 815,n,Set(QUEUENUM=815)
exten => 815,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 815,n(qcall),Queue(815,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 815,n,Macro(blkvm-clr,)
exten => 815,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 815,n,Gosub(sub-record-cancel,s,1())
exten => 815,n,Set(__NODEST=)
exten => 815,n,Set(_QUEUE_PRIO=0)
exten => 815,n,Set(__CWIGNORE=)
exten => 815,n,Set(QDEST=${VQ_DEST})
exten => 815,n,Set(VQ_DEST=)
exten => 815,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 815*,1,Macro(agent-add,815,)

exten => 815**,1,Macro(agent-del,815)

exten => *45815,1,Set(QUEUENO=815)
exten => *45815,n,Goto(app-queue-toggle,s,start)

exten => *46815,1,Gosub(app-queue-pause-toggle,s,1(815))

exten => 816,1,Macro(user-callerid,)
exten => 816,n,Answer
exten => 816,n,Macro(blkvm-set,reset)
exten => 816,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 816,n,Set(__NODEST=${EXTEN})
exten => 816,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 816,n,Set(VQ_CIDPP=)
exten => 816,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 816,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 816,n,Set(VQ_AINFO=)
exten => 816,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 816,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 816,n,Set(VQ_JOINMSG=)
exten => 816,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 816,n,Set(VQ_MOH=)
exten => 816,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 816,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 816,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 816,n,Set(VQ_RETRY=)
exten => 816,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 816,n,Set(VQ_OPTIONS=)
exten => 816,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 816,n,Set(VQ_GOSUB=)
exten => 816,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 816,n,Set(VQ_AGI=)
exten => 816,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 816,n,Set(VQ_RULE=)
exten => 816,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 816,n,Set(VQ_POSITION=)
exten => 816,n,Set(__MIXMON_FORMAT=wav)
exten => 816,n,Gosub(sub-record-check,s,1(q,816,always))
exten => 816,n,Set(__CWIGNORE=TRUE)
exten => 816,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 816,n,QueueLog(816,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 816,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 816,n,Set(VQ_AANNOUNCE=)
exten => 816,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 816,n,Set(VQ_MAXWAIT=)
exten => 816,n,Set(QUEUENUM=816)
exten => 816,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 816,n(qcall),Queue(816,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 816,n,Macro(blkvm-clr,)
exten => 816,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 816,n,Gosub(sub-record-cancel,s,1())
exten => 816,n,Set(__NODEST=)
exten => 816,n,Set(_QUEUE_PRIO=0)
exten => 816,n,Set(__CWIGNORE=)
exten => 816,n,Set(QDEST=${VQ_DEST})
exten => 816,n,Set(VQ_DEST=)
exten => 816,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 816*,1,Macro(agent-add,816,)

exten => 816**,1,Macro(agent-del,816)

exten => *45816,1,Set(QUEUENO=816)
exten => *45816,n,Goto(app-queue-toggle,s,start)

exten => *46816,1,Gosub(app-queue-pause-toggle,s,1(816))

exten => 817,1,Macro(user-callerid,)
exten => 817,n,Answer
exten => 817,n,Macro(blkvm-set,reset)
exten => 817,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 817,n,Set(__NODEST=${EXTEN})
exten => 817,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 817,n,Set(VQ_CIDPP=)
exten => 817,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 817,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 817,n,Set(VQ_AINFO=)
exten => 817,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 817,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 817,n,Set(VQ_JOINMSG=)
exten => 817,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 817,n,Set(VQ_MOH=)
exten => 817,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 817,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 817,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 817,n,Set(VQ_RETRY=)
exten => 817,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 817,n,Set(VQ_OPTIONS=)
exten => 817,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 817,n,Set(VQ_GOSUB=)
exten => 817,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 817,n,Set(VQ_AGI=)
exten => 817,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 817,n,Set(VQ_RULE=)
exten => 817,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 817,n,Set(VQ_POSITION=)
exten => 817,n,Set(__MIXMON_FORMAT=wav)
exten => 817,n,Gosub(sub-record-check,s,1(q,817,always))
exten => 817,n,Set(__CWIGNORE=TRUE)
exten => 817,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 817,n,QueueLog(817,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 817,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 817,n,Set(VQ_AANNOUNCE=)
exten => 817,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 817,n,Set(VQ_MAXWAIT=)
exten => 817,n,Set(QUEUENUM=817)
exten => 817,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 817,n(qcall),Queue(817,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 817,n,Macro(blkvm-clr,)
exten => 817,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 817,n,Gosub(sub-record-cancel,s,1())
exten => 817,n,Set(__NODEST=)
exten => 817,n,Set(_QUEUE_PRIO=0)
exten => 817,n,Set(__CWIGNORE=)
exten => 817,n,Set(QDEST=${VQ_DEST})
exten => 817,n,Set(VQ_DEST=)
exten => 817,n(gotodest),GotoIf($["${QDEST}"=""]?app-announcement-2,s,1:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 817*,1,Macro(agent-add,817,)

exten => 817**,1,Macro(agent-del,817)

exten => *45817,1,Set(QUEUENO=817)
exten => *45817,n,Goto(app-queue-toggle,s,start)

exten => *46817,1,Gosub(app-queue-pause-toggle,s,1(817))

exten => 818,1,Macro(user-callerid,)
exten => 818,n,Answer
exten => 818,n,Macro(blkvm-set,reset)
exten => 818,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 818,n,Set(__NODEST=${EXTEN})
exten => 818,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 818,n,Set(VQ_CIDPP=)
exten => 818,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 818,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 818,n,Set(VQ_AINFO=)
exten => 818,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 818,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 818,n,Set(VQ_JOINMSG=)
exten => 818,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 818,n,Set(VQ_MOH=)
exten => 818,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 818,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 818,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 818,n,Set(VQ_RETRY=)
exten => 818,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 818,n,Set(VQ_OPTIONS=)
exten => 818,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 818,n,Set(VQ_GOSUB=)
exten => 818,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 818,n,Set(VQ_AGI=)
exten => 818,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 818,n,Set(VQ_RULE=)
exten => 818,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 818,n,Set(VQ_POSITION=)
exten => 818,n,Set(__MIXMON_FORMAT=wav)
exten => 818,n,Gosub(sub-record-check,s,1(q,818,always))
exten => 818,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 818,n,QueueLog(818,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 818,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 818,n,Set(VQ_AANNOUNCE=)
exten => 818,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}:120)})
exten => 818,n,Set(VQ_MAXWAIT=)
exten => 818,n,Set(QUEUENUM=818)
exten => 818,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 818,n(qcall),Queue(818,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 818,n,Macro(blkvm-clr,)
exten => 818,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 818,n,Gosub(sub-record-cancel,s,1())
exten => 818,n,Set(__NODEST=)
exten => 818,n,Set(_QUEUE_PRIO=0)
exten => 818,n,Set(QDEST=${VQ_DEST})
exten => 818,n,Set(VQ_DEST=)
exten => 818,n(gotodest),GotoIf($["${QDEST}"=""]?app-announcement-4,s,1:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 818*,1,Macro(agent-add,818,)

exten => 818**,1,Macro(agent-del,818)

exten => *45818,1,Set(QUEUENO=818)
exten => *45818,n,Goto(app-queue-toggle,s,start)

exten => *46818,1,Gosub(app-queue-pause-toggle,s,1(818))

exten => 819,1,Macro(user-callerid,)
exten => 819,n,Answer
exten => 819,n,Macro(blkvm-set,reset)
exten => 819,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 819,n,Set(__NODEST=${EXTEN})
exten => 819,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 819,n,Set(VQ_CIDPP=)
exten => 819,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 819,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 819,n,Set(VQ_AINFO=)
exten => 819,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 819,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 819,n,Set(VQ_JOINMSG=)
exten => 819,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}: )})
exten => 819,n,Set(VQ_MOH=)
exten => 819,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 819,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 819,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 819,n,Set(VQ_RETRY=)
exten => 819,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY}${VQ_CONTINUE})
exten => 819,n,Set(VQ_OPTIONS=)
exten => 819,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 819,n,Set(VQ_GOSUB=)
exten => 819,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 819,n,Set(VQ_AGI=)
exten => 819,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 819,n,Set(VQ_RULE=)
exten => 819,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 819,n,Set(VQ_POSITION=)
exten => 819,n,Set(__MIXMON_FORMAT=wav)
exten => 819,n,Gosub(sub-record-check,s,1(q,819,always))
exten => 819,n,Set(__CWIGNORE=TRUE)
exten => 819,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 819,n,QueueLog(819,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 819,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 819,n,Set(VQ_AANNOUNCE=)
exten => 819,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}: )})
exten => 819,n,Set(VQ_MAXWAIT=)
exten => 819,n,Set(QUEUENUM=819)
exten => 819,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 819,n(qcall),Queue(819,${QOPTIONS},${QURL},${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 819,n,Macro(blkvm-clr,)
exten => 819,n,ExecIf($["${QUEUESTATUS}"="CONTINUE"]?Set(CALLFILENAME=""))
exten => 819,n,Gosub(sub-record-cancel,s,1())
exten => 819,n,Set(__NODEST=)
exten => 819,n,Set(_QUEUE_PRIO=0)
exten => 819,n,Set(__CWIGNORE=)
exten => 819,n,Set(QDEST=${VQ_DEST})
exten => 819,n,Set(VQ_DEST=)
exten => 819,n(gotodest),GotoIf($["${QDEST}"=""]?:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => 819*,1,Macro(agent-add,819,)

exten => 819**,1,Macro(agent-del,819)

exten => *45819,1,Set(QUEUENO=819)
exten => *45819,n,Goto(app-queue-toggle,s,start)

exten => *46819,1,Gosub(app-queue-pause-toggle,s,1(819))

exten => *45,1,Goto(app-all-queue-toggle,s,start)

exten => _*45*X.,1,Goto(app-all-queue-toggle,s,start)

exten => *45*0323,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2001,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2002,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2003,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2004,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2005,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2006,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2021,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2022,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2023,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2024,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2025,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2026,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2027,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2028,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2029,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2030,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2031,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2032,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2033,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2034,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2035,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2036,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2037,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2038,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2039,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2040,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2041,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2042,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2043,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2044,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2045,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2046,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2047,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2048,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2049,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2050,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2051,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2052,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2053,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2054,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2055,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2056,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2057,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2058,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2059,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2060,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2061,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2062,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2063,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2064,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2065,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2066,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2067,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2068,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2069,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2070,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2071,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2072,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2073,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2074,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2075,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2076,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2077,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2078,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2079,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2080,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2081,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2082,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2083,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2084,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2085,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2086,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2087,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2088,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2089,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2090,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2091,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2092,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2093,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2094,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2095,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2096,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2097,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2098,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2099,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2100,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2101,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2102,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2103,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2104,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2105,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2106,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2107,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2108,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2109,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2110,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2111,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2112,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2113,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2114,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2115,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2116,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2117,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2118,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2119,1,Goto(app-all-queue-toggle,s,start)

exten => *45*2120,1,Goto(app-all-queue-toggle,s,start)

exten => *46,1,Goto(app-all-queue-pause-toggle,s,1)

exten => _*46*X.,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*0323,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2001,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2002,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2003,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2004,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2005,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2006,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2021,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2022,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2023,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2024,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2025,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2026,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2027,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2028,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2029,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2030,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2031,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2032,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2033,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2034,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2035,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2036,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2037,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2038,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2039,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2040,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2041,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2042,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2043,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2044,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2045,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2046,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2047,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2048,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2049,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2050,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2051,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2052,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2053,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2054,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2055,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2056,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2057,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2058,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2059,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2060,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2061,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2062,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2063,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2064,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2065,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2066,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2067,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2068,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2069,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2070,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2071,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2072,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2073,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2074,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2075,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2076,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2077,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2078,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2079,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2080,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2081,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2082,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2083,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2084,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2085,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2086,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2087,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2088,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2089,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2090,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2091,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2092,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2093,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2094,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2095,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2096,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2097,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2098,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2099,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2100,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2101,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2102,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2103,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2104,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2105,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2106,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2107,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2108,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2109,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2110,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2111,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2112,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2113,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2114,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2115,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2116,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2117,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2118,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2119,1,Goto(app-all-queue-pause-toggle,s,1)

exten => *46*2120,1,Goto(app-all-queue-pause-toggle,s,1)

exten => h,1,Macro(hangupcall,)

;--== end of [ext-queues] ==--;


[from-queue]
include => from-queue-custom
exten => 801,1,Goto(from-internal,${QAGENT},1)

exten => 802,1,Goto(from-internal,${QAGENT},1)

exten => 803,1,Goto(from-internal,${QAGENT},1)

exten => 804,1,Goto(from-internal,${QAGENT},1)

exten => 805,1,Goto(from-internal,${QAGENT},1)

exten => 806,1,Goto(from-internal,${QAGENT},1)

exten => 807,1,Goto(from-internal,${QAGENT},1)

exten => 808,1,Goto(from-internal,${QAGENT},1)

exten => 809,1,Goto(from-internal,${QAGENT},1)

exten => 810,1,Goto(from-internal,${QAGENT},1)

exten => 811,1,Goto(from-internal,${QAGENT},1)

exten => 812,1,Goto(from-internal,${QAGENT},1)

exten => 813,1,Goto(from-internal,${QAGENT},1)

exten => 814,1,Goto(from-internal,${QAGENT},1)

exten => 815,1,Goto(from-internal,${QAGENT},1)

exten => 816,1,Goto(from-internal,${QAGENT},1)

exten => 817,1,Goto(from-internal,${QAGENT},1)

exten => 818,1,Goto(from-internal,${QAGENT},1)

exten => 819,1,Goto(from-internal,${QAGENT},1)

exten => _.,1,Set(QAGENT=${EXTEN})
exten => _.,n,Goto(${NODEST},1)

;--== end of [from-queue] ==--;


[app-queue-caller-count]
include => app-queue-caller-count-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Set(QUEUES=${ARG1})
exten => s,n,Set(COUNT=0)
exten => s,n,Set(LOOPCNT=${FIELDQTY(QUEUES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin1),Set(QUEUE=${CUT(QUEUES,&,${ITER})})
exten => s,n,Set(COUNT=$[${COUNT} + ${QUEUE_WAITING_COUNT(${QUEUE})}])
exten => s,n(end1),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin1)
exten => s,n,SayNumber(${COUNT},f)
exten => s,n,Playback(queue-quantity2)
exten => s,n,Return()

;--== end of [app-queue-caller-count] ==--;


[from-queue-exten-internal]
include => from-queue-exten-internal-custom
include => from-queue-exten-only
include => from-internal
exten => foo,1,Noop(bar)

;--== end of [from-queue-exten-internal] ==--;


[from-queue-exten-only]
include => from-queue-exten-only-custom
exten => 0323,1,Set(RingGroupMethod=none)
exten => 0323,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 0323,n(checkrecord),Gosub(sub-record-check,s,1(exten,0323))
exten => 0323,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},0323)
exten => 0323,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 0323,n,Hangup

exten => 2001,1,Set(RingGroupMethod=none)
exten => 2001,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2001,n(checkrecord),Gosub(sub-record-check,s,1(exten,2001))
exten => 2001,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2001)
exten => 2001,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2001,n,Hangup

exten => 2002,1,Set(RingGroupMethod=none)
exten => 2002,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2002,n(checkrecord),Gosub(sub-record-check,s,1(exten,2002))
exten => 2002,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2002)
exten => 2002,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2002,n,Hangup

exten => 2003,1,Set(RingGroupMethod=none)
exten => 2003,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2003,n(checkrecord),Gosub(sub-record-check,s,1(exten,2003))
exten => 2003,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2003)
exten => 2003,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2003,n,Hangup

exten => 2004,1,Set(RingGroupMethod=none)
exten => 2004,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2004,n(checkrecord),Gosub(sub-record-check,s,1(exten,2004))
exten => 2004,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2004)
exten => 2004,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2004,n,Hangup

exten => 2005,1,Set(RingGroupMethod=none)
exten => 2005,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2005,n(checkrecord),Gosub(sub-record-check,s,1(exten,2005))
exten => 2005,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2005)
exten => 2005,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2005,n,Hangup

exten => 2006,1,Set(RingGroupMethod=none)
exten => 2006,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2006,n(checkrecord),Gosub(sub-record-check,s,1(exten,2006))
exten => 2006,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2006)
exten => 2006,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2006,n,Hangup

exten => 2021,1,Set(RingGroupMethod=none)
exten => 2021,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2021,n(checkrecord),Gosub(sub-record-check,s,1(exten,2021))
exten => 2021,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2021)
exten => 2021,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2021,n,Hangup

exten => 2022,1,Set(RingGroupMethod=none)
exten => 2022,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2022,n(checkrecord),Gosub(sub-record-check,s,1(exten,2022))
exten => 2022,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2022)
exten => 2022,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2022,n,Hangup

exten => 2023,1,Set(RingGroupMethod=none)
exten => 2023,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2023,n(checkrecord),Gosub(sub-record-check,s,1(exten,2023))
exten => 2023,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2023)
exten => 2023,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2023,n,Hangup

exten => 2024,1,Set(RingGroupMethod=none)
exten => 2024,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2024,n(checkrecord),Gosub(sub-record-check,s,1(exten,2024))
exten => 2024,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2024)
exten => 2024,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2024,n,Hangup

exten => 2025,1,Set(RingGroupMethod=none)
exten => 2025,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2025,n(checkrecord),Gosub(sub-record-check,s,1(exten,2025))
exten => 2025,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2025)
exten => 2025,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2025,n,Hangup

exten => 2026,1,Set(RingGroupMethod=none)
exten => 2026,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2026,n(checkrecord),Gosub(sub-record-check,s,1(exten,2026))
exten => 2026,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2026)
exten => 2026,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2026,n,Hangup

exten => 2027,1,Set(RingGroupMethod=none)
exten => 2027,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2027,n(checkrecord),Gosub(sub-record-check,s,1(exten,2027))
exten => 2027,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2027)
exten => 2027,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2027,n,Hangup

exten => 2028,1,Set(RingGroupMethod=none)
exten => 2028,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2028,n(checkrecord),Gosub(sub-record-check,s,1(exten,2028))
exten => 2028,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2028)
exten => 2028,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2028,n,Hangup

exten => 2029,1,Set(RingGroupMethod=none)
exten => 2029,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2029,n(checkrecord),Gosub(sub-record-check,s,1(exten,2029))
exten => 2029,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2029)
exten => 2029,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2029,n,Hangup

exten => 2030,1,Set(RingGroupMethod=none)
exten => 2030,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2030,n(checkrecord),Gosub(sub-record-check,s,1(exten,2030))
exten => 2030,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2030)
exten => 2030,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2030,n,Hangup

exten => 2031,1,Set(RingGroupMethod=none)
exten => 2031,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2031,n(checkrecord),Gosub(sub-record-check,s,1(exten,2031))
exten => 2031,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2031)
exten => 2031,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2031,n,Hangup

exten => 2032,1,Set(RingGroupMethod=none)
exten => 2032,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2032,n(checkrecord),Gosub(sub-record-check,s,1(exten,2032))
exten => 2032,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2032)
exten => 2032,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2032,n,Hangup

exten => 2033,1,Set(RingGroupMethod=none)
exten => 2033,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2033,n(checkrecord),Gosub(sub-record-check,s,1(exten,2033))
exten => 2033,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2033)
exten => 2033,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2033,n,Hangup

exten => 2034,1,Set(RingGroupMethod=none)
exten => 2034,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2034,n(checkrecord),Gosub(sub-record-check,s,1(exten,2034))
exten => 2034,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2034)
exten => 2034,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2034,n,Hangup

exten => 2035,1,Set(RingGroupMethod=none)
exten => 2035,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2035,n(checkrecord),Gosub(sub-record-check,s,1(exten,2035))
exten => 2035,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2035)
exten => 2035,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2035,n,Hangup

exten => 2036,1,Set(RingGroupMethod=none)
exten => 2036,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2036,n(checkrecord),Gosub(sub-record-check,s,1(exten,2036))
exten => 2036,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2036)
exten => 2036,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2036,n,Hangup

exten => 2037,1,Set(RingGroupMethod=none)
exten => 2037,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2037,n(checkrecord),Gosub(sub-record-check,s,1(exten,2037))
exten => 2037,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2037)
exten => 2037,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2037,n,Hangup

exten => 2038,1,Set(RingGroupMethod=none)
exten => 2038,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2038,n(checkrecord),Gosub(sub-record-check,s,1(exten,2038))
exten => 2038,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2038)
exten => 2038,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2038,n,Hangup

exten => 2039,1,Set(RingGroupMethod=none)
exten => 2039,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2039,n(checkrecord),Gosub(sub-record-check,s,1(exten,2039))
exten => 2039,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2039)
exten => 2039,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2039,n,Hangup

exten => 2040,1,Set(RingGroupMethod=none)
exten => 2040,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2040,n(checkrecord),Gosub(sub-record-check,s,1(exten,2040))
exten => 2040,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2040)
exten => 2040,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2040,n,Hangup

exten => 2041,1,Set(RingGroupMethod=none)
exten => 2041,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2041,n(checkrecord),Gosub(sub-record-check,s,1(exten,2041))
exten => 2041,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2041)
exten => 2041,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2041,n,Hangup

exten => 2042,1,Set(RingGroupMethod=none)
exten => 2042,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2042,n(checkrecord),Gosub(sub-record-check,s,1(exten,2042))
exten => 2042,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2042)
exten => 2042,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2042,n,Hangup

exten => 2043,1,Set(RingGroupMethod=none)
exten => 2043,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2043,n(checkrecord),Gosub(sub-record-check,s,1(exten,2043))
exten => 2043,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2043)
exten => 2043,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2043,n,Hangup

exten => 2044,1,Set(RingGroupMethod=none)
exten => 2044,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2044,n(checkrecord),Gosub(sub-record-check,s,1(exten,2044))
exten => 2044,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2044)
exten => 2044,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2044,n,Hangup

exten => 2045,1,Set(RingGroupMethod=none)
exten => 2045,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2045,n(checkrecord),Gosub(sub-record-check,s,1(exten,2045))
exten => 2045,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2045)
exten => 2045,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2045,n,Hangup

exten => 2046,1,Set(RingGroupMethod=none)
exten => 2046,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2046,n(checkrecord),Gosub(sub-record-check,s,1(exten,2046))
exten => 2046,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2046)
exten => 2046,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2046,n,Hangup

exten => 2047,1,Set(RingGroupMethod=none)
exten => 2047,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2047,n(checkrecord),Gosub(sub-record-check,s,1(exten,2047))
exten => 2047,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2047)
exten => 2047,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2047,n,Hangup

exten => 2048,1,Set(RingGroupMethod=none)
exten => 2048,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2048,n(checkrecord),Gosub(sub-record-check,s,1(exten,2048))
exten => 2048,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2048)
exten => 2048,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2048,n,Hangup

exten => 2049,1,Set(RingGroupMethod=none)
exten => 2049,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2049,n(checkrecord),Gosub(sub-record-check,s,1(exten,2049))
exten => 2049,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2049)
exten => 2049,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2049,n,Hangup

exten => 2050,1,Set(RingGroupMethod=none)
exten => 2050,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2050,n(checkrecord),Gosub(sub-record-check,s,1(exten,2050))
exten => 2050,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2050)
exten => 2050,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2050,n,Hangup

exten => 2051,1,Set(RingGroupMethod=none)
exten => 2051,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2051,n(checkrecord),Gosub(sub-record-check,s,1(exten,2051))
exten => 2051,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2051)
exten => 2051,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2051,n,Hangup

exten => 2052,1,Set(RingGroupMethod=none)
exten => 2052,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2052,n(checkrecord),Gosub(sub-record-check,s,1(exten,2052))
exten => 2052,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2052)
exten => 2052,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2052,n,Hangup

exten => 2053,1,Set(RingGroupMethod=none)
exten => 2053,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2053,n(checkrecord),Gosub(sub-record-check,s,1(exten,2053))
exten => 2053,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2053)
exten => 2053,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2053,n,Hangup

exten => 2054,1,Set(RingGroupMethod=none)
exten => 2054,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2054,n(checkrecord),Gosub(sub-record-check,s,1(exten,2054))
exten => 2054,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2054)
exten => 2054,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2054,n,Hangup

exten => 2055,1,Set(RingGroupMethod=none)
exten => 2055,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2055,n(checkrecord),Gosub(sub-record-check,s,1(exten,2055))
exten => 2055,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2055)
exten => 2055,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2055,n,Hangup

exten => 2056,1,Set(RingGroupMethod=none)
exten => 2056,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2056,n(checkrecord),Gosub(sub-record-check,s,1(exten,2056))
exten => 2056,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2056)
exten => 2056,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2056,n,Hangup

exten => 2057,1,Set(RingGroupMethod=none)
exten => 2057,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2057,n(checkrecord),Gosub(sub-record-check,s,1(exten,2057))
exten => 2057,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2057)
exten => 2057,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2057,n,Hangup

exten => 2058,1,Set(RingGroupMethod=none)
exten => 2058,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2058,n(checkrecord),Gosub(sub-record-check,s,1(exten,2058))
exten => 2058,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2058)
exten => 2058,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2058,n,Hangup

exten => 2059,1,Set(RingGroupMethod=none)
exten => 2059,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2059,n(checkrecord),Gosub(sub-record-check,s,1(exten,2059))
exten => 2059,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2059)
exten => 2059,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2059,n,Hangup

exten => 2060,1,Set(RingGroupMethod=none)
exten => 2060,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2060,n(checkrecord),Gosub(sub-record-check,s,1(exten,2060))
exten => 2060,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2060)
exten => 2060,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2060,n,Hangup

exten => 2061,1,Set(RingGroupMethod=none)
exten => 2061,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2061,n(checkrecord),Gosub(sub-record-check,s,1(exten,2061))
exten => 2061,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2061)
exten => 2061,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2061,n,Hangup

exten => 2062,1,Set(RingGroupMethod=none)
exten => 2062,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2062,n(checkrecord),Gosub(sub-record-check,s,1(exten,2062))
exten => 2062,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2062)
exten => 2062,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2062,n,Hangup

exten => 2063,1,Set(RingGroupMethod=none)
exten => 2063,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2063,n(checkrecord),Gosub(sub-record-check,s,1(exten,2063))
exten => 2063,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2063)
exten => 2063,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2063,n,Hangup

exten => 2064,1,Set(RingGroupMethod=none)
exten => 2064,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2064,n(checkrecord),Gosub(sub-record-check,s,1(exten,2064))
exten => 2064,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2064)
exten => 2064,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2064,n,Hangup

exten => 2065,1,Set(RingGroupMethod=none)
exten => 2065,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2065,n(checkrecord),Gosub(sub-record-check,s,1(exten,2065))
exten => 2065,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2065)
exten => 2065,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2065,n,Hangup

exten => 2066,1,Set(RingGroupMethod=none)
exten => 2066,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2066,n(checkrecord),Gosub(sub-record-check,s,1(exten,2066))
exten => 2066,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2066)
exten => 2066,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2066,n,Hangup

exten => 2067,1,Set(RingGroupMethod=none)
exten => 2067,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2067,n(checkrecord),Gosub(sub-record-check,s,1(exten,2067))
exten => 2067,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2067)
exten => 2067,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2067,n,Hangup

exten => 2068,1,Set(RingGroupMethod=none)
exten => 2068,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2068,n(checkrecord),Gosub(sub-record-check,s,1(exten,2068))
exten => 2068,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2068)
exten => 2068,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2068,n,Hangup

exten => 2069,1,Set(RingGroupMethod=none)
exten => 2069,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2069,n(checkrecord),Gosub(sub-record-check,s,1(exten,2069))
exten => 2069,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2069)
exten => 2069,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2069,n,Hangup

exten => 2070,1,Set(RingGroupMethod=none)
exten => 2070,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2070,n(checkrecord),Gosub(sub-record-check,s,1(exten,2070))
exten => 2070,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2070)
exten => 2070,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2070,n,Hangup

exten => 2071,1,Set(RingGroupMethod=none)
exten => 2071,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2071,n(checkrecord),Gosub(sub-record-check,s,1(exten,2071))
exten => 2071,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2071)
exten => 2071,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2071,n,Hangup

exten => 2072,1,Set(RingGroupMethod=none)
exten => 2072,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2072,n(checkrecord),Gosub(sub-record-check,s,1(exten,2072))
exten => 2072,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2072)
exten => 2072,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2072,n,Hangup

exten => 2073,1,Set(RingGroupMethod=none)
exten => 2073,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2073,n(checkrecord),Gosub(sub-record-check,s,1(exten,2073))
exten => 2073,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2073)
exten => 2073,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2073,n,Hangup

exten => 2074,1,Set(RingGroupMethod=none)
exten => 2074,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2074,n(checkrecord),Gosub(sub-record-check,s,1(exten,2074))
exten => 2074,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2074)
exten => 2074,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2074,n,Hangup

exten => 2075,1,Set(RingGroupMethod=none)
exten => 2075,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2075,n(checkrecord),Gosub(sub-record-check,s,1(exten,2075))
exten => 2075,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2075)
exten => 2075,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2075,n,Hangup

exten => 2076,1,Set(RingGroupMethod=none)
exten => 2076,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2076,n(checkrecord),Gosub(sub-record-check,s,1(exten,2076))
exten => 2076,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2076)
exten => 2076,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2076,n,Hangup

exten => 2077,1,Set(RingGroupMethod=none)
exten => 2077,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2077,n(checkrecord),Gosub(sub-record-check,s,1(exten,2077))
exten => 2077,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2077)
exten => 2077,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2077,n,Hangup

exten => 2078,1,Set(RingGroupMethod=none)
exten => 2078,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2078,n(checkrecord),Gosub(sub-record-check,s,1(exten,2078))
exten => 2078,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2078)
exten => 2078,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2078,n,Hangup

exten => 2079,1,Set(RingGroupMethod=none)
exten => 2079,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2079,n(checkrecord),Gosub(sub-record-check,s,1(exten,2079))
exten => 2079,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2079)
exten => 2079,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2079,n,Hangup

exten => 2080,1,Set(RingGroupMethod=none)
exten => 2080,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2080,n(checkrecord),Gosub(sub-record-check,s,1(exten,2080))
exten => 2080,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2080)
exten => 2080,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2080,n,Hangup

exten => 2081,1,Set(RingGroupMethod=none)
exten => 2081,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2081,n(checkrecord),Gosub(sub-record-check,s,1(exten,2081))
exten => 2081,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2081)
exten => 2081,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2081,n,Hangup

exten => 2082,1,Set(RingGroupMethod=none)
exten => 2082,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2082,n(checkrecord),Gosub(sub-record-check,s,1(exten,2082))
exten => 2082,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2082)
exten => 2082,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2082,n,Hangup

exten => 2083,1,Set(RingGroupMethod=none)
exten => 2083,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2083,n(checkrecord),Gosub(sub-record-check,s,1(exten,2083))
exten => 2083,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2083)
exten => 2083,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2083,n,Hangup

exten => 2084,1,Set(RingGroupMethod=none)
exten => 2084,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2084,n(checkrecord),Gosub(sub-record-check,s,1(exten,2084))
exten => 2084,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2084)
exten => 2084,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2084,n,Hangup

exten => 2085,1,Set(RingGroupMethod=none)
exten => 2085,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2085,n(checkrecord),Gosub(sub-record-check,s,1(exten,2085))
exten => 2085,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2085)
exten => 2085,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2085,n,Hangup

exten => 2086,1,Set(RingGroupMethod=none)
exten => 2086,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2086,n(checkrecord),Gosub(sub-record-check,s,1(exten,2086))
exten => 2086,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2086)
exten => 2086,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2086,n,Hangup

exten => 2087,1,Set(RingGroupMethod=none)
exten => 2087,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2087,n(checkrecord),Gosub(sub-record-check,s,1(exten,2087))
exten => 2087,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2087)
exten => 2087,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2087,n,Hangup

exten => 2088,1,Set(RingGroupMethod=none)
exten => 2088,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2088,n(checkrecord),Gosub(sub-record-check,s,1(exten,2088))
exten => 2088,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2088)
exten => 2088,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2088,n,Hangup

exten => 2089,1,Set(RingGroupMethod=none)
exten => 2089,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2089,n(checkrecord),Gosub(sub-record-check,s,1(exten,2089))
exten => 2089,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2089)
exten => 2089,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2089,n,Hangup

exten => 2090,1,Set(RingGroupMethod=none)
exten => 2090,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2090,n(checkrecord),Gosub(sub-record-check,s,1(exten,2090))
exten => 2090,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2090)
exten => 2090,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2090,n,Hangup

exten => 2091,1,Set(RingGroupMethod=none)
exten => 2091,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2091,n(checkrecord),Gosub(sub-record-check,s,1(exten,2091))
exten => 2091,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2091)
exten => 2091,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2091,n,Hangup

exten => 2092,1,Set(RingGroupMethod=none)
exten => 2092,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2092,n(checkrecord),Gosub(sub-record-check,s,1(exten,2092))
exten => 2092,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2092)
exten => 2092,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2092,n,Hangup

exten => 2093,1,Set(RingGroupMethod=none)
exten => 2093,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2093,n(checkrecord),Gosub(sub-record-check,s,1(exten,2093))
exten => 2093,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2093)
exten => 2093,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2093,n,Hangup

exten => 2094,1,Set(RingGroupMethod=none)
exten => 2094,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2094,n(checkrecord),Gosub(sub-record-check,s,1(exten,2094))
exten => 2094,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2094)
exten => 2094,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2094,n,Hangup

exten => 2095,1,Set(RingGroupMethod=none)
exten => 2095,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2095,n(checkrecord),Gosub(sub-record-check,s,1(exten,2095))
exten => 2095,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2095)
exten => 2095,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2095,n,Hangup

exten => 2096,1,Set(RingGroupMethod=none)
exten => 2096,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2096,n(checkrecord),Gosub(sub-record-check,s,1(exten,2096))
exten => 2096,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2096)
exten => 2096,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2096,n,Hangup

exten => 2097,1,Set(RingGroupMethod=none)
exten => 2097,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2097,n(checkrecord),Gosub(sub-record-check,s,1(exten,2097))
exten => 2097,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2097)
exten => 2097,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2097,n,Hangup

exten => 2098,1,Set(RingGroupMethod=none)
exten => 2098,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2098,n(checkrecord),Gosub(sub-record-check,s,1(exten,2098))
exten => 2098,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2098)
exten => 2098,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2098,n,Hangup

exten => 2099,1,Set(RingGroupMethod=none)
exten => 2099,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2099,n(checkrecord),Gosub(sub-record-check,s,1(exten,2099))
exten => 2099,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2099)
exten => 2099,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2099,n,Hangup

exten => 2100,1,Set(RingGroupMethod=none)
exten => 2100,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2100,n(checkrecord),Gosub(sub-record-check,s,1(exten,2100))
exten => 2100,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2100)
exten => 2100,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2100,n,Hangup

exten => 2101,1,Set(RingGroupMethod=none)
exten => 2101,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2101,n(checkrecord),Gosub(sub-record-check,s,1(exten,2101))
exten => 2101,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2101)
exten => 2101,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2101,n,Hangup

exten => 2102,1,Set(RingGroupMethod=none)
exten => 2102,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2102,n(checkrecord),Gosub(sub-record-check,s,1(exten,2102))
exten => 2102,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2102)
exten => 2102,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2102,n,Hangup

exten => 2103,1,Set(RingGroupMethod=none)
exten => 2103,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2103,n(checkrecord),Gosub(sub-record-check,s,1(exten,2103))
exten => 2103,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2103)
exten => 2103,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2103,n,Hangup

exten => 2104,1,Set(RingGroupMethod=none)
exten => 2104,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2104,n(checkrecord),Gosub(sub-record-check,s,1(exten,2104))
exten => 2104,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2104)
exten => 2104,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2104,n,Hangup

exten => 2105,1,Set(RingGroupMethod=none)
exten => 2105,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2105,n(checkrecord),Gosub(sub-record-check,s,1(exten,2105))
exten => 2105,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2105)
exten => 2105,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2105,n,Hangup

exten => 2106,1,Set(RingGroupMethod=none)
exten => 2106,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2106,n(checkrecord),Gosub(sub-record-check,s,1(exten,2106))
exten => 2106,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2106)
exten => 2106,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2106,n,Hangup

exten => 2107,1,Set(RingGroupMethod=none)
exten => 2107,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2107,n(checkrecord),Gosub(sub-record-check,s,1(exten,2107))
exten => 2107,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2107)
exten => 2107,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2107,n,Hangup

exten => 2108,1,Set(RingGroupMethod=none)
exten => 2108,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2108,n(checkrecord),Gosub(sub-record-check,s,1(exten,2108))
exten => 2108,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2108)
exten => 2108,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2108,n,Hangup

exten => 2109,1,Set(RingGroupMethod=none)
exten => 2109,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2109,n(checkrecord),Gosub(sub-record-check,s,1(exten,2109))
exten => 2109,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2109)
exten => 2109,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2109,n,Hangup

exten => 2110,1,Set(RingGroupMethod=none)
exten => 2110,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2110,n(checkrecord),Gosub(sub-record-check,s,1(exten,2110))
exten => 2110,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2110)
exten => 2110,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2110,n,Hangup

exten => 2111,1,Set(RingGroupMethod=none)
exten => 2111,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2111,n(checkrecord),Gosub(sub-record-check,s,1(exten,2111))
exten => 2111,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2111)
exten => 2111,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2111,n,Hangup

exten => 2112,1,Set(RingGroupMethod=none)
exten => 2112,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2112,n(checkrecord),Gosub(sub-record-check,s,1(exten,2112))
exten => 2112,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2112)
exten => 2112,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2112,n,Hangup

exten => 2113,1,Set(RingGroupMethod=none)
exten => 2113,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2113,n(checkrecord),Gosub(sub-record-check,s,1(exten,2113))
exten => 2113,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2113)
exten => 2113,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2113,n,Hangup

exten => 2114,1,Set(RingGroupMethod=none)
exten => 2114,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2114,n(checkrecord),Gosub(sub-record-check,s,1(exten,2114))
exten => 2114,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2114)
exten => 2114,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2114,n,Hangup

exten => 2115,1,Set(RingGroupMethod=none)
exten => 2115,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2115,n(checkrecord),Gosub(sub-record-check,s,1(exten,2115))
exten => 2115,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2115)
exten => 2115,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2115,n,Hangup

exten => 2116,1,Set(RingGroupMethod=none)
exten => 2116,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2116,n(checkrecord),Gosub(sub-record-check,s,1(exten,2116))
exten => 2116,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2116)
exten => 2116,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2116,n,Hangup

exten => 2117,1,Set(RingGroupMethod=none)
exten => 2117,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2117,n(checkrecord),Gosub(sub-record-check,s,1(exten,2117))
exten => 2117,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2117)
exten => 2117,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2117,n,Hangup

exten => 2118,1,Set(RingGroupMethod=none)
exten => 2118,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2118,n(checkrecord),Gosub(sub-record-check,s,1(exten,2118))
exten => 2118,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2118)
exten => 2118,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2118,n,Hangup

exten => 2119,1,Set(RingGroupMethod=none)
exten => 2119,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2119,n(checkrecord),Gosub(sub-record-check,s,1(exten,2119))
exten => 2119,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2119)
exten => 2119,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2119,n,Hangup

exten => 2120,1,Set(RingGroupMethod=none)
exten => 2120,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => 2120,n(checkrecord),Gosub(sub-record-check,s,1(exten,2120))
exten => 2120,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},2120)
exten => 2120,n,GotoIf($["${CALLER_DEST}"!=""]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => 2120,n,Hangup

exten => h,1,Macro(hangupcall,)

;--== end of [from-queue-exten-only] ==--;


[macro-agent-add]
include => macro-agent-add-custom
exten => s,1,Wait(1)
exten => s,n,Set(QUEUENO=${ARG1})
exten => s,n,Macro(user-callerid,SKIPTTL)
exten => s,n(a3),Read(CALLBACKNUM,agent-login,,,,)
exten => s,n,GotoIf($[${LEN(${CALLBACKNUM})}=0]?a5:a7)
exten => s,n(a5),Set(CALLBACKNUM=${IF($[${LEN(${AMPUSER})}=0]?${CALLERID(number)}:${AMPUSER})})
exten => s,n,Set(THISDEVICE=${DB(DEVICE/${REALCALLERIDNUM}/dial)})
exten => s,n,GotoIf($["${CALLBACKNUM}" = ""]?a3)
exten => s,n(a7),GotoIf($["${CALLBACKNUM}" = "${QUEUENO}"]?invalid)
exten => s,n,GotoIf($["${ARG3}" = "EXTEN" & ${DB_EXISTS(AMPUSER/${CALLBACKNUM}/cidname)} = 0]?invalid)
exten => s,n,GotoIf($["${DB(QPENALTY/${QUEUENO}/dynmemberonly)}" = "yes" & ${DB_EXISTS(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})} != 1]?invalid)
exten => s,n,ExecIf($["${QREGEX}" != ""]?GotoIf($["${REGEX("${QREGEX}" ${CALLBACKNUM})}" = "0"]?invalid))
exten => s,n,ExecIf($["${ARG2}" != ""]?Authenticate(${ARG2}))
exten => s,n,ExecIf($[${DB_EXISTS(AMPUSER/${CALLBACKNUM}/cidname)} = 1 & "${DB(AMPUSER/${CALLBACKNUM}/queues/qnostate)}" != "ignorestate"]?AddQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})},,${DB(AMPUSER/${CALLBACKNUM}/cidname)},hint:${CALLBACKNUM}@ext-local))
exten => s,n,ExecIf($[${DB_EXISTS(AMPUSER/${CALLBACKNUM}/cidname)} = 1 & "${DB(AMPUSER/${CALLBACKNUM}/queues/qnostate)}" = "ignorestate"]?AddQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})},,${DB(AMPUSER/${CALLBACKNUM}/cidname)}))
exten => s,n,ExecIf($[${DB_EXISTS(AMPUSER/${CALLBACKNUM}/cidname)} = 0]?AddQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${CALLBACKNUM})}))
exten => s,n,UserEvent(Agentlogin,Agent: ${CALLBACKNUM})
exten => s,n,Wait(1)
exten => s,n,Playback(agent-loginok&with&extension)
exten => s,n,SayDigits(${CALLBACKNUM})
exten => s,n,Hangup
exten => s,n,MacroExit()
exten => s,n(invalid),Playback(pbx-invalid)
exten => s,n,Goto(a3)

;--== end of [macro-agent-add] ==--;


[macro-agent-del]
include => macro-agent-del-custom
exten => s,1,Wait(1)
exten => s,n,Set(QUEUENO=${ARG1})
exten => s,n,Macro(user-callerid,SKIPTTL)
exten => s,n(a3),Read(CALLBACKNUM,agent-logoff,,,,)
exten => s,n,GotoIf($[${LEN(${CALLBACKNUM})}=0]?a5:a7)
exten => s,n(a5),Set(CALLBACKNUM=${IF($[${LEN(${AMPUSER})}=0]?${CALLERID(number)}:${AMPUSER})})
exten => s,n,GotoIf($["${CALLBACKNUM}" = ""]?a3)
exten => s,n(a7),RemoveQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-queue/n)
exten => s,n,RemoveQueueMember(${QUEUENO},Local/${CALLBACKNUM}@from-internal/n)
exten => s,n,UserEvent(RefreshQueue)
exten => s,n,Wait(1)
exten => s,n,Playback(agent-loggedoff)
exten => s,n,Hangup

;--== end of [macro-agent-del] ==--;


[macro-parked-call]
include => macro-parked-call-custom
exten => s,1,AGI(parkfetch.agi,${ARG1})
exten => s,n,GotoIf($["${REC_STATUS}" != "RECORDING"]?next)
exten => s,n,Set(AUDIOHOOK_INHERIT(MixMonitor)=yes)
exten => s,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => s,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MIXMON_FORMAT},a,${MIXMON_POST})
exten => s,n(next),Set(CCSS_SETUP=TRUE)
exten => s,n,Macro(user-callerid,)
exten => s,n,GotoIf($["${ARG1}" = "" | ${DIALPLAN_EXISTS(${IF($["${ARG2}" = "default"]?parkedcalls:${ARG2})},${ARG1},1)} = 1]?pcall)
exten => s,n,ResetCDR()
exten => s,n,NoCDR()
exten => s,n,Wait(1)
exten => s,n,Playback(pbx-invalidpark)
exten => s,n,Wait(1)
exten => s,n,Hangup
exten => s,n(pcall),Noop(User: ${CALLERID(all)} attempting to pick up Parked Call Slot ${ARG1})
exten => s,n,ParkedCall(${ARG1},${ARG2})

exten => h,1,Macro(hangupcall,)

;--== end of [macro-parked-call] ==--;


[parkedcallstimeout]
include => parkedcallstimeout-custom
exten => _[0-9a-zA-Z*#].,1,Set(PARK_TARGET=${EXTEN})
exten => _[0-9a-zA-Z*#].,n,GotoIf($["${REC_STATUS}" != "RECORDING"]?next)
exten => _[0-9a-zA-Z*#].,n,Set(AUDIOHOOK_INHERIT(MixMonitor)=yes)
exten => _[0-9a-zA-Z*#].,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MIXMON_FORMAT},a,${MIXMON_POST})
exten => _[0-9a-zA-Z*#].,n(next),Goto(park-return-routing,${PARKINGSLOT},1)

;--== end of [parkedcallstimeout] ==--;


[park-dial]
include => park-dial-custom
exten => t,1,Noop(WARNING: PARKRETURN to: [${EXTEN}] failed with: [${DIALSTATUS}]. Trying Alternate Dest On Parking Lot ${PARKINGSLOT})
exten => t,n,Goto(park-orphan-routing,700,1)

exten => _[0-9a-zA-Z*#].,1,Noop(WARNING: PARKRETURN to: [${EXTEN}] failed with: [${DIALSTATUS}]. Trying Alternate Dest On Parking Lot ${PARKINGSLOT})
exten => _[0-9a-zA-Z*#].,n,Goto(park-orphan-routing,700,1)

;--== end of [park-dial] ==--;


[park-orphan-routing]
include => park-orphan-routing-custom
exten => 700,1,Goto(app-blackhole,hangup,1)

;--== end of [park-orphan-routing] ==--;


[park-return-routing]
include => park-return-routing-custom
exten => 700,1,Set(PLOT=700)
exten => 700,n,Goto(park-dial,${PARK_TARGET},1)
exten => 700,n,Goto(app-blackhole,hangup,1)

exten => 701,1,Goto(700,1)

exten => 702,1,Goto(700,1)

exten => 703,1,Goto(700,1)

exten => 704,1,Goto(700,1)

;--== end of [park-return-routing] ==--;


[park-hints]
include => park-hints-custom
include => parkedcalls ; Default Lot
exten => 701,1,Macro(parked-call,701,default)
exten => 701,hint,park:701@parkedcalls

exten => 702,1,Macro(parked-call,702,default)
exten => 702,hint,park:702@parkedcalls

exten => 703,1,Macro(parked-call,703,default)
exten => 703,hint,park:703@parkedcalls

exten => 704,1,Macro(parked-call,704,default)
exten => 704,hint,park:704@parkedcalls

exten => *85,1,Macro(parked-call,,default)
exten => *85,hint,park:701@parkedcalls&park:702@parkedcalls&park:703@parkedcalls&park:704@parkedcalls

exten => *85700,1,Macro(parked-call,,default)
exten => *85700,hint,park:701@parkedcalls&park:702@parkedcalls&park:703@parkedcalls&park:704@parkedcalls

;--== end of [park-hints] ==--;


[app-recordings]
include => app-recordings-custom
exten => *77,1,Macro(user-callerid,)
exten => *77,n,Wait(2)
exten => *77,n,Macro(systemrecording,dorecord)

exten => *99,1,Macro(user-callerid,)
exten => *99,n,Wait(2)
exten => *99,n,Macro(systemrecording,docheck)

;--== end of [app-recordings] ==--;


[macro-systemrecording]
include => macro-systemrecording-custom
exten => s,1,Set(RECFILE=${IF($["${ARG2}" = ""]?/var/spool/asterisk/tmp/${AMPUSER}-ivrrecording:${ARG2})})
exten => s,n,ExecIf($["${ARG3}" != ""]?Authenticate(${ARG3}))
exten => s,n,Goto(${ARG1},1)

exten => dorecord,1,GotoIf($["${ARG2}" = ""]?skipremove)
exten => dorecord,n,System(rm ${ASTVARLIBDIR}/sounds/${RECFILE}.*)
exten => dorecord,n(skipremove),Record(${RECFILE}.wav,,,k)
exten => dorecord,n,Wait(1)
exten => dorecord,n,Goto(confmenu,1)

exten => docheck,1,Playback(beep)
exten => docheck,n(dc_start),Background(${RECFILE},m,${CHANNEL(language)},macro-systemrecording)
exten => docheck,n,Wait(1)
exten => docheck,n,Goto(confmenu,1)

exten => confmenu,1,Background(to-listen-to-it&press-1&to-rerecord-it&press-star&astcc-followed-by-pound,m,${CHANNEL(language)},macro-systemrecording)
exten => confmenu,n,Read(RECRESULT,,1,,,4)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x*"]?dorecord,1)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x1"]?docheck,2)
exten => confmenu,n,Goto(1)

exten => 1,1,Goto(docheck,dc_start)

exten => *,1,Goto(dorecord,1)

exten => t,1,Playback(goodbye)
exten => t,n,Hangup

exten => i,1,Playback(pm-invalid-option)
exten => i,n,Goto(confmenu,1)

exten => h,1,Hangup

;--== end of [macro-systemrecording] ==--;


[macro-outisbusy]
include => macro-outisbusy-custom
exten => s,1,Progress
exten => s,n,GotoIf($["${EMERGENCYROUTE}" = "YES"]?emergency,1)
exten => s,n,GotoIf($["${INTRACOMPANYROUTE}" = "YES"]?intracompany,1)
exten => s,n,GotoIf($["${HANGUPCAUSE}" = "1"]?unallocated,1)
exten => s,n,GotoIf($["${HANGUPCAUSE}" = "21"]?unallocated,1)
exten => s,n,Playback(all-circuits-busy-now&pls-try-call-later, noanswer)
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,Congestion(20)
exten => s,n,Hangup

exten => intracompany,1,Playback(all-circuits-busy-now&pls-try-call-later, noanswer)
exten => intracompany,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => intracompany,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => intracompany,n,Congestion(20)
exten => intracompany,n,Hangup

exten => emergency,1,Playback(all-circuits-busy-now&pls-try-call-later)
exten => emergency,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => emergency,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => emergency,n,Congestion(20)
exten => emergency,n,Hangup

exten => unallocated,1,Playback(you-dialed-wrong-number)
exten => unallocated,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => unallocated,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => unallocated,n,Congestion(20)
exten => unallocated,n,Hangup

;--== end of [macro-outisbusy] ==--;


[ext-featurecodes]
include => ext-featurecodes-custom
exten => *30,1,Goto(from-internal,*30,1)

exten => *31,1,Goto(from-internal,*31,1)

exten => 555,1,Goto(from-internal,555,1)

exten => 7777,1,Goto(from-internal,7777,1)

exten => 888,1,Goto(from-internal,888,1)

exten => 666,1,Goto(from-internal,666,1)

exten => *43,1,Goto(from-internal,*43,1)

exten => *60,1,Goto(from-internal,*60,1)

exten => *85,1,Goto(from-internal,*85,1)

exten => 411,1,Goto(from-internal,411,1)

exten => *271,1,Goto(from-internal,*271,1)

exten => *272,1,Goto(from-internal,*272,1)

exten => *98,1,Goto(from-internal,*98,1)

;--== end of [ext-featurecodes] ==--;


[app-blacklist]
include => app-blacklist-custom
exten => ,1,Macro(user-callerid,)

exten => *30,1,Goto(app-blacklist-add,s,1)

exten => *32,1,Goto(app-blacklist-last,s,1)

exten => *31,1,Goto(app-blacklist-remove,s,1)

;--== end of [app-blacklist] ==--;


[app-blacklist-check]
include => app-blacklist-check-custom
exten => s,1(check),GotoIf($["${BLACKLIST()}"="1"]?blacklisted)
exten => s,n,Set(CALLED_BLACKLIST=1)
exten => s,n,Return()
exten => s,n(blacklisted),Answer
exten => s,n,Wait(1)
exten => s,n,Zapateller()
exten => s,n,Playback(ss-noservice)
exten => s,n,Hangup

;--== end of [app-blacklist-check] ==--;


[app-blacklist-add]
include => app-blacklist-add-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Set(NumLoops=0)
exten => s,n(start),Playback(enter-num-blacklist)
exten => s,n,Set(TIMEOUT(digit)=5)
exten => s,n,Set(TIMEOUT(response)=60)
exten => s,n,Read(blacknr,then-press-pound,,,,)
exten => s,n,SayDigits(${blacknr})
exten => s,n,Playback(if-correct-press&digits/1)
exten => s,n,Noop(Waiting for input)
exten => s,n(end),WaitExten(60,)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)

exten => 1,1,GotoIf($[ "${blacknr}" != ""]?:app-blacklist-add-invalid,s,1)
exten => 1,n,Set(DB(blacklist/${blacknr})=1)
exten => 1,n,Playback(num-was-successfully&added)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

;--== end of [app-blacklist-add] ==--;


[app-blacklist-add-invalid]
include => app-blacklist-add-invalid-custom
exten => s,1,Set(NumLoops=$[${NumLoops} + 1])
exten => s,n,Playback(pm-invalid-option)
exten => s,n,GotoIf($[${NumLoops} < 3]?app-blacklist-add,s,start)
exten => s,n,Playback(goodbye)
exten => s,n,Hangup

;--== end of [app-blacklist-add-invalid] ==--;


[app-blacklist-last]
include => app-blacklist-last-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Set(lastcaller=${DB(CALLTRACE/${CALLERID(number)})})
exten => s,n,GotoIf($[ $[ "${lastcaller}" = "" ] | $[ "${lastcaller}" = "unknown" ] ]?noinfo)
exten => s,n,Playback(privacy-to-blacklist-last-caller&telephone-number)
exten => s,n,SayDigits(${lastcaller})
exten => s,n,Set(TIMEOUT(digit)=3)
exten => s,n,Set(TIMEOUT(response)=7)
exten => s,n,Playback(if-correct-press&digits/1)
exten => s,n,Goto(end)
exten => s,n(noinfo),Playback(unidentified-no-callback)
exten => s,n,Hangup
exten => s,n,Noop(Waiting for input)
exten => s,n(end),WaitExten(60,)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)

exten => 1,1,Set(DB(blacklist/${lastcaller})=1)
exten => 1,n,Playback(num-was-successfully)
exten => 1,n,Playback(added)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

;--== end of [app-blacklist-last] ==--;


[app-blacklist-remove]
include => app-blacklist-remove-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Playback(entr-num-rmv-blklist)
exten => s,n,Set(TIMEOUT(digit)=5)
exten => s,n,Set(TIMEOUT(response)=60)
exten => s,n,Read(blacknr,then-press-pound,,,,)
exten => s,n,SayDigits(${blacknr})
exten => s,n,Playback(if-correct-press&digits/1)
exten => s,n,Noop(Waiting for input)
exten => s,n(end),WaitExten(60,)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)

exten => 1,1,Noop(Deleting: blacklist/${blacknr} ${DB_DELETE(blacklist/${blacknr})})
exten => 1,n,Playback(num-was-successfully&removed)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

;--== end of [app-blacklist-remove] ==--;


[app-callwaiting-cwoff]
include => app-callwaiting-cwoff-custom
exten => *71,1,Answer
exten => *71,n,Wait(1)
exten => *71,n,Macro(user-callerid,)
exten => *71,n,Noop(Deleting: CW/${AMPUSER} ${DB_DELETE(CW/${AMPUSER})})
exten => *71,n(hook_1),Playback(call-waiting&de-activated)
exten => *71,n,Macro(hangupcall,)

;--== end of [app-callwaiting-cwoff] ==--;


[app-callwaiting-cwon]
include => app-callwaiting-cwon-custom
exten => *70,1,Answer
exten => *70,n,Wait(1)
exten => *70,n,Macro(user-callerid,)
exten => *70,n,Set(DB(CW/${AMPUSER})=ENABLED)
exten => *70,n(hook_1),Playback(call-waiting&activated)
exten => *70,n,Macro(hangupcall,)

;--== end of [app-callwaiting-cwon] ==--;


[app-cf-toggle]
include => app-cf-toggle-custom
exten => *740,1,Answer
exten => *740,n,Wait(1)
exten => *740,n,Macro(user-callerid,)
exten => *740,n,Set(fromext=${AMPUSER})
exten => *740,n,GotoIf($["${DB(CF/${fromext})}" = ""]?activate:deactivate)
exten => *740,n(activate),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *740,n,GotoIf($["${toext}"=""]?activate)
exten => *740,n,Wait(1)
exten => *740,n(toext),Set(DB(CF/${fromext})=${toext})
exten => *740,n(hook_on),Playback(call-fwd-unconditional&for&extension)
exten => *740,n,SayDigits(${fromext})
exten => *740,n,Playback(is-set-to)
exten => *740,n,SayDigits(${toext})
exten => *740,n,Macro(hangupcall,)
exten => *740,n(setdirect),Answer
exten => *740,n,Wait(1)
exten => *740,n,Macro(user-callerid,)
exten => *740,n,Goto(toext)
exten => *740,n(deactivate),Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *740,n(hook_off),Playback(call-fwd-unconditional&de-activated)
exten => *740,n,Macro(hangupcall,)

;--== end of [app-cf-toggle] ==--;


[app-cf-busy-off]
include => app-cf-busy-off-custom
exten => *91,1,Answer
exten => *91,n,Wait(1)
exten => *91,n,Macro(user-callerid,)
exten => *91,n,Set(fromext=${AMPUSER})
exten => *91,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => *91,n(hook_1),Playback(call-fwd-on-busy&de-activated)
exten => *91,n,Macro(hangupcall,)

exten => _*91.,1,Answer
exten => _*91.,n,Wait(1)
exten => _*91.,n,Set(fromext=${EXTEN:3})
exten => _*91.,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => _*91.,n(hook_2),Playback(call-fwd-on-busy&for&extension)
exten => _*91.,n,SayDigits(${fromext})
exten => _*91.,n,Playback(cancelled)
exten => _*91.,n,Macro(hangupcall,)

;--== end of [app-cf-busy-off] ==--;


[app-cf-busy-off-any]
include => app-cf-busy-off-any-custom
exten => *92,1,Answer
exten => *92,n,Macro(user-callerid,)
exten => *92,n,Wait(1)
exten => *92,n,Read(fromext,please-enter-your&extension&then-press-pound,,,,)
exten => *92,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *92,n,Wait(1)
exten => *92,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => *92,n(hook_1),Playback(call-fwd-on-busy&for&extension)
exten => *92,n,SayDigits(${fromext})
exten => *92,n,Playback(cancelled)
exten => *92,n,Macro(hangupcall,)

;--== end of [app-cf-busy-off-any] ==--;


[app-cf-busy-on]
include => app-cf-busy-on-custom
exten => *90,1,Answer
exten => *90,n,Wait(1)
exten => *90,n,Macro(user-callerid,)
exten => *90,n,Set(fromext=${AMPUSER})
exten => *90,n,GotoIf($["${fromext}"!=""]?startread)
exten => *90,n,Playback(agent-loggedoff)
exten => *90,n,Macro(hangupcall,)
exten => *90,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *90,n,GotoIf($["${toext}"=""]?startread)
exten => *90,n,Wait(1)
exten => *90,n,Set(DB(CFB/${fromext})=${toext})
exten => *90,n(hook_1),Playback(call-fwd-on-busy&for&extension)
exten => *90,n,SayDigits(${fromext})
exten => *90,n,Playback(is-set-to)
exten => *90,n,SayDigits(${toext})
exten => *90,n,Macro(hangupcall,)

exten => _*90.,1,Answer
exten => _*90.,n,Wait(1)
exten => _*90.,n,Macro(user-callerid,)
exten => _*90.,n,Set(fromext=${AMPUSER})
exten => _*90.,n,Set(toext=${EXTEN:3})
exten => _*90.,n,Set(DB(CFB/${fromext})=${toext})
exten => _*90.,n(hook_2),Playback(call-fwd-on-busy&for&extension)
exten => _*90.,n,SayDigits(${fromext})
exten => _*90.,n,Playback(is-set-to)
exten => _*90.,n,SayDigits(${toext})
exten => _*90.,n,Macro(hangupcall,)

;--== end of [app-cf-busy-on] ==--;


[app-cf-busy-prompting-on]
include => app-cf-busy-prompting-on-custom
exten => *900,1,Answer
exten => *900,n,Wait(1)
exten => *900,n,Macro(user-callerid,)
exten => *900,n,Read(fromext,call-fwd-on-busy&please-enter-your&extension&then-press-pound,,,,)
exten => *900,n,Set(fromext=${IF($["${fromext}"=""]?${AMPUSER}:${fromext})})
exten => *900,n,Wait(1)
exten => *900,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *900,n,GotoIf($["${toext}"=""]?startread)
exten => *900,n,Wait(1)
exten => *900,n,Set(DB(CFB/${fromext})=${toext})
exten => *900,n(hook_1),Playback(call-fwd-on-busy&for&extension)
exten => *900,n,SayDigits(${fromext})
exten => *900,n,Playback(is-set-to)
exten => *900,n,SayDigits(${toext})
exten => *900,n,Macro(hangupcall,)

exten => _*900.,1,Answer
exten => _*900.,n,Wait(1)
exten => _*900.,n,Macro(user-callerid,)
exten => _*900.,n,Set(fromext=${AMPUSER})
exten => _*900.,n,Set(toext=${EXTEN:4})
exten => _*900.,n,Set(DB(CFB/${fromext})=${toext})
exten => _*900.,n(hook_2),Playback(call-fwd-on-busy&for&extension)
exten => _*900.,n,SayDigits(${fromext})
exten => _*900.,n,Playback(is-set-to)
exten => _*900.,n,SayDigits(${toext})
exten => _*900.,n,Macro(hangupcall,)

;--== end of [app-cf-busy-prompting-on] ==--;


[app-cf-off]
include => app-cf-off-custom
exten => *73,1,Answer
exten => *73,n,Wait(1)
exten => *73,n,Macro(user-callerid,)
exten => *73,n,Set(fromext=${AMPUSER})
exten => *73,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *73,n(hook_1),Playback(call-fwd-unconditional&de-activated)
exten => *73,n,Macro(hangupcall,)

exten => _*73.,1,Answer
exten => _*73.,n,Wait(1)
exten => _*73.,n,Set(fromext=${EXTEN:3})
exten => _*73.,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => _*73.,n(hook_2),Playback(call-fwd-unconditional&for&extension)
exten => _*73.,n,SayDigits(${fromext})
exten => _*73.,n,Playback(cancelled)
exten => _*73.,n,Macro(hangupcall,)

;--== end of [app-cf-off] ==--;


[app-cf-off-any]
include => app-cf-off-any-custom
exten => *74,1,Answer
exten => *74,n,Macro(user-callerid,)
exten => *74,n,Wait(1)
exten => *74,n,Read(fromext,please-enter-your&extension&then-press-pound,,,,)
exten => *74,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *74,n,Wait(1)
exten => *74,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *74,n(hook_1),Playback(call-fwd-unconditional&for&extension)
exten => *74,n,SayDigits(${fromext})
exten => *74,n,Playback(cancelled)
exten => *74,n,Macro(hangupcall,)

;--== end of [app-cf-off-any] ==--;


[app-cf-on]
include => app-cf-on-custom
exten => *72,1,Answer
exten => *72,n,Wait(1)
exten => *72,n,Macro(user-callerid,)
exten => *72,n,Set(fromext=${AMPUSER})
exten => *72,n,GotoIf($["${fromext}"!=""]?startread)
exten => *72,n,Playback(agent-loggedoff)
exten => *72,n,Macro(hangupcall,)
exten => *72,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *72,n,GotoIf($["foo${toext}"="foo"]?startread)
exten => *72,n,Wait(1)
exten => *72,n,Set(DB(CF/${fromext})=${toext})
exten => *72,n(hook_1),Playback(call-fwd-unconditional&for&extension)
exten => *72,n,SayDigits(${fromext})
exten => *72,n,Playback(is-set-to)
exten => *72,n,SayDigits(${toext})
exten => *72,n,Macro(hangupcall,)

exten => _*72.,1,Answer
exten => _*72.,n,Wait(1)
exten => _*72.,n,Macro(user-callerid,)
exten => _*72.,n,Set(fromext=${AMPUSER})
exten => _*72.,n,Set(toext=${EXTEN:3})
exten => _*72.,n,Set(DB(CF/${fromext})=${toext})
exten => _*72.,n(hook_2),Playback(call-fwd-unconditional&for&extension)
exten => _*72.,n,SayDigits(${fromext})
exten => _*72.,n,Playback(is-set-to)
exten => _*72.,n,SayDigits(${toext})
exten => _*72.,n,Macro(hangupcall,)

;--== end of [app-cf-on] ==--;


[app-cf-prompting-on]
include => app-cf-prompting-on-custom
exten => *720,1,Answer
exten => *720,n,Wait(1)
exten => *720,n,Macro(user-callerid,)
exten => *720,n,Read(fromext,call-fwd-unconditional&please-enter-your&extension&then-press-pound,,,,)
exten => *720,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *720,n,Wait(1)
exten => *720,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *720,n,GotoIf($["foo${toext}"="foo"]?startread)
exten => *720,n,Wait(1)
exten => *720,n,Set(DB(CF/${fromext})=${toext})
exten => *720,n(hook_1),Playback(call-fwd-unconditional&for&extension)
exten => *720,n,SayDigits(${fromext})
exten => *720,n,Playback(is-set-to)
exten => *720,n,SayDigits(${toext})
exten => *720,n,Macro(hangupcall,)

exten => _*720.,1,Answer
exten => _*720.,n,Wait(1)
exten => _*720.,n,Macro(user-callerid,)
exten => _*720.,n,Set(fromext=${AMPUSER})
exten => _*720.,n,Set(toext=${EXTEN:4})
exten => _*720.,n,Set(DB(CF/${fromext})=${toext})
exten => _*720.,n(hook_2),Playback(call-fwd-unconditional&for&extension)
exten => _*720.,n,SayDigits(${fromext})
exten => _*720.,n,Playback(is-set-to)
exten => _*720.,n,SayDigits(${toext})
exten => _*720.,n,Macro(hangupcall,)

;--== end of [app-cf-prompting-on] ==--;


[app-cf-unavailable-off]
include => app-cf-unavailable-off-custom
exten => *53,1,Answer
exten => *53,n,Wait(1)
exten => *53,n,Macro(user-callerid,)
exten => *53,n,Set(fromext=${AMPUSER})
exten => *53,n,Noop(Deleting: CFU/${fromext} ${DB_DELETE(CFU/${fromext})})
exten => *53,n(hook_1),Playback(call-fwd-no-ans&de-activated)
exten => *53,n,Macro(hangupcall,)

exten => _*53.,1,Answer
exten => _*53.,n,Wait(1)
exten => _*53.,n,Set(fromext=${EXTEN:3})
exten => _*53.,n,Noop(Deleting: CFU/${fromext} ${DB_DELETE(CFU/${fromext})})
exten => _*53.,n(hook_2),Playback(call-fwd-no-ans&for&extension)
exten => _*53.,n,SayDigits(${fromext})
exten => _*53.,n,Playback(cancelled)
exten => _*53.,n,Macro(hangupcall,)

;--== end of [app-cf-unavailable-off] ==--;


[app-cf-unavailable-on]
include => app-cf-unavailable-on-custom
exten => *52,1,Answer
exten => *52,n,Wait(1)
exten => *52,n,Macro(user-callerid,)
exten => *52,n,Set(fromext=${AMPUSER})
exten => *52,n,GotoIf($["${fromext}"!=""]?startread)
exten => *52,n,Playback(agent-loggedoff)
exten => *52,n,Macro(hangupcall,)
exten => *52,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *52,n,GotoIf($["${toext}"=""]?startread)
exten => *52,n,Wait(1)
exten => *52,n,Set(DB(CFU/${fromext})=${toext})
exten => *52,n(hook_1),Playback(call-fwd-no-ans&for&extension)
exten => *52,n,SayDigits(${fromext})
exten => *52,n,Playback(is-set-to)
exten => *52,n,SayDigits(${toext})
exten => *52,n,Macro(hangupcall,)

exten => _*52.,1,Answer
exten => _*52.,n,Wait(1)
exten => _*52.,n,Macro(user-callerid,)
exten => _*52.,n,Set(fromext=${AMPUSER})
exten => _*52.,n,Set(toext=${EXTEN:3})
exten => _*52.,n,Set(DB(CFU/${fromext})=${toext})
exten => _*52.,n(hook_2),Playback(call-fwd-no-ans&for&extension)
exten => _*52.,n,SayDigits(${fromext})
exten => _*52.,n,Playback(is-set-to)
exten => _*52.,n,SayDigits(${toext})
exten => _*52.,n,Macro(hangupcall,)

;--== end of [app-cf-unavailable-on] ==--;


[app-cf-unavailable-prompt-on]
include => app-cf-unavailable-prompt-on-custom
exten => *520,1,Answer
exten => *520,n,Wait(1)
exten => *520,n,Macro(user-callerid,)
exten => *520,n,Read(fromext,call-fwd-no-ans&please-enter-your&extension&then-press-pound,,,,)
exten => *520,n,Set(fromext=${IF($["${fromext}"=""]?${AMPUSER}:${fromext})})
exten => *520,n,Wait(1)
exten => *520,n(startread),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => *520,n,GotoIf($["${toext}"=""]?startread)
exten => *520,n,Wait(1)
exten => *520,n,Set(DB(CFU/${fromext})=${toext})
exten => *520,n(hook_1),Playback(call-fwd-no-ans&for&extension)
exten => *520,n,SayDigits(${fromext})
exten => *520,n,Playback(is-set-to)
exten => *520,n,SayDigits(${toext})
exten => *520,n,Macro(hangupcall,)

exten => _*520.,1,Answer
exten => _*520.,n,Wait(1)
exten => _*520.,n,Macro(user-callerid,)
exten => _*520.,n,Set(fromext=${AMPUSER})
exten => _*520.,n,Set(toext=${EXTEN:4})
exten => _*520.,n,Set(DB(CFU/${fromext})=${toext})
exten => _*520.,n(hook_2),Playback(call-fwd-no-ans&for&extension)
exten => _*520.,n,SayDigits(${fromext})
exten => _*520.,n,Playback(is-set-to)
exten => _*520.,n,SayDigits(${toext})
exten => _*520.,n,Macro(hangupcall,)

;--== end of [app-cf-unavailable-prompt-on] ==--;


[cidlookup]
include => cidlookup-custom
exten => cidlookup_1,1,Set(CURLOPT(httptimeout)=7)
exten => cidlookup_1,n,Set(CALLERID(name)=${CURL(https://api.opencnam.com/v2/phone/${CALLERID(num)}?format=pbx&ref=issabelpbx)})
exten => cidlookup_1,n,Set(current_hour=${STRFTIME(,,%Y-%m-%d %H)})
exten => cidlookup_1,n,Set(last_query_hour=${DB(cidlookup/opencnam_last_query_hour)})
exten => cidlookup_1,n,Set(total_hourly_queries=${DB(cidlookup/opencnam_total_hourly_queries)})
exten => cidlookup_1,n,ExecIf($["${last_query_hour}" != "${current_hour}"]?Set(DB(cidlookup/opencnam_total_hourly_queries)=0))
exten => cidlookup_1,n,ExecIf($["${total_hourly_queries}" = ""]?Set(DB(cidlookup/opencnam_total_hourly_queries)=0))
exten => cidlookup_1,n,Set(DB(cidlookup/opencnam_total_hourly_queries)=${MATH(${DB(cidlookup/opencnam_total_hourly_queries)}+1,i)})
exten => cidlookup_1,n,ExecIf($[${DB(cidlookup/opencnam_total_hourly_queries)} >= 60]?System(${ASTVARLIBDIR}/bin/opencnam-alert.php))
exten => cidlookup_1,n,Set(DB(cidlookup/opencnam_last_query_hour)=${current_hour})
exten => cidlookup_1,n,Return()

exten => cidlookup_return,1,ExecIf($["${DB(cidname/${CALLERID(num)})}" != ""]?Set(CALLERID(name)=${DB(cidname/${CALLERID(num)})}))
exten => cidlookup_return,n,Return()

;--== end of [cidlookup] ==--;


[app-dnd-off]
include => app-dnd-off-custom
exten => *79,1,Answer
exten => *79,n,Wait(1)
exten => *79,n,Macro(user-callerid,)
exten => *79,n,Noop(Deleting: DND/${AMPUSER} ${DB_DELETE(DND/${AMPUSER})})
exten => *79,n(hook_1),Playback(do-not-disturb&de-activated)
exten => *79,n,Macro(hangupcall,)

;--== end of [app-dnd-off] ==--;


[app-dnd-on]
include => app-dnd-on-custom
exten => *78,1,Answer
exten => *78,n,Wait(1)
exten => *78,n,Macro(user-callerid,)
exten => *78,n,Set(DB(DND/${AMPUSER})=YES)
exten => *78,n(hook_1),Playback(do-not-disturb&activated)
exten => *78,n,Macro(hangupcall,)

;--== end of [app-dnd-on] ==--;


[app-dnd-toggle]
include => app-dnd-toggle-custom
exten => *76,1,Answer
exten => *76,n,Wait(1)
exten => *76,n,Macro(user-callerid,)
exten => *76,n,GotoIf($["${DB(DND/${AMPUSER})}" = ""]?activate:deactivate)
exten => *76,n(activate),Set(DB(DND/${AMPUSER})=YES)
exten => *76,n(hook_on),Playback(do-not-disturb&activated)
exten => *76,n,Macro(hangupcall,)
exten => *76,n(deactivate),Noop(Deleting: DND/${AMPUSER} ${DB_DELETE(DND/${AMPUSER})})
exten => *76,n(hook_off),Playback(do-not-disturb&de-activated)
exten => *76,n,Macro(hangupcall,)

;--== end of [app-dnd-toggle] ==--;


[macro-speeddial-lookup]
include => macro-speeddial-lookup-custom
exten => s,1,GotoIf($["${ARG2}"=""]]?lookupsys)
exten => s,n,Set(SPEEDDIALNUMBER=)
exten => s,n(lookupuser),Set(SPEEDDIALNUMBER=${DB(AMPUSER/${ARG2}/speeddials/${ARG1})})
exten => s,n,GotoIf($["${SPEEDDIALNUMBER}"=""]?lookupsys)
exten => s,n,Noop(Found speeddial ${ARG1} for user ${ARG2}: ${SPEEDDIALNUMBER})
exten => s,n,Goto(end)
exten => s,lookupuser+101(lookupsys),Set(SPEEDDIALNUMBER=${DB(sysspeeddials/${ARG1})})
exten => s,n,GotoIf($["${SPEEDDIALNUMBER}"=""]?failed)
exten => s,n,Noop(Found system speeddial ${ARG1}: ${SPEEDDIALNUMBER})
exten => s,n,Goto(end)
exten => s,lookupsys+101(failed),Noop(No system or user speeddial found)
exten => s,n(end),Noop(End of Speeddial-lookup)

;--== end of [macro-speeddial-lookup] ==--;


[app-speeddial]
include => app-speeddial-custom
exten => _*0.,1,Macro(user-callerid,)
exten => _*0.,n,Set(SPEEDDIALLOCATION=${EXTEN:2})
exten => _*0.,n(lookup),Macro(speeddial-lookup,${SPEEDDIALLOCATION},${AMPUSER})
exten => _*0.,n,GotoIf($["${SPEEDDIALNUMBER}"=""]?failed)
exten => _*0.,n,Goto(from-internal,${SPEEDDIALNUMBER},1)
exten => _*0.,lookup+101(failed),Playback(speed-dial-empty)
exten => _*0.,n,Congestion()

exten => *75,1,Goto(app-speeddial-set,s,1)

;--== end of [app-speeddial] ==--;


[app-speeddial-set]
include => app-speeddial-set-custom
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-speeddial-set,${CHANNEL(language)})}]?app-speeddial-set,${CHANNEL(language)},${ARG1}():app-speeddial-set,en,${ARG1}())
exten => lang-playback,n,Return()

exten => s,1,Macro(user-callerid,)
exten => s,n(setloc),Read(newlocation,speed-enterlocation,,,,)
exten => s,n(lookup),Macro(speeddial-lookup,${newlocation},${AMPUSER})
exten => s,n,GotoIf($["${SPEEDDIALNUMBER}"!=""]?conflicts)
exten => s,n(setnum),Read(newnum,speed-enternumber,,,,)
exten => s,n(success),Set(DB(AMPUSER/${AMPUSER}/speeddials/${newlocation})=${newnum})
exten => s,n,Gosub(app-speeddial-set,lang-playback,1(hook_0))
exten => s,n,Hangup
exten => s,n(conflicts),Gosub(app-speeddial-set,lang-playback,1(hook_1))
exten => s,n,WaitExten(60,)

exten => 1,1,Gosub(app-speeddial-set,lang-playback,1(hook_2))
exten => 1,n,Goto(s,conflicts)

exten => 2,1,Goto(s,setloc)

exten => 3,1,Goto(s,setnum)

exten => t,1,Congestion()

exten => en,1(hook_0),Playback(speed-dial)
exten => en,n,SayDigits(${newlocation})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${newnum})
exten => en,n,Return()
exten => en,n(hook_1),Playback(speed-dial)
exten => en,n,SayDigits(${newlocation})
exten => en,n,Playback(is-in-use)
exten => en,n,Background(press-1&to-listen-to-it&press-2&to-enter-a-diff&location&press-3&to-change&telephone-number)
exten => en,n,Return()
exten => en,n(hook_2),Playback(speed-dial)
exten => en,n,SayDigits(${newlocation})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${SPEEDDIALNUMBER})
exten => en,n,Return()

exten => ja,1(hook_0),Playback(speed-dial)
exten => ja,n,SayDigits(${newlocation})
exten => ja,n,Playback(jp-wo)
exten => ja,n,SayDigits(${newnum})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(speed-dial)
exten => ja,n,SayDigits(${newlocation})
exten => ja,n,Playback(jp-wa&is-in-use)
exten => ja,n,Background(list&press-1&to-enter-a-diff&location&jp-wo&to-enter&press-2&telephone-number&jp-wo&to-change&press-3)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(speed-dial)
exten => ja,n,SayDigits(${newlocation})
exten => ja,n,Playback(jp-wa)
exten => ja,n,SayDigits(${SPEEDDIALNUMBER})
exten => ja,n,Playback(is-set-to-2)
exten => ja,n,Return()

;--== end of [app-speeddial-set] ==--;


[app-dialvm]
include => app-dialvm-custom
exten => *98,1,Macro(user-callerid,)
exten => *98,n,Answer
exten => *98,n(start),Wait(1)
exten => *98,n,Noop(app-dialvm: Asking for mailbox)
exten => *98,n,Read(MAILBOX,vm-login,,,3,2)
exten => *98,n(check),Noop(app-dialvm: Got Mailbox ${MAILBOX})
exten => *98,n,Macro(get-vmcontext,${MAILBOX})
exten => *98,n,Set(VMBOXEXISTSSTATUS=${IF(${VM_INFO(${MAILBOX}@${VMCONTEXT},exists)}?SUCCESS:FAILED)})
exten => *98,n,GotoIf($["${VMBOXEXISTSSTATUS}" = "SUCCESS"]?good:bad)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(good),Noop(app-dialvm: Good mailbox ${MAILBOX}@${VMCONTEXT})
exten => *98,n,VoiceMailMain(${MAILBOX}@${VMCONTEXT})
exten => *98,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(bad),Noop(app-dialvm: BAD mailbox ${MAILBOX}@${VMCONTEXT})
exten => *98,n,Wait(1)
exten => *98,n,Noop(app-dialvm: Asking for password so people can't probe for existence of a mailbox)
exten => *98,n,Read(FAKEPW,vm-password,,,3,2)
exten => *98,n,Noop(app-dialvm: Asking for mailbox again)
exten => *98,n,Read(MAILBOX,vm-incorrect-mailbox,,,3,2)
exten => *98,n,Goto(check)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(playret),Playback(beep&you-will-be-transfered-menu&silence/1)
exten => *98,n,Goto(${IVR_CONTEXT},return,1)

exten => _*98.,1,Answer
exten => _*98.,n,Wait(1)
exten => _*98.,n,Macro(get-vmcontext,${EXTEN:3})
exten => _*98.,n,VoiceMailMain(${EXTEN:3}@${VMCONTEXT})
exten => _*98.,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?${IVR_CONTEXT},return,1)
exten => _*98.,n,Macro(hangupcall,)

;--== end of [app-dialvm] ==--;


[app-vmmain]
include => app-vmmain-custom
exten => *97,1,Answer
exten => *97,n,Wait(1)
exten => *97,n,Macro(user-callerid,)
exten => *97,n,Macro(get-vmcontext,${AMPUSER})
exten => *97,n(check),Set(VMBOXEXISTSSTATUS=${IF(${VM_INFO(${AMPUSER}@${VMCONTEXT},exists)}?SUCCESS:FAILED)})
exten => *97,n,GotoIf($["${VMBOXEXISTSSTATUS}" = "SUCCESS"]?mbexist)
exten => *97,n,VoiceMailMain()
exten => *97,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *97,n,Macro(hangupcall,)
exten => *97,check+101(mbexist),VoiceMailMain(${AMPUSER}@${VMCONTEXT})
exten => *97,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *97,n,Macro(hangupcall,)
exten => *97,n(playret),Playback(beep&you-will-be-transfered-menu&silence/1)
exten => *97,n,Goto(${IVR_CONTEXT},return,1)

;--== end of [app-vmmain] ==--;


[ext-group]
include => ext-group-custom
exten => h,1,Macro(hangupcall,)

;--== end of [ext-group] ==--;


[app-calltrace]
include => app-calltrace-custom
exten => *69,1,Goto(app-calltrace-perform,s,1)

;--== end of [app-calltrace] ==--;


[app-calltrace-perform]
include => app-calltrace-perform-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Playback(info-about-last-call&telephone-number)
exten => s,n,Set(lastcaller=${DB(CALLTRACE/${AMPUSER})})
exten => s,n,GotoIf($[ $[ "${lastcaller}" = "" ] | $[ "${lastcaller}" = "unknown" ] ]?noinfo)
exten => s,n,SayDigits(${lastcaller})
exten => s,n,Set(TIMEOUT(digit)=3)
exten => s,n,Set(TIMEOUT(response)=7)
exten => s,n,Background(to-call-this-number&press-1)
exten => s,n,Goto(fin)
exten => s,n(noinfo),Playback(from-unknown-caller)
exten => s,n,Macro(hangupcall,)
exten => s,n(fin),Noop(Waiting for input)
exten => s,n,WaitExten(60,)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)

exten => 1,1,Goto(from-internal,${lastcaller},1)

exten => i,1,Playback(vm-goodbye)
exten => i,n,Macro(hangupcall,)

exten => t,1,Playback(vm-goodbye)
exten => t,n,Macro(hangupcall,)

;--== end of [app-calltrace-perform] ==--;


[app-echo-test]
include => app-echo-test-custom
exten => *43,1,Answer
exten => *43,n,Macro(user-callerid,)
exten => *43,n,Wait(1)
exten => *43,n,Playback(demo-echotest)
exten => *43,n,Echo()
exten => *43,n,Playback(demo-echodone)
exten => *43,n,Hangup

;--== end of [app-echo-test] ==--;


[app-speakextennum]
include => app-speakextennum-custom
exten => *65,1,Answer
exten => *65,n,Wait(1)
exten => *65,n,Macro(user-callerid,)
exten => *65,n,Playback(your)
exten => *65,n,Playback(extension)
exten => *65,n,Playback(number)
exten => *65,n,Playback(is)
exten => *65,n,SayDigits(${AMPUSER})
exten => *65,n,Wait(2)
exten => *65,n,Hangup

;--== end of [app-speakextennum] ==--;


[sub-hr12format]
include => sub-hr12format-custom
exten => s,1,Goto(${CHANNEL(language)},1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(sub-hr12format,${CHANNEL(language)},1)}]?${CHANNEL(language)},1:en,1)

exten => i,1,Playback(at-tone-time-exactly)
exten => i,n,SayUnixTime(${FutureTime},,IM 'and' S 'seconds' p)
exten => i,n,Return()

exten => de,1,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,IMSp)
exten => de,n,Return()
exten => de,n,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,IMSp)
exten => de,n,Return()

exten => en,1,Playback(at-tone-time-exactly)
exten => en,n,SayUnixTime(${FutureTime},,IM 'and' S 'seconds' p)
exten => en,n,Return()

;--== end of [sub-hr12format] ==--;


[app-speakingclock]
include => app-speakingclock-custom
exten => *60,1,Macro(user-callerid,)
exten => *60,n,Answer
exten => *60,n,Wait(1)
exten => *60,n,Set(NumLoops=0)
exten => *60,n(start),Set(FutureTime=$[${EPOCH} + 11])
exten => *60,n,Gosub(sub-hr12format,s,1())
exten => *60,n(waitloop),Set(TimeLeft=$[${FutureTime} - ${EPOCH}])
exten => *60,n,GotoIf($[${TimeLeft} < 1]?playbeep)
exten => *60,n,Wait(1)
exten => *60,n,Goto(waitloop)
exten => *60,n(playbeep),Playback(beep)
exten => *60,n,Wait(5)
exten => *60,n,Set(NumLoops=$[${NumLoops} + 1])
exten => *60,n,GotoIf($[${NumLoops} < 5]?start)
exten => *60,n,Playback(goodbye)
exten => *60,n,Hangup

;--== end of [app-speakingclock] ==--;


[sub-hr24format]
include => sub-hr24format-custom
exten => s,1,GotoIf($[${DIALPLAN_EXISTS(sub-hr24format,${CHANNEL(language)},1)}]?${CHANNEL(language)},1:en,1)

exten => en,1,Playback(at-tone-time-exactly)
exten => en,n,SayUnixTime(${FutureTime},,kM 'and' S 'seconds')
exten => en,n,Return()

exten => de,1,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,kMS)
exten => de,n,Return()

;--== end of [sub-hr24format] ==--;


[app-pbdirectory]
include => app-pbdirectory-custom
exten => 411,1,Goto(pbdirectory,1)

exten => pbdirectory,1,Answer
exten => pbdirectory,n,Wait(1)
exten => pbdirectory,n,Macro(user-callerid,)
exten => pbdirectory,n,AGI(pbdirectory)
exten => pbdirectory,n,GotoIf($["${dialnumber}"=""]?hangup,1)
exten => pbdirectory,n,Noop(Got number to dial: ${dialnumber})
exten => pbdirectory,n,Dial(Local/${dialnumber}@from-internal/n,)

exten => hangup,1,Hangup

;--== end of [app-pbdirectory] ==--;


[app-fmf-toggle]
include => app-fmf-toggle-custom
exten => *21,1,Goto(app-fmf-toggle,s,start)

exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/followme/ddial)}" = "EXTENSION"]?activate)
exten => s,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/followme/ddial)}" = "DIRECT"]?deactivate:end)
exten => s,n(deactivate),Set(DB(AMPUSER/${AMPUSER}/followme/ddial)=EXTENSION)
exten => s,n(hook_off),Playback(followme&de-activated)
exten => s,n(end),Macro(hangupcall,)
exten => s,n(activate),Set(DB(AMPUSER/${AMPUSER}/followme/ddial)=DIRECT)
exten => s,n(hook_on),Playback(followme&activated)
exten => s,n,Macro(hangupcall,)

;--== end of [app-fmf-toggle] ==--;


[app-dictate-record]
include => app-dictate-record-custom
exten => *34,1,Answer
exten => *34,n,Macro(user-callerid,)
exten => *34,n,Noop(CallerID is ${AMPUSER})
exten => *34,n,Set(DICTENABLED=${DB(AMPUSER/${AMPUSER}/dictate/enabled)})
exten => *34,n,GotoIf($[$["x${DICTENABLED}"="x"]|$["x${DICTENABLED}"="xdisabled"]]?nodict:dictok)
exten => *34,n(nodict),Playback(feature-not-avail-line)
exten => *34,n,Hangup
exten => *34,n(dictok),Dictate(/var/lib/asterisk/sounds/dictate/${AMPUSER})
exten => *34,n,Macro(hangupcall,)

;--== end of [app-dictate-record] ==--;


[app-dictate-send]
include => app-dictate-send-custom
exten => *35,1,Answer
exten => *35,n,Macro(user-callerid,)
exten => *35,n,Noop(CallerID is ${AMPUSER})
exten => *35,n,Set(DICTENABLED=${DB(AMPUSER/${AMPUSER}/dictate/enabled)})
exten => *35,n,GotoIf($[$["x${DICTENABLED}"="x"]|$["x${DICTENABLED}"="xdisabled"]]?nodict:dictok)
exten => *35,n(nodict),Playback(feature-not-avail-line)
exten => *35,n,Hangup
exten => *35,n(dictok),Read(DICTFILE,enter-filename-short,,,,)
exten => *35,n,Set(DICTEMAIL=${DB(AMPUSER/${AMPUSER}/dictate/email)})
exten => *35,n,Set(DICTFMT=${DB(AMPUSER/${AMPUSER}/dictate/format)})
exten => *35,n,Set(NAME=${DB(AMPUSER/${AMPUSER}/cidname)})
exten => *35,n,Playback(dictation-being-processed)
exten => *35,n,System(/var/lib/asterisk/bin/audio-email.pl --file /var/lib/asterisk/sounds/dictate/${AMPUSER}/${DICTFILE}.raw --attachment dict-${DICTFILE} --format ${DICTFMT} --to ${DICTEMAIL} --subject "Dictation from ${NAME} Attached")
exten => *35,n,Playback(dictation-sent)
exten => *35,n,Macro(hangupcall,)

;--== end of [app-dictate-send] ==--;


[macro-autoanswer]
include => macro-autoanswer-custom
exten => s,1,Set(DIAL=${DB(DEVICE/${ARG1}/dial)})
exten => s,n,ExecIf($["${DIAL:0:3}" = "ZAP"]?Set(DIAL=DAHDI${DIAL:3}))
exten => s,n,GotoIf($["${DB(DEVICE/${ARG1}/autoanswer/macro)}" != "" ]?macro)
exten => s,n,Set(phone=${SIPPEER(${CUT(DIAL,/,2)}:useragent)})
exten => s,n,ExecIf($["${phone:0:5}" = "Mitel"]?Set(CALLINFO=Call-Info: <sip:broadworks.net>\;answer-after=0))
exten => s,n,ExecIf($["${phone:0:9}" = "Panasonic"]?Set(ALERTINFO=Alert-Info: Intercom))
exten => s,n,ExecIf($["${phone:0:7}" = "Polycom"]?Set(ALERTINFO=Alert-Info: info=Auto Answer))
exten => s,n,ExecIf($["${phone:0:6}" = "Digium"]?Set(ALERTINFO=Alert-Info: ring-answer))
exten => s,n,ExecIf($["${ALERTINFO}" != ""]?SipAddHeader(${ALERTINFO}))
exten => s,n,ExecIf($["${CALLINFO}" != ""]?SipAddHeader(${CALLINFO}))
exten => s,n,ExecIf($["${SIPURI}" != ""]?Set(__SIP_URI_OPTIONS=${SIPURI}))
exten => s,n+2(macro),Macro(${DB(DEVICE/${ARG1}/autoanswer/macro)},${ARG1})

;--== end of [macro-autoanswer] ==--;


[app-paging]
include => app-paging-custom
exten => ssetup,1,Set(_SIPURI=)
exten => ssetup,n,Set(_ALERTINFO=Alert-Info: Ring Answer)
exten => ssetup,n,Set(_CALLINFO=Call-Info: <uri>\;answer-after=0)
exten => ssetup,n,Set(_SIPURI=intercom=true)
exten => ssetup,n,Set(_DOPTIONS=A(beep))
exten => ssetup,n,Set(_DTIME=5)
exten => ssetup,n,Set(_ANSWERMACRO=)
exten => ssetup,n,Set(PAGE_CONF=${EPOCH}${RAND(100,999)})
exten => ssetup,n,Return()

exten => _PAGE.,1(SKIPCHECK),Macro(autoanswer,${EXTEN:4})
exten => _PAGE.,n,Dial(${DIAL},${DTIME},${DOPTIONS})
exten => _PAGE.,n(skipself),Hangup

exten => _SPAGE.,1(chanspy),ChanSpy(${SP_DEVICE}-,qW)
exten => _SPAGE.,n,Hangup

;--== end of [app-paging] ==--;


[app-gabcast]
include => app-gabcast-custom
exten => *422,1,Macro(user-callerid,)
exten => *422,n,Goto(gabcast,${AMPUSER},1)

;--== end of [app-gabcast] ==--;


[gabcast]
include => gabcast-custom
exten => _X.,1,Dial(IAX2/iax.gabcast.com/422,120,tr)

exten => s,1,Dial(IAX2/iax.gabcast.com/422,120,tr)

;--== end of [gabcast] ==--;


[app-userlogonoff]
include => app-userlogonoff-custom
exten => *12,1,Macro(user-logoff,)
exten => *12,n(hook_off),Hangup

exten => *11,1,Macro(user-logon,)
exten => *11,n(hook_on_1),Hangup

exten => _*11.,1,Macro(user-logon,${EXTEN:3},)
exten => _*11.,n(hook_on_2),Hangup

;--== end of [app-userlogonoff] ==--;


[ext-local-confirm]
include => ext-local-confirm-custom
exten => _LC-.,1,ExecIf($["${ALERT_INFO}"!=""]?SIPAddHeader(Alert-Info: ${ALERT_INFO}))
exten => _LC-.,n,Dial(${DB(DEVICE/${EXTEN:3}/dial)},${RT},${DIAL_OPTIONS}M(auto-confirm^${RG_IDX}))

;--== end of [ext-local-confirm] ==--;


[findmefollow-ringallv2]
include => findmefollow-ringallv2-custom
exten => _FMPR-.,1,NoCDR()
exten => _FMPR-.,n,Set(RingGroupMethod=)
exten => _FMPR-.,n,Set(USE_CONFIRMATION=)
exten => _FMPR-.,n,Set(RINGGROUP_INDEX=)
exten => _FMPR-.,n,Macro(simple-dial,${EXTEN:5},${FMREALPRERING})
exten => _FMPR-.,n,ExecIf($["${DIALSTATUS}" = "BUSY"]?Set(SHARED(FM_DND,${FMUNIQUE})=DND))
exten => _FMPR-.,n,Hangup

exten => _FMGL-.,1,NoCDR()
exten => _FMGL-.,n,Set(ENDLOOP=$[${EPOCH} + ${FMPRERING} + 2])
exten => _FMGL-.,n(start),GotoIf($["${SHARED(FM_DND,${FMUNIQUE})}" = "DND"]?dodnd)
exten => _FMGL-.,n,Wait(1)
exten => _FMGL-.,n,GotoIf($[${EPOCH} < ${ENDLOOP}]?start)
exten => _FMGL-.,n,Set(SHARED(FM_DND,${FMUNIQUE})=)
exten => _FMGL-.,n(dodial),Macro(dial,${FMGRPTIME},${DIAL_OPTIONS},${EXTEN:5})
exten => _FMGL-.,n,Hangup
exten => _FMGL-.,n+10(dodnd),Set(SHARED(FM_DND,${FMUNIQUE})=)
exten => _FMGL-.,n,GotoIf($["${FMPRIME}" = "FALSE"]?dodial)
exten => _FMGL-.,n,Hangup

;--== end of [findmefollow-ringallv2] ==--;


[app-pickup]
include => app-pickup-custom
exten => _**.,1,Macro(user-callerid,)
exten => _**.,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => _**.,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => _**.,n,Hangup

;--== end of [app-pickup] ==--;


[app-zapbarge]
include => app-zapbarge-custom
exten => 888,1,Macro(user-callerid,)
exten => 888,n,Set(GROUP()=${CALLERID(number)})
exten => 888,n,Answer
exten => 888,n,Wait(1)
exten => 888,n,DAHDIBarge()
exten => 888,n,Hangup

;--== end of [app-zapbarge] ==--;


[app-chanspy]
include => app-chanspy-custom
exten => 555,1,Macro(user-callerid,)
exten => 555,n,Answer
exten => 555,n,Wait(1)
exten => 555,n,ChanSpy()
exten => 555,n,Hangup

;--== end of [app-chanspy] ==--;


[ext-test]
include => ext-test-custom
exten => 7777,1,Macro(user-callerid,)
exten => 7777,n,Goto(from-pstn,${EXTEN},1)

exten => h,1,Macro(hangupcall,)

;--== end of [ext-test] ==--;


[ext-did]
include => ext-did-custom
include => ext-did-0001
include => ext-did-0002
exten => foo,1,Noop(bar)

;--== end of [ext-did] ==--;


[ext-did-catchall]
include => ext-did-catchall-custom
exten => s,1,Noop(No DID or CID Match)
exten => s,n(a2),Answer
exten => s,n,Wait(2)
exten => s,n,Playback(ss-noservice)
exten => s,n,SayAlpha(${FROM_DID})
exten => s,n,Hangup

exten => _.,1,Set(__FROM_DID=${EXTEN})
exten => _.,n,Noop(Received an unknown call with DID set to ${EXTEN})
exten => _.,n,Goto(s,a2)

exten => h,1,Hangup

;--== end of [ext-did-catchall] ==--;


[ext-local]
include => ext-local-custom
exten => 0323,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/0323/ringtimer)} > 0]?${DB(AMPUSER/0323/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 0323,n,Macro(exten-vm,novm,0323,0,0,0)
exten => 0323,n(dest),Set(__PICKUPMARK=)
exten => 0323,n,Goto(${IVR_CONTEXT},return,1)
exten => 0323,n,Goto(from-internal,0323,1)
exten => 0323,hint,SIP/323,CustomPresence:0323

exten => 2001,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2001/ringtimer)} > 0]?${DB(AMPUSER/2001/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2001,n,Macro(exten-vm,novm,2001,0,0,0)
exten => 2001,n(dest),Set(__PICKUPMARK=)
exten => 2001,n,Goto(${IVR_CONTEXT},return,1)
exten => 2001,n,Goto(from-internal,2001,1)
exten => 2001,hint,SIP/2001,CustomPresence:2001

exten => 2002,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2002/ringtimer)} > 0]?${DB(AMPUSER/2002/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2002,n,Macro(exten-vm,novm,2002,0,0,0)
exten => 2002,n(dest),Set(__PICKUPMARK=)
exten => 2002,n,Goto(${IVR_CONTEXT},return,1)
exten => 2002,n,Goto(from-internal,2002,1)
exten => 2002,hint,SIP/2002,CustomPresence:2002

exten => 2003,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2003/ringtimer)} > 0]?${DB(AMPUSER/2003/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2003,n,Macro(exten-vm,novm,2003,0,0,0)
exten => 2003,n(dest),Set(__PICKUPMARK=)
exten => 2003,n,Goto(${IVR_CONTEXT},return,1)
exten => 2003,n,Goto(from-internal,2003,1)
exten => 2003,hint,SIP/2003,CustomPresence:2003

exten => 2004,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2004/ringtimer)} > 0]?${DB(AMPUSER/2004/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2004,n,Macro(exten-vm,novm,2004,0,0,0)
exten => 2004,n(dest),Set(__PICKUPMARK=)
exten => 2004,n,Goto(${IVR_CONTEXT},return,1)
exten => 2004,n,Goto(from-internal,2004,1)
exten => 2004,hint,SIP/2004,CustomPresence:2004

exten => 2005,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2005/ringtimer)} > 0]?${DB(AMPUSER/2005/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2005,n,Macro(exten-vm,novm,2005,0,0,0)
exten => 2005,n(dest),Set(__PICKUPMARK=)
exten => 2005,n,Goto(${IVR_CONTEXT},return,1)
exten => 2005,n,Goto(from-internal,2005,1)
exten => 2005,hint,SIP/2005,CustomPresence:2005

exten => 2006,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2006/ringtimer)} > 0]?${DB(AMPUSER/2006/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2006,n,Macro(exten-vm,novm,2006,0,0,0)
exten => 2006,n(dest),Set(__PICKUPMARK=)
exten => 2006,n,Goto(${IVR_CONTEXT},return,1)
exten => 2006,n,Goto(from-internal,2006,1)
exten => 2006,hint,SIP/2006,CustomPresence:2006

exten => 2021,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2021/ringtimer)} > 0]?${DB(AMPUSER/2021/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2021,n,Macro(exten-vm,novm,2021,0,0,0)
exten => 2021,n(dest),Set(__PICKUPMARK=)
exten => 2021,n,Goto(${IVR_CONTEXT},return,1)
exten => 2021,n,Goto(from-internal,2021,1)
exten => 2021,hint,SIP/2021,CustomPresence:2021

exten => 2022,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2022/ringtimer)} > 0]?${DB(AMPUSER/2022/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2022,n,Macro(exten-vm,novm,2022,0,0,0)
exten => 2022,n(dest),Set(__PICKUPMARK=)
exten => 2022,n,Goto(${IVR_CONTEXT},return,1)
exten => 2022,n,Goto(from-internal,2022,1)
exten => 2022,hint,SIP/2022,CustomPresence:2022

exten => 2023,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2023/ringtimer)} > 0]?${DB(AMPUSER/2023/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2023,n,Macro(exten-vm,novm,2023,0,0,0)
exten => 2023,n(dest),Set(__PICKUPMARK=)
exten => 2023,n,Goto(${IVR_CONTEXT},return,1)
exten => 2023,n,Goto(from-internal,2023,1)
exten => 2023,hint,SIP/2023,CustomPresence:2023

exten => 2024,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2024/ringtimer)} > 0]?${DB(AMPUSER/2024/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2024,n,Macro(exten-vm,novm,2024,0,0,0)
exten => 2024,n(dest),Set(__PICKUPMARK=)
exten => 2024,n,Goto(${IVR_CONTEXT},return,1)
exten => 2024,n,Goto(from-internal,2024,1)
exten => 2024,hint,SIP/2024,CustomPresence:2024

exten => 2025,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2025/ringtimer)} > 0]?${DB(AMPUSER/2025/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2025,n,Macro(exten-vm,novm,2025,0,0,0)
exten => 2025,n(dest),Set(__PICKUPMARK=)
exten => 2025,n,Goto(${IVR_CONTEXT},return,1)
exten => 2025,n,Goto(from-internal,2025,1)
exten => 2025,hint,SIP/2025,CustomPresence:2025

exten => 2026,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2026/ringtimer)} > 0]?${DB(AMPUSER/2026/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2026,n,Macro(exten-vm,novm,2026,0,0,0)
exten => 2026,n(dest),Set(__PICKUPMARK=)
exten => 2026,n,Goto(${IVR_CONTEXT},return,1)
exten => 2026,n,Goto(from-internal,2026,1)
exten => 2026,hint,SIP/2026,CustomPresence:2026

exten => 2027,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2027/ringtimer)} > 0]?${DB(AMPUSER/2027/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2027,n,Macro(exten-vm,novm,2027,0,0,0)
exten => 2027,n(dest),Set(__PICKUPMARK=)
exten => 2027,n,Goto(${IVR_CONTEXT},return,1)
exten => 2027,n,Goto(from-internal,2027,1)
exten => 2027,hint,SIP/2027,CustomPresence:2027

exten => 2028,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2028/ringtimer)} > 0]?${DB(AMPUSER/2028/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2028,n,Macro(exten-vm,novm,2028,0,0,0)
exten => 2028,n(dest),Set(__PICKUPMARK=)
exten => 2028,n,Goto(${IVR_CONTEXT},return,1)
exten => 2028,n,Goto(from-internal,2028,1)
exten => 2028,hint,SIP/2028,CustomPresence:2028

exten => 2029,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2029/ringtimer)} > 0]?${DB(AMPUSER/2029/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2029,n,Macro(exten-vm,novm,2029,0,0,0)
exten => 2029,n(dest),Set(__PICKUPMARK=)
exten => 2029,n,Goto(${IVR_CONTEXT},return,1)
exten => 2029,n,Goto(from-internal,2029,1)
exten => 2029,hint,SIP/2029,CustomPresence:2029

exten => 2030,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2030/ringtimer)} > 0]?${DB(AMPUSER/2030/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2030,n,Macro(exten-vm,novm,2030,0,0,0)
exten => 2030,n(dest),Set(__PICKUPMARK=)
exten => 2030,n,Goto(${IVR_CONTEXT},return,1)
exten => 2030,n,Goto(from-internal,2030,1)
exten => 2030,hint,SIP/2030,CustomPresence:2030

exten => 2031,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2031/ringtimer)} > 0]?${DB(AMPUSER/2031/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2031,n,Macro(exten-vm,novm,2031,0,0,0)
exten => 2031,n(dest),Set(__PICKUPMARK=)
exten => 2031,n,Goto(${IVR_CONTEXT},return,1)
exten => 2031,n,Goto(from-internal,2031,1)
exten => 2031,hint,SIP/2031,CustomPresence:2031

exten => 2032,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2032/ringtimer)} > 0]?${DB(AMPUSER/2032/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2032,n,Macro(exten-vm,novm,2032,0,0,0)
exten => 2032,n(dest),Set(__PICKUPMARK=)
exten => 2032,n,Goto(${IVR_CONTEXT},return,1)
exten => 2032,n,Goto(from-internal,2032,1)
exten => 2032,hint,SIP/2032,CustomPresence:2032

exten => 2033,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2033/ringtimer)} > 0]?${DB(AMPUSER/2033/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2033,n,Macro(exten-vm,novm,2033,0,0,0)
exten => 2033,n(dest),Set(__PICKUPMARK=)
exten => 2033,n,Goto(${IVR_CONTEXT},return,1)
exten => 2033,n,Goto(from-internal,2033,1)
exten => 2033,hint,SIP/2033,CustomPresence:2033

exten => 2034,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2034/ringtimer)} > 0]?${DB(AMPUSER/2034/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2034,n,Macro(exten-vm,novm,2034,0,0,0)
exten => 2034,n(dest),Set(__PICKUPMARK=)
exten => 2034,n,Goto(${IVR_CONTEXT},return,1)
exten => 2034,n,Goto(from-internal,2034,1)
exten => 2034,hint,SIP/2034,CustomPresence:2034

exten => 2035,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2035/ringtimer)} > 0]?${DB(AMPUSER/2035/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2035,n,Macro(exten-vm,novm,2035,0,0,0)
exten => 2035,n(dest),Set(__PICKUPMARK=)
exten => 2035,n,Goto(${IVR_CONTEXT},return,1)
exten => 2035,n,Goto(from-internal,2035,1)
exten => 2035,hint,SIP/2035,CustomPresence:2035

exten => 2036,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2036/ringtimer)} > 0]?${DB(AMPUSER/2036/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2036,n,Macro(exten-vm,novm,2036,0,0,0)
exten => 2036,n(dest),Set(__PICKUPMARK=)
exten => 2036,n,Goto(${IVR_CONTEXT},return,1)
exten => 2036,n,Goto(from-internal,2036,1)
exten => 2036,hint,SIP/2036,CustomPresence:2036

exten => 2037,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2037/ringtimer)} > 0]?${DB(AMPUSER/2037/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2037,n,Macro(exten-vm,novm,2037,0,0,0)
exten => 2037,n(dest),Set(__PICKUPMARK=)
exten => 2037,n,Goto(${IVR_CONTEXT},return,1)
exten => 2037,n,Goto(from-internal,2037,1)
exten => 2037,hint,SIP/2037,CustomPresence:2037

exten => 2038,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2038/ringtimer)} > 0]?${DB(AMPUSER/2038/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2038,n,Macro(exten-vm,novm,2038,0,0,0)
exten => 2038,n(dest),Set(__PICKUPMARK=)
exten => 2038,n,Goto(${IVR_CONTEXT},return,1)
exten => 2038,n,Goto(from-internal,2038,1)
exten => 2038,hint,SIP/2038,CustomPresence:2038

exten => 2039,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2039/ringtimer)} > 0]?${DB(AMPUSER/2039/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2039,n,Macro(exten-vm,novm,2039,0,0,0)
exten => 2039,n(dest),Set(__PICKUPMARK=)
exten => 2039,n,Goto(${IVR_CONTEXT},return,1)
exten => 2039,n,Goto(from-internal,2039,1)
exten => 2039,hint,SIP/2039,CustomPresence:2039

exten => 2040,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2040/ringtimer)} > 0]?${DB(AMPUSER/2040/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2040,n,Macro(exten-vm,novm,2040,0,0,0)
exten => 2040,n(dest),Set(__PICKUPMARK=)
exten => 2040,n,Goto(${IVR_CONTEXT},return,1)
exten => 2040,n,Goto(from-internal,2040,1)
exten => 2040,hint,SIP/2040,CustomPresence:2040

exten => 2041,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2041/ringtimer)} > 0]?${DB(AMPUSER/2041/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2041,n,Macro(exten-vm,novm,2041,0,0,0)
exten => 2041,n(dest),Set(__PICKUPMARK=)
exten => 2041,n,Goto(${IVR_CONTEXT},return,1)
exten => 2041,hint,SIP/2041,CustomPresence:2041

exten => 2042,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2042/ringtimer)} > 0]?${DB(AMPUSER/2042/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2042,n,Macro(exten-vm,novm,2042,0,0,0)
exten => 2042,n(dest),Set(__PICKUPMARK=)
exten => 2042,n,Goto(${IVR_CONTEXT},return,1)
exten => 2042,hint,SIP/2042,CustomPresence:2042

exten => 2043,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2043/ringtimer)} > 0]?${DB(AMPUSER/2043/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2043,n,Macro(exten-vm,novm,2043,0,0,0)
exten => 2043,n(dest),Set(__PICKUPMARK=)
exten => 2043,n,Goto(${IVR_CONTEXT},return,1)
exten => 2043,hint,SIP/2043,CustomPresence:2043

exten => 2044,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2044/ringtimer)} > 0]?${DB(AMPUSER/2044/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2044,n,Macro(exten-vm,novm,2044,0,0,0)
exten => 2044,n(dest),Set(__PICKUPMARK=)
exten => 2044,n,Goto(${IVR_CONTEXT},return,1)
exten => 2044,hint,SIP/2044,CustomPresence:2044

exten => 2045,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2045/ringtimer)} > 0]?${DB(AMPUSER/2045/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2045,n,Macro(exten-vm,novm,2045,0,0,0)
exten => 2045,n(dest),Set(__PICKUPMARK=)
exten => 2045,n,Goto(${IVR_CONTEXT},return,1)
exten => 2045,hint,SIP/2045,CustomPresence:2045

exten => 2046,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2046/ringtimer)} > 0]?${DB(AMPUSER/2046/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2046,n,Macro(exten-vm,novm,2046,0,0,0)
exten => 2046,n(dest),Set(__PICKUPMARK=)
exten => 2046,n,Goto(${IVR_CONTEXT},return,1)
exten => 2046,hint,SIP/2046,CustomPresence:2046

exten => 2047,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2047/ringtimer)} > 0]?${DB(AMPUSER/2047/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2047,n,Macro(exten-vm,novm,2047,0,0,0)
exten => 2047,n(dest),Set(__PICKUPMARK=)
exten => 2047,n,Goto(${IVR_CONTEXT},return,1)
exten => 2047,hint,SIP/2047,CustomPresence:2047

exten => 2048,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2048/ringtimer)} > 0]?${DB(AMPUSER/2048/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2048,n,Macro(exten-vm,novm,2048,0,0,0)
exten => 2048,n(dest),Set(__PICKUPMARK=)
exten => 2048,n,Goto(${IVR_CONTEXT},return,1)
exten => 2048,hint,SIP/2048,CustomPresence:2048

exten => 2049,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2049/ringtimer)} > 0]?${DB(AMPUSER/2049/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2049,n,Macro(exten-vm,novm,2049,0,0,0)
exten => 2049,n(dest),Set(__PICKUPMARK=)
exten => 2049,n,Goto(${IVR_CONTEXT},return,1)
exten => 2049,hint,SIP/2049,CustomPresence:2049

exten => 2050,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2050/ringtimer)} > 0]?${DB(AMPUSER/2050/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2050,n,Macro(exten-vm,novm,2050,0,0,0)
exten => 2050,n(dest),Set(__PICKUPMARK=)
exten => 2050,n,Goto(${IVR_CONTEXT},return,1)
exten => 2050,hint,SIP/2050,CustomPresence:2050

exten => 2051,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2051/ringtimer)} > 0]?${DB(AMPUSER/2051/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2051,n,Macro(exten-vm,novm,2051,0,0,0)
exten => 2051,n(dest),Set(__PICKUPMARK=)
exten => 2051,n,Goto(${IVR_CONTEXT},return,1)
exten => 2051,hint,SIP/2051,CustomPresence:2051

exten => 2052,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2052/ringtimer)} > 0]?${DB(AMPUSER/2052/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2052,n,Macro(exten-vm,novm,2052,0,0,0)
exten => 2052,n(dest),Set(__PICKUPMARK=)
exten => 2052,n,Goto(${IVR_CONTEXT},return,1)
exten => 2052,hint,SIP/2052,CustomPresence:2052

exten => 2053,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2053/ringtimer)} > 0]?${DB(AMPUSER/2053/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2053,n,Macro(exten-vm,novm,2053,0,0,0)
exten => 2053,n(dest),Set(__PICKUPMARK=)
exten => 2053,n,Goto(${IVR_CONTEXT},return,1)
exten => 2053,hint,SIP/2053,CustomPresence:2053

exten => 2054,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2054/ringtimer)} > 0]?${DB(AMPUSER/2054/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2054,n,Macro(exten-vm,novm,2054,0,0,0)
exten => 2054,n(dest),Set(__PICKUPMARK=)
exten => 2054,n,Goto(${IVR_CONTEXT},return,1)
exten => 2054,hint,SIP/2054,CustomPresence:2054

exten => 2055,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2055/ringtimer)} > 0]?${DB(AMPUSER/2055/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2055,n,Macro(exten-vm,novm,2055,0,0,0)
exten => 2055,n(dest),Set(__PICKUPMARK=)
exten => 2055,n,Goto(${IVR_CONTEXT},return,1)
exten => 2055,hint,SIP/2055,CustomPresence:2055

exten => 2056,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2056/ringtimer)} > 0]?${DB(AMPUSER/2056/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2056,n,Macro(exten-vm,novm,2056,0,0,0)
exten => 2056,n(dest),Set(__PICKUPMARK=)
exten => 2056,n,Goto(${IVR_CONTEXT},return,1)
exten => 2056,hint,SIP/2056,CustomPresence:2056

exten => 2057,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2057/ringtimer)} > 0]?${DB(AMPUSER/2057/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2057,n,Macro(exten-vm,novm,2057,0,0,0)
exten => 2057,n(dest),Set(__PICKUPMARK=)
exten => 2057,n,Goto(${IVR_CONTEXT},return,1)
exten => 2057,hint,SIP/2057,CustomPresence:2057

exten => 2058,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2058/ringtimer)} > 0]?${DB(AMPUSER/2058/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2058,n,Macro(exten-vm,novm,2058,0,0,0)
exten => 2058,n(dest),Set(__PICKUPMARK=)
exten => 2058,n,Goto(${IVR_CONTEXT},return,1)
exten => 2058,hint,SIP/2058,CustomPresence:2058

exten => 2059,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2059/ringtimer)} > 0]?${DB(AMPUSER/2059/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2059,n,Macro(exten-vm,novm,2059,0,0,0)
exten => 2059,n(dest),Set(__PICKUPMARK=)
exten => 2059,n,Goto(${IVR_CONTEXT},return,1)
exten => 2059,hint,SIP/2059,CustomPresence:2059

exten => 2060,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2060/ringtimer)} > 0]?${DB(AMPUSER/2060/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2060,n,Macro(exten-vm,novm,2060,0,0,0)
exten => 2060,n(dest),Set(__PICKUPMARK=)
exten => 2060,n,Goto(${IVR_CONTEXT},return,1)
exten => 2060,hint,SIP/2060,CustomPresence:2060

exten => 2061,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2061/ringtimer)} > 0]?${DB(AMPUSER/2061/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2061,n,Macro(exten-vm,novm,2061,0,0,0)
exten => 2061,n(dest),Set(__PICKUPMARK=)
exten => 2061,n,Goto(${IVR_CONTEXT},return,1)
exten => 2061,hint,SIP/2061,CustomPresence:2061

exten => 2062,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2062/ringtimer)} > 0]?${DB(AMPUSER/2062/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2062,n,Macro(exten-vm,novm,2062,0,0,0)
exten => 2062,n(dest),Set(__PICKUPMARK=)
exten => 2062,n,Goto(${IVR_CONTEXT},return,1)
exten => 2062,hint,SIP/2062,CustomPresence:2062

exten => 2063,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2063/ringtimer)} > 0]?${DB(AMPUSER/2063/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2063,n,Macro(exten-vm,novm,2063,0,0,0)
exten => 2063,n(dest),Set(__PICKUPMARK=)
exten => 2063,n,Goto(${IVR_CONTEXT},return,1)
exten => 2063,hint,SIP/2063,CustomPresence:2063

exten => 2064,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2064/ringtimer)} > 0]?${DB(AMPUSER/2064/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2064,n,Macro(exten-vm,novm,2064,0,0,0)
exten => 2064,n(dest),Set(__PICKUPMARK=)
exten => 2064,n,Goto(${IVR_CONTEXT},return,1)
exten => 2064,hint,SIP/2064,CustomPresence:2064

exten => 2065,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2065/ringtimer)} > 0]?${DB(AMPUSER/2065/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2065,n,Macro(exten-vm,novm,2065,0,0,0)
exten => 2065,n(dest),Set(__PICKUPMARK=)
exten => 2065,n,Goto(${IVR_CONTEXT},return,1)
exten => 2065,hint,SIP/2065,CustomPresence:2065

exten => 2066,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2066/ringtimer)} > 0]?${DB(AMPUSER/2066/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2066,n,Macro(exten-vm,novm,2066,0,0,0)
exten => 2066,n(dest),Set(__PICKUPMARK=)
exten => 2066,n,Goto(${IVR_CONTEXT},return,1)
exten => 2066,hint,SIP/2066,CustomPresence:2066

exten => 2067,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2067/ringtimer)} > 0]?${DB(AMPUSER/2067/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2067,n,Macro(exten-vm,novm,2067,0,0,0)
exten => 2067,n(dest),Set(__PICKUPMARK=)
exten => 2067,n,Goto(${IVR_CONTEXT},return,1)
exten => 2067,hint,SIP/2067,CustomPresence:2067

exten => 2068,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2068/ringtimer)} > 0]?${DB(AMPUSER/2068/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2068,n,Macro(exten-vm,novm,2068,0,0,0)
exten => 2068,n(dest),Set(__PICKUPMARK=)
exten => 2068,n,Goto(${IVR_CONTEXT},return,1)
exten => 2068,hint,SIP/2068,CustomPresence:2068

exten => 2069,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2069/ringtimer)} > 0]?${DB(AMPUSER/2069/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2069,n,Macro(exten-vm,novm,2069,0,0,0)
exten => 2069,n(dest),Set(__PICKUPMARK=)
exten => 2069,n,Goto(${IVR_CONTEXT},return,1)
exten => 2069,hint,SIP/2069,CustomPresence:2069

exten => 2070,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2070/ringtimer)} > 0]?${DB(AMPUSER/2070/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2070,n,Macro(exten-vm,novm,2070,0,0,0)
exten => 2070,n(dest),Set(__PICKUPMARK=)
exten => 2070,n,Goto(${IVR_CONTEXT},return,1)
exten => 2070,hint,SIP/2070,CustomPresence:2070

exten => 2071,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2071/ringtimer)} > 0]?${DB(AMPUSER/2071/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2071,n,Macro(exten-vm,novm,2071,0,0,0)
exten => 2071,n(dest),Set(__PICKUPMARK=)
exten => 2071,n,Goto(${IVR_CONTEXT},return,1)
exten => 2071,hint,SIP/2071,CustomPresence:2071

exten => 2072,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2072/ringtimer)} > 0]?${DB(AMPUSER/2072/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2072,n,Macro(exten-vm,novm,2072,0,0,0)
exten => 2072,n(dest),Set(__PICKUPMARK=)
exten => 2072,n,Goto(${IVR_CONTEXT},return,1)
exten => 2072,hint,SIP/2072,CustomPresence:2072

exten => 2073,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2073/ringtimer)} > 0]?${DB(AMPUSER/2073/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2073,n,Macro(exten-vm,novm,2073,0,0,0)
exten => 2073,n(dest),Set(__PICKUPMARK=)
exten => 2073,n,Goto(${IVR_CONTEXT},return,1)
exten => 2073,hint,SIP/2073,CustomPresence:2073

exten => 2074,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2074/ringtimer)} > 0]?${DB(AMPUSER/2074/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2074,n,Macro(exten-vm,novm,2074,0,0,0)
exten => 2074,n(dest),Set(__PICKUPMARK=)
exten => 2074,n,Goto(${IVR_CONTEXT},return,1)
exten => 2074,hint,SIP/2074,CustomPresence:2074

exten => 2075,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2075/ringtimer)} > 0]?${DB(AMPUSER/2075/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2075,n,Macro(exten-vm,novm,2075,0,0,0)
exten => 2075,n(dest),Set(__PICKUPMARK=)
exten => 2075,n,Goto(${IVR_CONTEXT},return,1)
exten => 2075,hint,SIP/2075,CustomPresence:2075

exten => 2076,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2076/ringtimer)} > 0]?${DB(AMPUSER/2076/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2076,n,Macro(exten-vm,novm,2076,0,0,0)
exten => 2076,n(dest),Set(__PICKUPMARK=)
exten => 2076,n,Goto(${IVR_CONTEXT},return,1)
exten => 2076,hint,SIP/2076,CustomPresence:2076

exten => 2077,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2077/ringtimer)} > 0]?${DB(AMPUSER/2077/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2077,n,Macro(exten-vm,novm,2077,0,0,0)
exten => 2077,n(dest),Set(__PICKUPMARK=)
exten => 2077,n,Goto(${IVR_CONTEXT},return,1)
exten => 2077,hint,SIP/2077,CustomPresence:2077

exten => 2078,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2078/ringtimer)} > 0]?${DB(AMPUSER/2078/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2078,n,Macro(exten-vm,novm,2078,0,0,0)
exten => 2078,n(dest),Set(__PICKUPMARK=)
exten => 2078,n,Goto(${IVR_CONTEXT},return,1)
exten => 2078,hint,SIP/2078,CustomPresence:2078

exten => 2079,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2079/ringtimer)} > 0]?${DB(AMPUSER/2079/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2079,n,Macro(exten-vm,novm,2079,0,0,0)
exten => 2079,n(dest),Set(__PICKUPMARK=)
exten => 2079,n,Goto(${IVR_CONTEXT},return,1)
exten => 2079,hint,SIP/2079,CustomPresence:2079

exten => 2080,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2080/ringtimer)} > 0]?${DB(AMPUSER/2080/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2080,n,Macro(exten-vm,novm,2080,0,0,0)
exten => 2080,n(dest),Set(__PICKUPMARK=)
exten => 2080,n,Goto(${IVR_CONTEXT},return,1)
exten => 2080,hint,SIP/2080,CustomPresence:2080

exten => 2081,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2081/ringtimer)} > 0]?${DB(AMPUSER/2081/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2081,n,Macro(exten-vm,novm,2081,0,0,0)
exten => 2081,n(dest),Set(__PICKUPMARK=)
exten => 2081,n,Goto(${IVR_CONTEXT},return,1)
exten => 2081,hint,SIP/2081,CustomPresence:2081

exten => 2082,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2082/ringtimer)} > 0]?${DB(AMPUSER/2082/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2082,n,Macro(exten-vm,novm,2082,0,0,0)
exten => 2082,n(dest),Set(__PICKUPMARK=)
exten => 2082,n,Goto(${IVR_CONTEXT},return,1)
exten => 2082,hint,SIP/2082,CustomPresence:2082

exten => 2083,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2083/ringtimer)} > 0]?${DB(AMPUSER/2083/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2083,n,Macro(exten-vm,novm,2083,0,0,0)
exten => 2083,n(dest),Set(__PICKUPMARK=)
exten => 2083,n,Goto(${IVR_CONTEXT},return,1)
exten => 2083,hint,SIP/2083,CustomPresence:2083

exten => 2084,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2084/ringtimer)} > 0]?${DB(AMPUSER/2084/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2084,n,Macro(exten-vm,novm,2084,0,0,0)
exten => 2084,n(dest),Set(__PICKUPMARK=)
exten => 2084,n,Goto(${IVR_CONTEXT},return,1)
exten => 2084,hint,SIP/2084,CustomPresence:2084

exten => 2085,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2085/ringtimer)} > 0]?${DB(AMPUSER/2085/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2085,n,Macro(exten-vm,novm,2085,0,0,0)
exten => 2085,n(dest),Set(__PICKUPMARK=)
exten => 2085,n,Goto(${IVR_CONTEXT},return,1)
exten => 2085,hint,SIP/2085,CustomPresence:2085

exten => 2086,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2086/ringtimer)} > 0]?${DB(AMPUSER/2086/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2086,n,Macro(exten-vm,novm,2086,0,0,0)
exten => 2086,n(dest),Set(__PICKUPMARK=)
exten => 2086,n,Goto(${IVR_CONTEXT},return,1)
exten => 2086,hint,SIP/2086,CustomPresence:2086

exten => 2087,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2087/ringtimer)} > 0]?${DB(AMPUSER/2087/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2087,n,Macro(exten-vm,novm,2087,0,0,0)
exten => 2087,n(dest),Set(__PICKUPMARK=)
exten => 2087,n,Goto(${IVR_CONTEXT},return,1)
exten => 2087,hint,SIP/2087,CustomPresence:2087

exten => 2088,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2088/ringtimer)} > 0]?${DB(AMPUSER/2088/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2088,n,Macro(exten-vm,novm,2088,0,0,0)
exten => 2088,n(dest),Set(__PICKUPMARK=)
exten => 2088,n,Goto(${IVR_CONTEXT},return,1)
exten => 2088,hint,SIP/2088,CustomPresence:2088

exten => 2089,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2089/ringtimer)} > 0]?${DB(AMPUSER/2089/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2089,n,Macro(exten-vm,novm,2089,0,0,0)
exten => 2089,n(dest),Set(__PICKUPMARK=)
exten => 2089,n,Goto(${IVR_CONTEXT},return,1)
exten => 2089,hint,SIP/2089,CustomPresence:2089

exten => 2090,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2090/ringtimer)} > 0]?${DB(AMPUSER/2090/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2090,n,Macro(exten-vm,novm,2090,0,0,0)
exten => 2090,n(dest),Set(__PICKUPMARK=)
exten => 2090,n,Goto(${IVR_CONTEXT},return,1)
exten => 2090,hint,SIP/2090,CustomPresence:2090

exten => 2091,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2091/ringtimer)} > 0]?${DB(AMPUSER/2091/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2091,n,Macro(exten-vm,novm,2091,0,0,0)
exten => 2091,n(dest),Set(__PICKUPMARK=)
exten => 2091,n,Goto(${IVR_CONTEXT},return,1)
exten => 2091,hint,SIP/2091,CustomPresence:2091

exten => 2092,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2092/ringtimer)} > 0]?${DB(AMPUSER/2092/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2092,n,Macro(exten-vm,novm,2092,0,0,0)
exten => 2092,n(dest),Set(__PICKUPMARK=)
exten => 2092,n,Goto(${IVR_CONTEXT},return,1)
exten => 2092,hint,SIP/2092,CustomPresence:2092

exten => 2093,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2093/ringtimer)} > 0]?${DB(AMPUSER/2093/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2093,n,Macro(exten-vm,novm,2093,0,0,0)
exten => 2093,n(dest),Set(__PICKUPMARK=)
exten => 2093,n,Goto(${IVR_CONTEXT},return,1)
exten => 2093,hint,SIP/2093,CustomPresence:2093

exten => 2094,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2094/ringtimer)} > 0]?${DB(AMPUSER/2094/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2094,n,Macro(exten-vm,novm,2094,0,0,0)
exten => 2094,n(dest),Set(__PICKUPMARK=)
exten => 2094,n,Goto(${IVR_CONTEXT},return,1)
exten => 2094,hint,SIP/2094,CustomPresence:2094

exten => 2095,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2095/ringtimer)} > 0]?${DB(AMPUSER/2095/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2095,n,Macro(exten-vm,novm,2095,0,0,0)
exten => 2095,n(dest),Set(__PICKUPMARK=)
exten => 2095,n,Goto(${IVR_CONTEXT},return,1)
exten => 2095,hint,SIP/2095,CustomPresence:2095

exten => 2096,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2096/ringtimer)} > 0]?${DB(AMPUSER/2096/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2096,n,Macro(exten-vm,novm,2096,0,0,0)
exten => 2096,n(dest),Set(__PICKUPMARK=)
exten => 2096,n,Goto(${IVR_CONTEXT},return,1)
exten => 2096,hint,SIP/2096,CustomPresence:2096

exten => 2097,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2097/ringtimer)} > 0]?${DB(AMPUSER/2097/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2097,n,Macro(exten-vm,novm,2097,0,0,0)
exten => 2097,n(dest),Set(__PICKUPMARK=)
exten => 2097,n,Goto(${IVR_CONTEXT},return,1)
exten => 2097,hint,SIP/2097,CustomPresence:2097

exten => 2098,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2098/ringtimer)} > 0]?${DB(AMPUSER/2098/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2098,n,Macro(exten-vm,novm,2098,0,0,0)
exten => 2098,n(dest),Set(__PICKUPMARK=)
exten => 2098,n,Goto(${IVR_CONTEXT},return,1)
exten => 2098,hint,SIP/2098,CustomPresence:2098

exten => 2099,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2099/ringtimer)} > 0]?${DB(AMPUSER/2099/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2099,n,Macro(exten-vm,novm,2099,0,0,0)
exten => 2099,n(dest),Set(__PICKUPMARK=)
exten => 2099,n,Goto(${IVR_CONTEXT},return,1)
exten => 2099,hint,SIP/2099,CustomPresence:2099

exten => 2100,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2100/ringtimer)} > 0]?${DB(AMPUSER/2100/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2100,n,Macro(exten-vm,novm,2100,0,0,0)
exten => 2100,n(dest),Set(__PICKUPMARK=)
exten => 2100,n,Goto(${IVR_CONTEXT},return,1)
exten => 2100,hint,SIP/2100,CustomPresence:2100

exten => 2101,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2101/ringtimer)} > 0]?${DB(AMPUSER/2101/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2101,n,Macro(exten-vm,novm,2101,0,0,0)
exten => 2101,n(dest),Set(__PICKUPMARK=)
exten => 2101,n,Goto(${IVR_CONTEXT},return,1)
exten => 2101,hint,SIP/2101,CustomPresence:2101

exten => 2102,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2102/ringtimer)} > 0]?${DB(AMPUSER/2102/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2102,n,Macro(exten-vm,novm,2102,0,0,0)
exten => 2102,n(dest),Set(__PICKUPMARK=)
exten => 2102,n,Goto(${IVR_CONTEXT},return,1)
exten => 2102,hint,SIP/2102,CustomPresence:2102

exten => 2103,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2103/ringtimer)} > 0]?${DB(AMPUSER/2103/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2103,n,Macro(exten-vm,novm,2103,0,0,0)
exten => 2103,n(dest),Set(__PICKUPMARK=)
exten => 2103,n,Goto(${IVR_CONTEXT},return,1)
exten => 2103,hint,SIP/2103,CustomPresence:2103

exten => 2104,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2104/ringtimer)} > 0]?${DB(AMPUSER/2104/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2104,n,Macro(exten-vm,novm,2104,0,0,0)
exten => 2104,n(dest),Set(__PICKUPMARK=)
exten => 2104,n,Goto(${IVR_CONTEXT},return,1)
exten => 2104,hint,SIP/2104,CustomPresence:2104

exten => 2105,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2105/ringtimer)} > 0]?${DB(AMPUSER/2105/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2105,n,Macro(exten-vm,novm,2105,0,0,0)
exten => 2105,n(dest),Set(__PICKUPMARK=)
exten => 2105,n,Goto(${IVR_CONTEXT},return,1)
exten => 2105,hint,SIP/2105,CustomPresence:2105

exten => 2106,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2106/ringtimer)} > 0]?${DB(AMPUSER/2106/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2106,n,Macro(exten-vm,novm,2106,0,0,0)
exten => 2106,n(dest),Set(__PICKUPMARK=)
exten => 2106,n,Goto(${IVR_CONTEXT},return,1)
exten => 2106,hint,SIP/2106,CustomPresence:2106

exten => 2107,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2107/ringtimer)} > 0]?${DB(AMPUSER/2107/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2107,n,Macro(exten-vm,novm,2107,0,0,0)
exten => 2107,n(dest),Set(__PICKUPMARK=)
exten => 2107,n,Goto(${IVR_CONTEXT},return,1)
exten => 2107,hint,SIP/2107,CustomPresence:2107

exten => 2108,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2108/ringtimer)} > 0]?${DB(AMPUSER/2108/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2108,n,Macro(exten-vm,novm,2108,0,0,0)
exten => 2108,n(dest),Set(__PICKUPMARK=)
exten => 2108,n,Goto(${IVR_CONTEXT},return,1)
exten => 2108,hint,SIP/2108,CustomPresence:2108

exten => 2109,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2109/ringtimer)} > 0]?${DB(AMPUSER/2109/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2109,n,Macro(exten-vm,novm,2109,0,0,0)
exten => 2109,n(dest),Set(__PICKUPMARK=)
exten => 2109,n,Goto(${IVR_CONTEXT},return,1)
exten => 2109,hint,SIP/2109,CustomPresence:2109

exten => 2110,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2110/ringtimer)} > 0]?${DB(AMPUSER/2110/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2110,n,Macro(exten-vm,novm,2110,0,0,0)
exten => 2110,n(dest),Set(__PICKUPMARK=)
exten => 2110,n,Goto(${IVR_CONTEXT},return,1)
exten => 2110,hint,SIP/2110,CustomPresence:2110

exten => 2111,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2111/ringtimer)} > 0]?${DB(AMPUSER/2111/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2111,n,Macro(exten-vm,novm,2111,0,0,0)
exten => 2111,n(dest),Set(__PICKUPMARK=)
exten => 2111,n,Goto(${IVR_CONTEXT},return,1)
exten => 2111,hint,SIP/2111,CustomPresence:2111

exten => 2112,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2112/ringtimer)} > 0]?${DB(AMPUSER/2112/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2112,n,Macro(exten-vm,novm,2112,0,0,0)
exten => 2112,n(dest),Set(__PICKUPMARK=)
exten => 2112,n,Goto(${IVR_CONTEXT},return,1)
exten => 2112,hint,SIP/2112,CustomPresence:2112

exten => 2113,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2113/ringtimer)} > 0]?${DB(AMPUSER/2113/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2113,n,Macro(exten-vm,novm,2113,0,0,0)
exten => 2113,n(dest),Set(__PICKUPMARK=)
exten => 2113,n,Goto(${IVR_CONTEXT},return,1)
exten => 2113,hint,SIP/2113,CustomPresence:2113

exten => 2114,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2114/ringtimer)} > 0]?${DB(AMPUSER/2114/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2114,n,Macro(exten-vm,novm,2114,0,0,0)
exten => 2114,n(dest),Set(__PICKUPMARK=)
exten => 2114,n,Goto(${IVR_CONTEXT},return,1)
exten => 2114,hint,SIP/2114,CustomPresence:2114

exten => 2115,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2115/ringtimer)} > 0]?${DB(AMPUSER/2115/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2115,n,Macro(exten-vm,novm,2115,0,0,0)
exten => 2115,n(dest),Set(__PICKUPMARK=)
exten => 2115,n,Goto(${IVR_CONTEXT},return,1)
exten => 2115,hint,SIP/2115,CustomPresence:2115

exten => 2116,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2116/ringtimer)} > 0]?${DB(AMPUSER/2116/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2116,n,Macro(exten-vm,novm,2116,0,0,0)
exten => 2116,n(dest),Set(__PICKUPMARK=)
exten => 2116,n,Goto(${IVR_CONTEXT},return,1)
exten => 2116,hint,SIP/2116,CustomPresence:2116

exten => 2117,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2117/ringtimer)} > 0]?${DB(AMPUSER/2117/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2117,n,Macro(exten-vm,novm,2117,0,0,0)
exten => 2117,n(dest),Set(__PICKUPMARK=)
exten => 2117,n,Goto(${IVR_CONTEXT},return,1)
exten => 2117,hint,SIP/2117,CustomPresence:2117

exten => 2118,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2118/ringtimer)} > 0]?${DB(AMPUSER/2118/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2118,n,Macro(exten-vm,novm,2118,0,0,0)
exten => 2118,n(dest),Set(__PICKUPMARK=)
exten => 2118,n,Goto(${IVR_CONTEXT},return,1)
exten => 2118,hint,SIP/2118,CustomPresence:2118

exten => 2119,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2119/ringtimer)} > 0]?${DB(AMPUSER/2119/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2119,n,Macro(exten-vm,novm,2119,0,0,0)
exten => 2119,n(dest),Set(__PICKUPMARK=)
exten => 2119,n,Goto(${IVR_CONTEXT},return,1)
exten => 2119,hint,SIP/2119,CustomPresence:2119

exten => 2120,1,Set(__RINGTIMER=${IF($[${DB(AMPUSER/2120/ringtimer)} > 0]?${DB(AMPUSER/2120/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 2120,n,Macro(exten-vm,novm,2120,0,0,0)
exten => 2120,n(dest),Set(__PICKUPMARK=)
exten => 2120,n,Goto(${IVR_CONTEXT},return,1)
exten => 2120,hint,SIP/2120,CustomPresence:2120

exten => vmret,1,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => vmret,n,Hangup
exten => vmret,n(playret),Playback(exited-vm-will-be-transfered&silence/1)
exten => vmret,n,Goto(${IVR_CONTEXT},return,1)

exten => h,1,Macro(hangupcall,)

;--== end of [ext-local] ==--;


[from-did-direct-ivr]
include => from-did-direct-ivr-custom
exten => 0323,1,Macro(blkvm-clr,)
exten => 0323,n,Set(__NODEST=)
exten => 0323,n,Goto(from-did-direct,0323,1)

exten => 2001,1,Macro(blkvm-clr,)
exten => 2001,n,Set(__NODEST=)
exten => 2001,n,Goto(from-did-direct,2001,1)

exten => 2002,1,Macro(blkvm-clr,)
exten => 2002,n,Set(__NODEST=)
exten => 2002,n,Goto(from-did-direct,2002,1)

exten => 2003,1,Macro(blkvm-clr,)
exten => 2003,n,Set(__NODEST=)
exten => 2003,n,Goto(from-did-direct,2003,1)

exten => 2004,1,Macro(blkvm-clr,)
exten => 2004,n,Set(__NODEST=)
exten => 2004,n,Goto(from-did-direct,2004,1)

exten => 2005,1,Macro(blkvm-clr,)
exten => 2005,n,Set(__NODEST=)
exten => 2005,n,Goto(from-did-direct,2005,1)

exten => 2006,1,Macro(blkvm-clr,)
exten => 2006,n,Set(__NODEST=)
exten => 2006,n,Goto(from-did-direct,2006,1)

exten => 2021,1,Macro(blkvm-clr,)
exten => 2021,n,Set(__NODEST=)
exten => 2021,n,Goto(from-did-direct,2021,1)

exten => 2022,1,Macro(blkvm-clr,)
exten => 2022,n,Set(__NODEST=)
exten => 2022,n,Goto(from-did-direct,2022,1)

exten => 2023,1,Macro(blkvm-clr,)
exten => 2023,n,Set(__NODEST=)
exten => 2023,n,Goto(from-did-direct,2023,1)

exten => 2024,1,Macro(blkvm-clr,)
exten => 2024,n,Set(__NODEST=)
exten => 2024,n,Goto(from-did-direct,2024,1)

exten => 2025,1,Macro(blkvm-clr,)
exten => 2025,n,Set(__NODEST=)
exten => 2025,n,Goto(from-did-direct,2025,1)

exten => 2026,1,Macro(blkvm-clr,)
exten => 2026,n,Set(__NODEST=)
exten => 2026,n,Goto(from-did-direct,2026,1)

exten => 2027,1,Macro(blkvm-clr,)
exten => 2027,n,Set(__NODEST=)
exten => 2027,n,Goto(from-did-direct,2027,1)

exten => 2028,1,Macro(blkvm-clr,)
exten => 2028,n,Set(__NODEST=)
exten => 2028,n,Goto(from-did-direct,2028,1)

exten => 2029,1,Macro(blkvm-clr,)
exten => 2029,n,Set(__NODEST=)
exten => 2029,n,Goto(from-did-direct,2029,1)

exten => 2030,1,Macro(blkvm-clr,)
exten => 2030,n,Set(__NODEST=)
exten => 2030,n,Goto(from-did-direct,2030,1)

exten => 2031,1,Macro(blkvm-clr,)
exten => 2031,n,Set(__NODEST=)
exten => 2031,n,Goto(from-did-direct,2031,1)

exten => 2032,1,Macro(blkvm-clr,)
exten => 2032,n,Set(__NODEST=)
exten => 2032,n,Goto(from-did-direct,2032,1)

exten => 2033,1,Macro(blkvm-clr,)
exten => 2033,n,Set(__NODEST=)
exten => 2033,n,Goto(from-did-direct,2033,1)

exten => 2034,1,Macro(blkvm-clr,)
exten => 2034,n,Set(__NODEST=)
exten => 2034,n,Goto(from-did-direct,2034,1)

exten => 2035,1,Macro(blkvm-clr,)
exten => 2035,n,Set(__NODEST=)
exten => 2035,n,Goto(from-did-direct,2035,1)

exten => 2036,1,Macro(blkvm-clr,)
exten => 2036,n,Set(__NODEST=)
exten => 2036,n,Goto(from-did-direct,2036,1)

exten => 2037,1,Macro(blkvm-clr,)
exten => 2037,n,Set(__NODEST=)
exten => 2037,n,Goto(from-did-direct,2037,1)

exten => 2038,1,Macro(blkvm-clr,)
exten => 2038,n,Set(__NODEST=)
exten => 2038,n,Goto(from-did-direct,2038,1)

exten => 2039,1,Macro(blkvm-clr,)
exten => 2039,n,Set(__NODEST=)
exten => 2039,n,Goto(from-did-direct,2039,1)

exten => 2040,1,Macro(blkvm-clr,)
exten => 2040,n,Set(__NODEST=)
exten => 2040,n,Goto(from-did-direct,2040,1)

exten => 2041,1,Macro(blkvm-clr,)
exten => 2041,n,Set(__NODEST=)
exten => 2041,n,Goto(from-did-direct,2041,1)

exten => 2042,1,Macro(blkvm-clr,)
exten => 2042,n,Set(__NODEST=)
exten => 2042,n,Goto(from-did-direct,2042,1)

exten => 2043,1,Macro(blkvm-clr,)
exten => 2043,n,Set(__NODEST=)
exten => 2043,n,Goto(from-did-direct,2043,1)

exten => 2044,1,Macro(blkvm-clr,)
exten => 2044,n,Set(__NODEST=)
exten => 2044,n,Goto(from-did-direct,2044,1)

exten => 2045,1,Macro(blkvm-clr,)
exten => 2045,n,Set(__NODEST=)
exten => 2045,n,Goto(from-did-direct,2045,1)

exten => 2046,1,Macro(blkvm-clr,)
exten => 2046,n,Set(__NODEST=)
exten => 2046,n,Goto(from-did-direct,2046,1)

exten => 2047,1,Macro(blkvm-clr,)
exten => 2047,n,Set(__NODEST=)
exten => 2047,n,Goto(from-did-direct,2047,1)

exten => 2048,1,Macro(blkvm-clr,)
exten => 2048,n,Set(__NODEST=)
exten => 2048,n,Goto(from-did-direct,2048,1)

exten => 2049,1,Macro(blkvm-clr,)
exten => 2049,n,Set(__NODEST=)
exten => 2049,n,Goto(from-did-direct,2049,1)

exten => 2050,1,Macro(blkvm-clr,)
exten => 2050,n,Set(__NODEST=)
exten => 2050,n,Goto(from-did-direct,2050,1)

exten => 2051,1,Macro(blkvm-clr,)
exten => 2051,n,Set(__NODEST=)
exten => 2051,n,Goto(from-did-direct,2051,1)

exten => 2052,1,Macro(blkvm-clr,)
exten => 2052,n,Set(__NODEST=)
exten => 2052,n,Goto(from-did-direct,2052,1)

exten => 2053,1,Macro(blkvm-clr,)
exten => 2053,n,Set(__NODEST=)
exten => 2053,n,Goto(from-did-direct,2053,1)

exten => 2054,1,Macro(blkvm-clr,)
exten => 2054,n,Set(__NODEST=)
exten => 2054,n,Goto(from-did-direct,2054,1)

exten => 2055,1,Macro(blkvm-clr,)
exten => 2055,n,Set(__NODEST=)
exten => 2055,n,Goto(from-did-direct,2055,1)

exten => 2056,1,Macro(blkvm-clr,)
exten => 2056,n,Set(__NODEST=)
exten => 2056,n,Goto(from-did-direct,2056,1)

exten => 2057,1,Macro(blkvm-clr,)
exten => 2057,n,Set(__NODEST=)
exten => 2057,n,Goto(from-did-direct,2057,1)

exten => 2058,1,Macro(blkvm-clr,)
exten => 2058,n,Set(__NODEST=)
exten => 2058,n,Goto(from-did-direct,2058,1)

exten => 2059,1,Macro(blkvm-clr,)
exten => 2059,n,Set(__NODEST=)
exten => 2059,n,Goto(from-did-direct,2059,1)

exten => 2060,1,Macro(blkvm-clr,)
exten => 2060,n,Set(__NODEST=)
exten => 2060,n,Goto(from-did-direct,2060,1)

exten => 2061,1,Macro(blkvm-clr,)
exten => 2061,n,Set(__NODEST=)
exten => 2061,n,Goto(from-did-direct,2061,1)

exten => 2062,1,Macro(blkvm-clr,)
exten => 2062,n,Set(__NODEST=)
exten => 2062,n,Goto(from-did-direct,2062,1)

exten => 2063,1,Macro(blkvm-clr,)
exten => 2063,n,Set(__NODEST=)
exten => 2063,n,Goto(from-did-direct,2063,1)

exten => 2064,1,Macro(blkvm-clr,)
exten => 2064,n,Set(__NODEST=)
exten => 2064,n,Goto(from-did-direct,2064,1)

exten => 2065,1,Macro(blkvm-clr,)
exten => 2065,n,Set(__NODEST=)
exten => 2065,n,Goto(from-did-direct,2065,1)

exten => 2066,1,Macro(blkvm-clr,)
exten => 2066,n,Set(__NODEST=)
exten => 2066,n,Goto(from-did-direct,2066,1)

exten => 2067,1,Macro(blkvm-clr,)
exten => 2067,n,Set(__NODEST=)
exten => 2067,n,Goto(from-did-direct,2067,1)

exten => 2068,1,Macro(blkvm-clr,)
exten => 2068,n,Set(__NODEST=)
exten => 2068,n,Goto(from-did-direct,2068,1)

exten => 2069,1,Macro(blkvm-clr,)
exten => 2069,n,Set(__NODEST=)
exten => 2069,n,Goto(from-did-direct,2069,1)

exten => 2070,1,Macro(blkvm-clr,)
exten => 2070,n,Set(__NODEST=)
exten => 2070,n,Goto(from-did-direct,2070,1)

exten => 2071,1,Macro(blkvm-clr,)
exten => 2071,n,Set(__NODEST=)
exten => 2071,n,Goto(from-did-direct,2071,1)

exten => 2072,1,Macro(blkvm-clr,)
exten => 2072,n,Set(__NODEST=)
exten => 2072,n,Goto(from-did-direct,2072,1)

exten => 2073,1,Macro(blkvm-clr,)
exten => 2073,n,Set(__NODEST=)
exten => 2073,n,Goto(from-did-direct,2073,1)

exten => 2074,1,Macro(blkvm-clr,)
exten => 2074,n,Set(__NODEST=)
exten => 2074,n,Goto(from-did-direct,2074,1)

exten => 2075,1,Macro(blkvm-clr,)
exten => 2075,n,Set(__NODEST=)
exten => 2075,n,Goto(from-did-direct,2075,1)

exten => 2076,1,Macro(blkvm-clr,)
exten => 2076,n,Set(__NODEST=)
exten => 2076,n,Goto(from-did-direct,2076,1)

exten => 2077,1,Macro(blkvm-clr,)
exten => 2077,n,Set(__NODEST=)
exten => 2077,n,Goto(from-did-direct,2077,1)

exten => 2078,1,Macro(blkvm-clr,)
exten => 2078,n,Set(__NODEST=)
exten => 2078,n,Goto(from-did-direct,2078,1)

exten => 2079,1,Macro(blkvm-clr,)
exten => 2079,n,Set(__NODEST=)
exten => 2079,n,Goto(from-did-direct,2079,1)

exten => 2080,1,Macro(blkvm-clr,)
exten => 2080,n,Set(__NODEST=)
exten => 2080,n,Goto(from-did-direct,2080,1)

exten => 2081,1,Macro(blkvm-clr,)
exten => 2081,n,Set(__NODEST=)
exten => 2081,n,Goto(from-did-direct,2081,1)

exten => 2082,1,Macro(blkvm-clr,)
exten => 2082,n,Set(__NODEST=)
exten => 2082,n,Goto(from-did-direct,2082,1)

exten => 2083,1,Macro(blkvm-clr,)
exten => 2083,n,Set(__NODEST=)
exten => 2083,n,Goto(from-did-direct,2083,1)

exten => 2084,1,Macro(blkvm-clr,)
exten => 2084,n,Set(__NODEST=)
exten => 2084,n,Goto(from-did-direct,2084,1)

exten => 2085,1,Macro(blkvm-clr,)
exten => 2085,n,Set(__NODEST=)
exten => 2085,n,Goto(from-did-direct,2085,1)

exten => 2086,1,Macro(blkvm-clr,)
exten => 2086,n,Set(__NODEST=)
exten => 2086,n,Goto(from-did-direct,2086,1)

exten => 2087,1,Macro(blkvm-clr,)
exten => 2087,n,Set(__NODEST=)
exten => 2087,n,Goto(from-did-direct,2087,1)

exten => 2088,1,Macro(blkvm-clr,)
exten => 2088,n,Set(__NODEST=)
exten => 2088,n,Goto(from-did-direct,2088,1)

exten => 2089,1,Macro(blkvm-clr,)
exten => 2089,n,Set(__NODEST=)
exten => 2089,n,Goto(from-did-direct,2089,1)

exten => 2090,1,Macro(blkvm-clr,)
exten => 2090,n,Set(__NODEST=)
exten => 2090,n,Goto(from-did-direct,2090,1)

exten => 2091,1,Macro(blkvm-clr,)
exten => 2091,n,Set(__NODEST=)
exten => 2091,n,Goto(from-did-direct,2091,1)

exten => 2092,1,Macro(blkvm-clr,)
exten => 2092,n,Set(__NODEST=)
exten => 2092,n,Goto(from-did-direct,2092,1)

exten => 2093,1,Macro(blkvm-clr,)
exten => 2093,n,Set(__NODEST=)
exten => 2093,n,Goto(from-did-direct,2093,1)

exten => 2094,1,Macro(blkvm-clr,)
exten => 2094,n,Set(__NODEST=)
exten => 2094,n,Goto(from-did-direct,2094,1)

exten => 2095,1,Macro(blkvm-clr,)
exten => 2095,n,Set(__NODEST=)
exten => 2095,n,Goto(from-did-direct,2095,1)

exten => 2096,1,Macro(blkvm-clr,)
exten => 2096,n,Set(__NODEST=)
exten => 2096,n,Goto(from-did-direct,2096,1)

exten => 2097,1,Macro(blkvm-clr,)
exten => 2097,n,Set(__NODEST=)
exten => 2097,n,Goto(from-did-direct,2097,1)

exten => 2098,1,Macro(blkvm-clr,)
exten => 2098,n,Set(__NODEST=)
exten => 2098,n,Goto(from-did-direct,2098,1)

exten => 2099,1,Macro(blkvm-clr,)
exten => 2099,n,Set(__NODEST=)
exten => 2099,n,Goto(from-did-direct,2099,1)

exten => 2100,1,Macro(blkvm-clr,)
exten => 2100,n,Set(__NODEST=)
exten => 2100,n,Goto(from-did-direct,2100,1)

exten => 2101,1,Macro(blkvm-clr,)
exten => 2101,n,Set(__NODEST=)
exten => 2101,n,Goto(from-did-direct,2101,1)

exten => 2102,1,Macro(blkvm-clr,)
exten => 2102,n,Set(__NODEST=)
exten => 2102,n,Goto(from-did-direct,2102,1)

exten => 2103,1,Macro(blkvm-clr,)
exten => 2103,n,Set(__NODEST=)
exten => 2103,n,Goto(from-did-direct,2103,1)

exten => 2104,1,Macro(blkvm-clr,)
exten => 2104,n,Set(__NODEST=)
exten => 2104,n,Goto(from-did-direct,2104,1)

exten => 2105,1,Macro(blkvm-clr,)
exten => 2105,n,Set(__NODEST=)
exten => 2105,n,Goto(from-did-direct,2105,1)

exten => 2106,1,Macro(blkvm-clr,)
exten => 2106,n,Set(__NODEST=)
exten => 2106,n,Goto(from-did-direct,2106,1)

exten => 2107,1,Macro(blkvm-clr,)
exten => 2107,n,Set(__NODEST=)
exten => 2107,n,Goto(from-did-direct,2107,1)

exten => 2108,1,Macro(blkvm-clr,)
exten => 2108,n,Set(__NODEST=)
exten => 2108,n,Goto(from-did-direct,2108,1)

exten => 2109,1,Macro(blkvm-clr,)
exten => 2109,n,Set(__NODEST=)
exten => 2109,n,Goto(from-did-direct,2109,1)

exten => 2110,1,Macro(blkvm-clr,)
exten => 2110,n,Set(__NODEST=)
exten => 2110,n,Goto(from-did-direct,2110,1)

exten => 2111,1,Macro(blkvm-clr,)
exten => 2111,n,Set(__NODEST=)
exten => 2111,n,Goto(from-did-direct,2111,1)

exten => 2112,1,Macro(blkvm-clr,)
exten => 2112,n,Set(__NODEST=)
exten => 2112,n,Goto(from-did-direct,2112,1)

exten => 2113,1,Macro(blkvm-clr,)
exten => 2113,n,Set(__NODEST=)
exten => 2113,n,Goto(from-did-direct,2113,1)

exten => 2114,1,Macro(blkvm-clr,)
exten => 2114,n,Set(__NODEST=)
exten => 2114,n,Goto(from-did-direct,2114,1)

exten => 2115,1,Macro(blkvm-clr,)
exten => 2115,n,Set(__NODEST=)
exten => 2115,n,Goto(from-did-direct,2115,1)

exten => 2116,1,Macro(blkvm-clr,)
exten => 2116,n,Set(__NODEST=)
exten => 2116,n,Goto(from-did-direct,2116,1)

exten => 2117,1,Macro(blkvm-clr,)
exten => 2117,n,Set(__NODEST=)
exten => 2117,n,Goto(from-did-direct,2117,1)

exten => 2118,1,Macro(blkvm-clr,)
exten => 2118,n,Set(__NODEST=)
exten => 2118,n,Goto(from-did-direct,2118,1)

exten => 2119,1,Macro(blkvm-clr,)
exten => 2119,n,Set(__NODEST=)
exten => 2119,n,Goto(from-did-direct,2119,1)

exten => 2120,1,Macro(blkvm-clr,)
exten => 2120,n,Set(__NODEST=)
exten => 2120,n,Goto(from-did-direct,2120,1)

;--== end of [from-did-direct-ivr] ==--;


[from-trunk-sip-1006]
include => from-trunk-sip-1006-custom
exten => _.,1,Set(GROUP()=OUT_2)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-1006] ==--;


[ext-trunk]
include => ext-trunk-custom
exten => 2,1,Set(TDIAL_STRING=SIP/1006)
exten => 2,n,Set(DIAL_TRUNK=2)
exten => 2,n,Goto(ext-trunk,tdial,1)

exten => 3,1,Set(TDIAL_STRING=SIP/1002)
exten => 3,n,Set(DIAL_TRUNK=3)
exten => 3,n,Goto(ext-trunk,tdial,1)

exten => 4,1,Set(TDIAL_STRING=SIP/1001)
exten => 4,n,Set(DIAL_TRUNK=4)
exten => 4,n,Goto(ext-trunk,tdial,1)

exten => 5,1,Set(TDIAL_STRING=SIP/1004)
exten => 5,n,Set(DIAL_TRUNK=5)
exten => 5,n,Goto(ext-trunk,tdial,1)

exten => 7,1,Set(TDIAL_STRING=SIP/1008)
exten => 7,n,Set(DIAL_TRUNK=7)
exten => 7,n,Goto(ext-trunk,tdial,1)

exten => tdial,1,Set(OUTBOUND_GROUP=OUT_${DIAL_TRUNK})
exten => tdial,n,GotoIf($["${OUTMAXCHANS_${DIAL_TRUNK}}" = ""]?nomax)
exten => tdial,n,GotoIf($[${GROUP_COUNT(OUT_${DIAL_TRUNK})} >= ${OUTMAXCHANS_${DIAL_TRUNK}}]?hangit)
exten => tdial,n(nomax),ExecIf($["${CALLINGPRES_SV}" != ""]?Set(CALLERPRES()=${CALLINGPRES_SV}))
exten => tdial,n,Set(DIAL_NUMBER=${FROM_DID})
exten => tdial,n,GosubIf($["${PREFIX_TRUNK_${DIAL_TRUNK}}" != ""]?sub-flp-${DIAL_TRUNK},s,1())
exten => tdial,n,Set(OUTNUM=${OUTPREFIX_${DIAL_TRUNK}}${DIAL_NUMBER})
exten => tdial,n,Set(DIAL_TRUNK_OPTIONS=${IF($["${DB_EXISTS(TRUNK/${DIAL_TRUNK}/dialopts)}" = "1"]?${DB_RESULT}:${TRUNK_OPTIONS})})
exten => tdial,n,Dial(${TDIAL_STRING}/${OUTNUM},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS})
exten => tdial,n,Set(CALLERID(number)=${CALLERID(number):0:40})
exten => tdial,n,Set(CALLERID(name)=${CALLERID(name):0:40})
exten => tdial,n(hangit),Hangup

;--== end of [ext-trunk] ==--;


[from-trunk-sip-1002]
include => from-trunk-sip-1002-custom
exten => _.,1,Set(GROUP()=OUT_3)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-1002] ==--;


[from-trunk-sip-1001]
include => from-trunk-sip-1001-custom
exten => _.,1,Set(GROUP()=OUT_4)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-1001] ==--;


[from-trunk-sip-1004]
include => from-trunk-sip-1004-custom
exten => _.,1,Set(GROUP()=OUT_5)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-1004] ==--;


[from-trunk-sip-1008]
include => from-trunk-sip-1008-custom
exten => _.,1,Set(GROUP()=OUT_7)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-1008] ==--;


[sub-flp-2]
include => sub-flp-2-custom
exten => s,1,ExecIf($[${REGEX("^[0-9#\\*\\+]+$" ${DIAL_NUMBER})} = 1]?Return())
exten => s,n,Return()
exten => s,n(match),Set(DIAL_NUMBER=${TARGET_FLP_2})
exten => s,n,Return()

;--== end of [sub-flp-2] ==--;


[sub-flp-3]
include => sub-flp-3-custom
exten => s,1,ExecIf($[${REGEX("^[0-9#\\*\\+]+$" ${DIAL_NUMBER})} = 1]?Return())
exten => s,n,Return()
exten => s,n(match),Set(DIAL_NUMBER=${TARGET_FLP_3})
exten => s,n,Return()

;--== end of [sub-flp-3] ==--;


[sub-flp-4]
include => sub-flp-4-custom
exten => s,1,ExecIf($[${REGEX("^[0-9#\\*\\+]+$" ${DIAL_NUMBER})} = 1]?Return())
exten => s,n,Return()
exten => s,n(match),Set(DIAL_NUMBER=${TARGET_FLP_4})
exten => s,n,Return()

;--== end of [sub-flp-4] ==--;


[sub-flp-5]
include => sub-flp-5-custom
exten => s,1,ExecIf($[${REGEX("^[0-9#\\*\\+]+$" ${DIAL_NUMBER})} = 1]?Return())
exten => s,n,Return()
exten => s,n(match),Set(DIAL_NUMBER=${TARGET_FLP_5})
exten => s,n,Return()

;--== end of [sub-flp-5] ==--;


[sub-record-cancel]
include => sub-record-cancel-custom
exten => s,1,Set(__REC_POLICY_MODE=${REC_POLICY_MODE_SAVE})
exten => s,n,ExecIf($["${REC_STATUS}"!="RECORDING"]?Return())
exten => s,n,StopMixMonitor()
exten => s,n,Set(__REC_STATUS=)
exten => s,n,Set(MON_BASE=${IF($[${LEN(${MIXMON_DIR})}]?${MIXMON_DIR}:${ASTSPOOLDIR}/monitor/)}${YEAR}/${MONTH}/${DAY}/)
exten => s,n,Set(__MON_FMT=${IF($[${LEN(${MIXMON_FORMAT})}]?${IF($["${MIXMON_FORMAT}"="wav49"]?WAV:${MIXMON_FORMAT})}:wav)})
exten => s,n,ExecIf($[${LEN(${CALLFILENAME})} & ${STAT(f,${MON_BASE}${CALLFILENAME}.${MON_FMT})}]?System(rm -f ${MON_BASE}${CALLFILENAME}.${MON_FMT}))
exten => s,n,Set(__CALLFILENAME=)
exten => s,n,Set(CDR(recordingfile)=)
exten => s,n,Return()

;--== end of [sub-record-cancel] ==--;


[sub-record-check]
include => sub-record-check-custom
exten => s,1,Set(REC_POLICY_MODE_SAVE=${REC_POLICY_MODE})
exten => s,n,GotoIf($["${BLINDTRANSFER}" = ""]?check)
exten => s,n,ResetCDR()
exten => s,n,GotoIf($["${REC_STATUS}" != "RECORDING"]?check)
exten => s,n,Set(AUDIOHOOK_INHERIT(MixMonitor)=yes)
exten => s,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MIXMON_FORMAT},a,${MIXMON_POST})
exten => s,n(check),Set(__MON_FMT=${IF($["${MIXMON_FORMAT}"="wav49"]?WAV:${MIXMON_FORMAT})})
exten => s,n,GotoIf($["${REC_STATUS}"!="RECORDING"]?next)
exten => s,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => s,n,Return()
exten => s,n(next),ExecIf($[!${LEN(${ARG1})}]?Return())
exten => s,n,ExecIf($["${REC_POLICY_MODE}"="" & "${ARG3}"!=""]?Set(__REC_POLICY_MODE=${ARG3}))
exten => s,n,GotoIf($["${REC_STATUS}"!=""]?${ARG1},1)
exten => s,n,Set(__REC_STATUS=INITIALIZED)
exten => s,n,Set(NOW=${EPOCH})
exten => s,n,Set(__DAY=${STRFTIME(${NOW},,%d)})
exten => s,n,Set(__MONTH=${STRFTIME(${NOW},,%m)})
exten => s,n,Set(__YEAR=${STRFTIME(${NOW},,%Y)})
exten => s,n,Set(__TIMESTR=${YEAR}${MONTH}${DAY}-${STRFTIME(${NOW},,%H%M%S)})
exten => s,n,Set(__FROMEXTEN=${IF($[${LEN(${AMPUSER})}]?${AMPUSER}:${IF($[${LEN(${REALCALLERIDNUM})}]?${REALCALLERIDNUM}:unknown)})})
exten => s,n,Set(__CALLFILENAME=${ARG1}-${ARG2}-${FROMEXTEN}-${TIMESTR}-${UNIQUEID})
exten => s,n,Goto(${ARG1},1)

exten => rg,1,GosubIf($["${REC_POLICY_MODE}"="always"]?record,1(${EXTEN},${REC_POLICY_MODE},${FROMEXTEN}))
exten => rg,n,Return()

exten => force,1,GosubIf($["${REC_POLICY_MODE}"="always"]?record,1(${EXTEN},${REC_POLICY_MODE},${FROMEXTEN}))
exten => force,n,Return()

exten => q,1,GosubIf($["${REC_POLICY_MODE}"="always"]?recq,1(${EXTEN},${ARG2},${FROMEXTEN}))
exten => q,n,Return()

exten => out,1,ExecIf($["${REC_POLICY_MODE}"=""]?Set(__REC_POLICY_MODE=${DB(AMPUSER/${FROMEXTEN}/recording/out/external)}))
exten => out,n,GosubIf($["${REC_POLICY_MODE}"="always"]?record,1(exten,${ARG2},${FROMEXTEN}))
exten => out,n,Return()

exten => exten,1,GotoIf($["${REC_POLICY_MODE}"!=""]?callee)
exten => exten,n,Set(__REC_POLICY_MODE=${IF($[${LEN(${FROM_DID})}]?${DB(AMPUSER/${ARG2}/recording/in/external)}:${DB(AMPUSER/${ARG2}/recording/in/internal)})})
exten => exten,n,GotoIf($["${REC_POLICY_MODE}"="dontcare"]?caller)
exten => exten,n,GotoIf($["${DB(AMPUSER/${FROMEXTEN}/recording/out/internal)}"="dontcare" | "${FROM_DID}"!=""]?callee)
exten => exten,n,ExecIf($[${LEN(${DB(AMPUSER/${FROMEXTEN}/recording/priority)})}]?Set(CALLER_PRI=${DB(AMPUSER/${FROMEXTEN}/recording/priority)}):Set(CALLER_PRI=0))
exten => exten,n,ExecIf($[${LEN(${DB(AMPUSER/${ARG2}/recording/priority)})}]?Set(CALLEE_PRI=${DB(AMPUSER/${ARG2}/recording/priority)}):Set(CALLEE_PRI=0))
exten => exten,n,GotoIf($["${CALLER_PRI}"="${CALLEE_PRI}"]?${REC_POLICY}:${IF($[${CALLER_PRI}>${CALLEE_PRI}]?caller:callee)})
exten => exten,n(callee),GosubIf($["${REC_POLICY_MODE}"="always"]?record,1(${EXTEN},${ARG2},${FROMEXTEN}))
exten => exten,n,Return()
exten => exten,n(caller),Set(__REC_POLICY_MODE=${DB(AMPUSER/${FROMEXTEN}/recording/out/internal)})
exten => exten,n,GosubIf($["${REC_POLICY_MODE}"="always"]?record,1(${EXTEN},${ARG2},${FROMEXTEN}))
exten => exten,n,Return()

exten => conf,1,Gosub(recconf,1(${EXTEN},${ARG2},${ARG2}))
exten => conf,n,Return()

exten => page,1,GosubIf($["${REC_POLICY_MODE}"="always"]?recconf,1(${EXTEN},${ARG2},${FROMEXTEN}))
exten => page,n,Return()

exten => record,1,Set(AUDIOHOOK_INHERIT(MixMonitor)=yes)
exten => record,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MIXMON_FORMAT},,${MIXMON_POST})
exten => record,n,Set(__REC_STATUS=RECORDING)
exten => record,n,Set(CDR(recordingfile)=${ASTSPOOLDIR}/monitor/${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT})
;exten => record,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => record,n,Return()

exten => recq,1,Set(AUDIOHOOK_INHERIT(MixMonitor)=yes)
exten => recq,n,Set(MONITOR_FILENAME=${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME})
exten => recq,n,MixMonitor(${MONITOR_FILENAME}.${MIXMON_FORMAT},${MONITOR_OPTIONS},${MIXMON_POST})
exten => recq,n,Set(__REC_STATUS=RECORDING)
exten => recq,n,Set(CDR(recordingfile)=${ASTSPOOLDIR}/monitor/${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT})
;exten => recq,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => recq,n,Return()

exten => recconf,1,Set(__CALLFILENAME=${IF($[${MEETME_INFO(parties,${ARG2})}]?${DB(RECCONF/${ARG2})}:${ARG1}-${ARG2}-${ARG3}-${TIMESTR}-${UNIQUEID})})
exten => recconf,n,ExecIf($[!${MEETME_INFO(parties,${ARG2})}]?Set(DB(RECCONF/${ARG2})=${CALLFILENAME}))
exten => recconf,n,Set(MEETME_RECORDINGFILE=${IF($[${LEN(${MIXMON_DIR})}]?${MIXMON_DIR}:${ASTSPOOLDIR}/monitor/)}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME})
exten => recconf,n,Set(MEETME_RECORDINGFORMAT=${MIXMON_FORMAT})
exten => recconf,n,ExecIf($["${REC_POLICY_MODE}"!="always"]?Return())
exten => recconf,n,Set(__REC_STATUS=RECORDING)
exten => recconf,n,Set(CDR(recordingfile)=${ASTSPOOLDIR}/monitor/${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT})
;exten => recconf,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => recconf,n,Return()

;--== end of [sub-record-check] ==--;


[macro-one-touch-record]
include => macro-one-touch-record-custom
exten => s,1,Set(ONETOUCH_REC_SCRIPT_STATUS=)
exten => s,n,System(/var/lib/asterisk/bin/one_touch_record.php ${CHANNEL(name)})
exten => s,n,Noop(ONETOUCH_REC_SCRIPT_STATUS: [${ONETOUCH_REC_SCRIPT_STATUS}])
exten => s,n,ExecIf($["${ONETOUCH_REC}"="RECORDING"]?Playback(beep))
exten => s,n,ExecIf($["${ONETOUCH_REC}"="PAUSED"]?Playback(beep&beep))
exten => s,n,MacroExit()

;--== end of [macro-one-touch-record] ==--;


[macro-prepend-cid]
include => macro-prepend-cid-custom
exten => s,1,GotoIf($["${RGPREFIX}" = ""]?REPCID)
exten => s,n,GotoIf($["${RGPREFIX}" != "${CALLERID(name):0:${LEN(${RGPREFIX})}}"]?REPCID)
exten => s,n,Set(CALLERID(name)=${CALLERID(name):${LEN(${RGPREFIX})}})
exten => s,n,Set(_RGPREFIX=)
exten => s,n(REPCID),Set(_RGPREFIX=${ARG1})
exten => s,n,Set(CALLERID(name)=${RGPREFIX}${CALLERID(name)})

;--== end of [macro-prepend-cid] ==--;


[outbound-allroutes]
include => outbound-allroutes-custom
include => outrt-1 ; 9_outside
include => outrt-2 ; OUTGOING
include => outrt-3 ; outtest
include => outrt-4 ; SalesOut
exten => foo,1,Noop(bar)

;--== end of [outbound-allroutes] ==--;


[outrt-1] ; 9_outside
include => outrt-1-custom
exten => _.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _.,n,Set(_NODEST=)
exten => _.,n,Gosub(sub-record-check,s,1(out,${EXTEN},))
exten => _.,n,Macro(dialout-trunk,4,${EXTEN},,off)
exten => _.,n,Macro(outisbusy,)

;--== end of [outrt-1] ==--;


[outrt-2] ; OUTGOING
include => outrt-2-custom
exten => _.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _.,n,Set(_NODEST=)
exten => _.,n,Gosub(sub-record-check,s,1(out,${EXTEN},))
exten => _.,n,Macro(dialout-trunk,4,${EXTEN},,off)
exten => _.,n,Macro(outisbusy,)

;--== end of [outrt-2] ==--;


[outrt-3] ; outtest
include => outrt-3-custom
exten => _.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _.,n,Set(_NODEST=)
exten => _.,n,Gosub(sub-record-check,s,1(out,${EXTEN},))
exten => _.,n,Macro(dialout-trunk,4,${EXTEN},,off)
exten => _.,n,Macro(outisbusy,)

;--== end of [outrt-3] ==--;


[outrt-4] ; SalesOut
include => outrt-4-custom
exten => _.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _.,n,Set(_NODEST=)
exten => _.,n,Gosub(sub-record-check,s,1(out,${EXTEN},))
exten => _.,n,Macro(dialout-trunk,4,${EXTEN},,off)
exten => _.,n,Macro(outisbusy,)

;--== end of [outrt-4] ==--;


[app-blackhole]
include => app-blackhole-custom
exten => hangup,1,Noop(Blackhole Dest: Hangup)
exten => hangup,n,Set(CDR(customer_id)=${customer_id})
exten => hangup,n,Set(CDR(hangup_desc)=Abandoned)
exten => hangup,n,Set(CDR(hangup_code)=101)
exten => hangup,n,Hangup

exten => zapateller,1,Noop(Blackhole Dest: Play SIT Tone)
exten => zapateller,n,Answer
exten => zapateller,n,Zapateller()

exten => musiconhold,1,Noop(Blackhole Dest: Put caller on hold forever)
exten => musiconhold,n,Answer
exten => musiconhold,n,MusicOnHold()

exten => congestion,1,Noop(Blackhole Dest: Congestion)
exten => congestion,n,Playtones(congestion)
exten => congestion,n,Congestion(20)
exten => congestion,n,Hangup

exten => busy,1,Noop(Blackhole Dest: Busy)
exten => busy,n,Busy(20)
exten => busy,n,Hangup

exten => ring,1,Noop(Blackhole Dest: Ring)
exten => ring,n,Answer
exten => ring,n,Playtones(ring)
exten => ring,n,Wait(300)
exten => ring,n,Hangup

;--== end of [app-blackhole] ==--;


[bad-number]
include => bad-number-custom
exten => _X.,1,ResetCDR()
exten => _X.,n,NoCDR()
exten => _X.,n,Progress
exten => _X.,n,Wait(1)
exten => _X.,n,Progress
exten => _X.,n,Playback(silence/1&cannot-complete-as-dialed&check-number-dial-again,noanswer)
exten => _X.,n,Wait(1)
exten => _X.,n,Congestion(20)
exten => _X.,n,Hangup

;--== end of [bad-number] ==--;


[sub-presencestate-display]
include => sub-presencestate-display-custom
exten => s,1,Goto(state-${TOLOWER(${PRESENCE_STATE(CustomPresence:${ARG1},value)})},1)

exten => state-available,1,Set(PRESENCESTATE_DISPLAY=(Available))
exten => state-available,n,Return()

exten => state-chat,1,Set(PRESENCESTATE_DISPLAY=(Chatty))
exten => state-chat,n,Return()

exten => state-away,1,Set(PRESENCESTATE_DISPLAY=(Away))
exten => state-away,n,Return()

exten => state-dnd,1,Set(PRESENCESTATE_DISPLAY=(DND))
exten => state-dnd,n,Return()

exten => state-xa,1,Set(PRESENCESTATE_DISPLAY=(Extended Away))
exten => state-xa,n,Return()

exten => state-unavailable,1,Set(PRESENCESTATE_DISPLAY=(Unavailable))
exten => state-unavailable,n,Return()

exten => _state-.,1,Set(PRESENCESTATE_DISPLAY=)
exten => _state-.,n,Return()

exten => state-,1,Set(PRESENCESTATE_DISPLAY=)
exten => state-,n,Return()

;--== end of [sub-presencestate-display] ==--;


[macro-confirm]
include => macro-confirm-custom
exten => s,1,Set(LOOPCOUNT=0)
exten => s,n,Set(__MACRO_RESULT=ABORT)
exten => s,n,Set(MSG1=${IF($["${ARG1}${ALT_CONFIRM_MSG}"=""]?incoming-call-1-accept-2-decline:${IF($[${LEN(${ALT_CONFIRM_MSG})}>0]?${ALT_CONFIRM_MSG}:${ARG1})})})
exten => s,n(start),Background(${MSG1},m,${CHANNEL(language)},macro-confirm)
exten => s,n,Read(INPUT,,1,,,4)
exten => s,n,GotoIf($[${LEN(${INPUT})} > 0]?${INPUT},1:t,1)

exten => 1,1,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => 1,n,Noop(Deleting: RG/${ARG3}/${UNIQCHAN} ${DB_DELETE(RG/${ARG3}/${UNIQCHAN})})
exten => 1,n,Macro(blkvm-clr,)
exten => 1,n,Set(SHARED(ANSWER_STATUS,${FORCE_CONFIRM})=)
exten => 1,n(skip),Set(__MACRO_RESULT=)
exten => 1,n,ExecIf($[("${MOHCLASS}"!="default") & ("${MOHCLASS}"!="")]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 1,n(exitopt1),MacroExit()

exten => 2,1,Goto(noanswer,1)

exten => 3,1,SayDigits(${CALLCONFIRMCID})
exten => 3,n,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1:s,start)

exten => t,1,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => t,n,Set(LOOPCOUNT=$[ ${LOOPCOUNT} + 1 ])
exten => t,n,GotoIf($[ ${LOOPCOUNT} < 5 ]?s,start:noanswer,1)

exten => _X,1,Background(invalid,m,${CHANNEL(language)},macro-confirm)
exten => _X,n,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" | "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => _X,n,Set(LOOPCOUNT=$[ ${LOOPCOUNT} + 1 ])
exten => _X,n,GotoIf($[ ${LOOPCOUNT} < 5 ]?s,start:noanswer,1)

exten => noanswer,1,Set(__MACRO_RESULT=ABORT)
exten => noanswer,n(exitnoanswer),MacroExit()

exten => toolate,1,Set(MSG2=${IF($["foo${ARG2}" != "foo"]?${ARG2}:"incoming-call-no-longer-avail")})
exten => toolate,n,Playback(${MSG2})
exten => toolate,n,Set(__MACRO_RESULT=ABORT)
exten => toolate,n(exittoolate),MacroExit()

exten => h,1,Macro(hangupcall,)

;--== end of [macro-confirm] ==--;


[macro-auto-confirm]
include => macro-auto-confirm-custom
exten => s,1,Set(__MACRO_RESULT=)
exten => s,n,Set(CFIGNORE=)
exten => s,n,Set(MASTER_CHANNEL(CFIGNORE)=)
exten => s,n,Set(FORWARD_CONTEXT=from-internal)
exten => s,n,Set(MASTER_CHANNEL(FORWARD_CONTEXT)=from-internal)
exten => s,n,Macro(blkvm-clr,)
exten => s,n,Noop(Deleting: RG/${ARG1}/${UNIQCHAN} ${DB_DELETE(RG/${ARG1}/${UNIQCHAN})})
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(num))=${DIALEDPEERNUMBER}))
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(name))=${DB(AMPUSER/${DIALEDPEERNUMBER}/cidname)}))

;--== end of [macro-auto-confirm] ==--;


[macro-auto-blkvm]
include => macro-auto-blkvm-custom
exten => s,1,Set(__MACRO_RESULT=)
exten => s,n,Set(CFIGNORE=)
exten => s,n,Set(MASTER_CHANNEL(CFIGNORE)=)
exten => s,n,Set(FORWARD_CONTEXT=from-internal)
exten => s,n,Set(MASTER_CHANNEL(FORWARD_CONTEXT)=from-internal)
exten => s,n,Macro(blkvm-clr,)
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(num))=${DIALEDPEERNUMBER}))
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(name))=${DB(AMPUSER/${DIALEDPEERNUMBER}/cidname)}))

;--== end of [macro-auto-blkvm] ==--;


[sub-pincheck]
include => sub-pincheck-custom
exten => s,1,Authenticate(${ARG3},)
exten => s,n,ResetCDR()
exten => s,n,Return()

;--== end of [sub-pincheck] ==--;


[macro-dialout-trunk]
include => macro-dialout-trunk-custom
exten => s,1,Set(DIAL_TRUNK=${ARG1})
exten => s,n,GosubIf($[$["${ARG3}" != ""] & $["${DB(AMPUSER/${AMPUSER}/pinless)}" != "NOPASSWD"]]?sub-pincheck,s,1())
exten => s,n,GotoIf($["x${OUTDISABLE_${DIAL_TRUNK}}" = "xon"]?disabletrunk,1)
exten => s,n,Set(DIAL_NUMBER=${ARG2})
exten => s,n,Set(DIAL_TRUNK_OPTIONS=${DIAL_OPTIONS})
exten => s,n,Set(OUTBOUND_GROUP=OUT_${DIAL_TRUNK})
exten => s,n,GotoIf($["${OUTMAXCHANS_${DIAL_TRUNK}}foo" = "foo"]?nomax)
exten => s,n,GotoIf($[ ${GROUP_COUNT(OUT_${DIAL_TRUNK})} >= ${OUTMAXCHANS_${DIAL_TRUNK}} ]?chanfull)
exten => s,n(nomax),GotoIf($["${INTRACOMPANYROUTE}" = "YES"]?skipoutcid)
exten => s,n,Set(DIAL_TRUNK_OPTIONS=${IF($["${DB_EXISTS(TRUNK/${DIAL_TRUNK}/dialopts)}" = "1"]?${DB_RESULT}:${TRUNK_OPTIONS})})
exten => s,n,Macro(outbound-callerid,${DIAL_TRUNK})
exten => s,n(skipoutcid),GosubIf($["${PREFIX_TRUNK_${DIAL_TRUNK}}" != ""]?sub-flp-${DIAL_TRUNK},s,1())
exten => s,n,Set(OUTNUM=${OUTPREFIX_${DIAL_TRUNK}}${DIAL_NUMBER})
exten => s,n,Set(custom=${CUT(OUT_${DIAL_TRUNK},:,1)})
exten => s,n,ExecIf($["${MOHCLASS}"!="default" & "${MOHCLASS}"!="" & "${FORCE_CONFIRM}"="" ]?Set(DIAL_TRUNK_OPTIONS=M(setmusic^${MOHCLASS})${DIAL_TRUNK_OPTIONS}))
exten => s,n,ExecIf($["${FORCE_CONFIRM}"!="" ]?Set(DIAL_TRUNK_OPTIONS=${DIAL_TRUNK_OPTIONS}M(confirm)))
exten => s,n(gocall),Macro(dialout-trunk-predial-hook,)
exten => s,n,GotoIf($["${PREDIAL_HOOK_RET}" = "BYPASS"]?bypass,1)
exten => s,n,ExecIf($["${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(CONNECTEDLINE(num,i)=${DIAL_NUMBER}))
exten => s,n,ExecIf($["${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(CONNECTEDLINE(name,i)=CID:${CALLERID(number)}))
exten => s,n,GotoIf($["${custom}" = "AMP"]?customtrunk)
exten => s,n,Dial(${OUT_${DIAL_TRUNK}}/${OUTNUM},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS})
exten => s,n,Noop(Dial failed for some reason with DIALSTATUS = ${DIALSTATUS} and HANGUPCAUSE = ${HANGUPCAUSE})
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,GotoIf($["${ARG4}" = "on"]?continue,1:s-${DIALSTATUS},1)
exten => s,n(customtrunk),Set(pre_num=${CUT(OUT_${DIAL_TRUNK},$,1)})
exten => s,n,Set(the_num=${CUT(OUT_${DIAL_TRUNK},$,2)})
exten => s,n,Set(post_num=${CUT(OUT_${DIAL_TRUNK},$,3)})
exten => s,n,GotoIf($["${the_num}" = "OUTNUM"]?outnum:skipoutnum)
exten => s,n(outnum),Set(the_num=${OUTNUM})
exten => s,n(skipoutnum),Dial(${pre_num:4}${the_num}${post_num},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS})
exten => s,n,Noop(Dial failed for some reason with DIALSTATUS = ${DIALSTATUS} and HANGUPCAUSE = ${HANGUPCAUSE})
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,GotoIf($["${ARG4}" = "on"]?continue,1:s-${DIALSTATUS},1)
exten => s,n(chanfull),Noop(max channels used up)

exten => s-BUSY,1,Noop(Dial failed due to trunk reporting BUSY - giving up)
exten => s-BUSY,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s-BUSY,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s-BUSY,n,Playtones(busy)
exten => s-BUSY,n,Busy(20)

exten => s-ANSWER,1,Noop(Call successfully answered - Hanging up now)
exten => s-ANSWER,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s-ANSWER,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s-ANSWER,n,Macro(hangupcall,)

exten => s-NOANSWER,1,Noop(Dial failed due to trunk reporting NOANSWER - giving up)
exten => s-NOANSWER,n,Progress
exten => s-NOANSWER,n,Playback(number-not-answering,noanswer)
exten => s-NOANSWER,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s-NOANSWER,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s-NOANSWER,n,Congestion(20)

exten => s-INVALIDNMBR,1,Noop(Dial failed due to trunk reporting Address Incomplete - giving up)
exten => s-INVALIDNMBR,n,Progress
exten => s-INVALIDNMBR,n,Playback(ss-noservice,noanswer)
exten => s-INVALIDNMBR,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s-INVALIDNMBR,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s-INVALIDNMBR,n,Busy(20)

exten => s-CHANGED,1,Noop(Dial failed due to trunk reporting Number Changed - giving up)
exten => s-CHANGED,n,Playtones(busy)
exten => s-CHANGED,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s-CHANGED,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s-CHANGED,n,Busy(20)

exten => _s-.,1,Set(RC=${IF($[${ISNULL(${HANGUPCAUSE})}]?0:${HANGUPCAUSE})})
exten => _s-.,n,Goto(${RC},1)

exten => 17,1,Goto(s-BUSY,1)

exten => 18,1,Goto(s-NOANSWER,1)

exten => 22,1,Goto(s-CHANGED,1)

exten => 23,1,Goto(s-CHANGED,1)

exten => 28,1,Goto(s-INVALIDNMBR,1)

exten => _X,1,Goto(continue,1)

exten => _X.,1,Goto(continue,1)

exten => continue,1(noreport),Noop(TRUNK Dial failed due to ${DIALSTATUS} HANGUPCAUSE: ${HANGUPCAUSE} - failing through to other trunks)
exten => continue,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => continue,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => continue,n,Set(CALLERID(number)=${AMPUSER})

exten => disabletrunk,1,Noop(TRUNK: ${OUT_${DIAL_TRUNK}} DISABLED - falling through to next trunk)

exten => bypass,1,Noop(TRUNK: ${OUT_${DIAL_TRUNK}} BYPASSING because dialout-trunk-predial-hook)
exten => bypass,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => bypass,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => bypass,n,Macro(hangupcall,)

exten => h,1,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => h,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => h,n,Macro(hangupcall,)

;--== end of [macro-dialout-trunk] ==--;


[macro-privacy-mgr]
include => macro-privacy-mgr-custom
exten => s,1,Set(KEEPCID=${CALLERID(num)})
exten => s,n,Set(TESTCID=${IF($["${CALLERID(num):0:1}"="+"]?${MATH(1+${CALLERID(num):1})}:${MATH(1+${CALLERID(num)})})})
exten => s,n,ExecIf($[${LEN(${TESTCID})}=0]?Set(CALLERID(num)=))
exten => s,n,PrivacyManager(${ARG1},${ARG2})
exten => s,n,GotoIf($["${PRIVACYMGRSTATUS}"="FAILED"]?fail)
exten => s,n,GosubIf($["${CALLED_BLACKLIST}"="1"]?app-blacklist-check,s,1())
exten => s,n,Set(CALLERID(num-pres)=allowed_passed_screen)
exten => s,n,MacroExit()
exten => s,n(fail),Noop(STATUS: ${PRIVACYMGRSTATUS} CID: ${CALLERID(num)} ${CALLERID(name)} CALLPRES: ${CALLLINGPRES})
exten => s,n,Playback(sorry-youre-having-problems&goodbye)
exten => s,n,Playtones(congestion)
exten => s,n,Congestion(20)

exten => h,1,Hangup

;--== end of [macro-privacy-mgr] ==--;


[macro-user-callerid]
include => macro-user-callerid-custom
exten => s,1,Set(TOUCH_MONITOR=${UNIQUEID})
exten => s,n,NoOp(${customer_id})
exten => s,n,Set(CDR(customer_id)=${customer_id})
exten => s,n,NoOp(${loan_id})
exten => s,n,Set(CDR(loan_id)=${loan_id})
exten => s,n,NoOp(${agent_id})
exten => s,n,Set(CDR(agent_id)=${agent_id})
exten => s,n,Set(CDR(call_type)=${call_type})
exten => s,n,Set(CDR(lead_id)=${lead_id})
exten => s,n,Set(CDR(source)=${source})
exten => s,n,Set(CDR(campaign_id)=${campaign_id})
exten => s,n,Set(AMPUSER=${IF($["${AMPUSER}" = ""]?${CALLERID(number)}:${AMPUSER})})
exten => s,n,GotoIf($["${CUT(CHANNEL,@,2):5:5}"="queue" | ${LEN(${AMPUSERCIDNAME})}]?report)
exten => s,n,ExecIf($["${REALCALLERIDNUM:1:2}" = ""]?Set(REALCALLERIDNUM=${CALLERID(number)}))
exten => s,n,Set(AMPUSER=${DB(DEVICE/${REALCALLERIDNUM}/user)})
exten => s,n,GotoIf($["${AMPUSER}" = "none"]?limit)
exten => s,n,Set(AMPUSERCIDNAME=${DB(AMPUSER/${AMPUSER}/cidname)})
exten => s,n,GotoIf($["${AMPUSERCIDNAME:1:2}" = ""]?report)
exten => s,n,Set(AMPUSERCID=${IF($["${ARG2}" != "EXTERNAL" & "${DB_EXISTS(AMPUSER/${AMPUSER}/cidnum)}" = "1"]?${DB_RESULT}:${AMPUSER})})
exten => s,n,Set(__DIAL_OPTIONS=${IF($["${DB_EXISTS(AMPUSER/${AMPUSER}/dialopts)}" = "1"]?${DB_RESULT}:${DIAL_OPTIONS})})
exten => s,n,Set(CALLERID(all)="${AMPUSERCIDNAME}" <${AMPUSERCID}>)
exten => s,n,GotoIf($["${ARG1}"="LIMIT" & ${LEN(${AMPUSER})} & "${DB(AMPUSER/${AMPUSER}/concurrency_limit)}">"0" & "${GROUP_COUNT(${AMPUSER}@concurrency_limit)}">="${DB(AMPUSER/${AMPUSER}/concurrency_limit)}"]?limit)
exten => s,n,ExecIf($["${ARG1}"="LIMIT" & ${LEN(${AMPUSER})}]?Set(GROUP(concurrency_limit)=${AMPUSER}))
exten => s,n,ExecIf($["${DB(AMPUSER/${AMPUSER}/language)}" != ""]?Set(CHANNEL(language)=${DB(AMPUSER/${AMPUSER}/language)}))
exten => s,n(report),GotoIf($[ "${ARG1}" = "SKIPTTL" | "${ARG1}" = "LIMIT" ]?continue)
exten => s,n(report2),Set(__TTL=${IF($["foo${TTL}" = "foo"]?64:$[ ${TTL} - 1 ])})
exten => s,n,GotoIf($[ ${TTL} > 0 ]?continue)
exten => s,n,Wait(${RINGTIMER})
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n,Playback(im-sorry&an-error-has-occured&with&call-forwarding)
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,Macro(hangupcall,)
exten => s,n(limit),Answer
exten => s,n,Wait(1)
exten => s,n,Playback(beep&im-sorry&your&simul-call-limit-reached&goodbye)
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,Macro(hangupcall,)
exten => s,n,Congestion(20)
exten => s,n(continue),Set(CALLERID(number)=${CALLERID(number):0:40})
exten => s,n,Set(CALLERID(name)=${CALLERID(name):0:40})
exten => s,n,Set(CDR(cnum)=${CALLERID(num)})
exten => s,n,Set(CDR(cnam)=${CALLERID(name)})
exten => s,n,Set(CHANNEL(language)=${MASTER_CHANNEL(CHANNEL(language))})

exten => h,1,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => h,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => h,n,Macro(hangupcall,)

;--== end of [macro-user-callerid] ==--;


[macro-outbound-callerid]
include => macro-outbound-callerid-custom
exten => s,1,ExecIf($["${CALLINGPRES_SV}" != ""]?Set(CALLERPRES()=${CALLINGPRES_SV}))
exten => s,n,ExecIf($["${REALCALLERIDNUM:1:2}" = ""]?Set(REALCALLERIDNUM=${CALLERID(number)}))
exten => s,n(start),GotoIf($[ $["${REALCALLERIDNUM}" = ""] | $["${KEEPCID}" != "TRUE"] | $["${OUTKEEPCID_${ARG1}}" = "on"] ]?normcid)
exten => s,n,Set(USEROUTCID=${REALCALLERIDNUM})
exten => s,n,GotoIf($["foo${DB(AMPUSER/${REALCALLERIDNUM}/device)}" = "foo"]?bypass)
exten => s,n(normcid),Set(USEROUTCID=${DB(AMPUSER/${AMPUSER}/outboundcid)})
exten => s,n(bypass),Set(EMERGENCYCID=${DB(DEVICE/${REALCALLERIDNUM}/emergency_cid)})
exten => s,n,Set(TRUNKOUTCID=${OUTCID_${ARG1}})
exten => s,n,GotoIf($["${EMERGENCYROUTE:1:2}" = "" | "${EMERGENCYCID:1:2}" = ""]?trunkcid)
exten => s,n,Set(CALLERID(all)=${EMERGENCYCID})
exten => s,n,Set(CDR(outbound_cnum)=${CALLERID(num)})
exten => s,n,Set(CDR(outbound_cnam)=${CALLERID(name)})
exten => s,n(exit),MacroExit()
exten => s,n(trunkcid),ExecIf($[${LEN(${TRUNKOUTCID})} != 0]?Set(CALLERID(all)=${TRUNKOUTCID}))
exten => s,n(usercid),ExecIf($[${LEN(${USEROUTCID})} != 0]?Set(CALLERID(all)=${USEROUTCID}))
exten => s,n,ExecIf($[${LEN(${TRUNKCIDOVERRIDE})} != 0 | ${LEN(${FORCEDOUTCID_${ARG1}})} != 0]?Set(CALLERID(all)=${IF($[${LEN(${FORCEDOUTCID_${ARG1}})}=0]?${TRUNKCIDOVERRIDE}:${FORCEDOUTCID_${ARG1}})}))
exten => s,n(hidecid),ExecIf($["${CALLERID(name)}"="hidden"]?Set(CALLERPRES()=prohib_passed_screen))
exten => s,n,Set(CDR(outbound_cnum)=${CALLERID(num)})
exten => s,n,Set(CDR(outbound_cnam)=${CALLERID(name)})

;--== end of [macro-outbound-callerid] ==--;


[from-zaptel]
include => from-zaptel-custom
include => from-dahdi
exten => foo,1,Noop(bar)

;--== end of [from-zaptel] ==--;


[from-dahdi]
include => from-dahdi-custom
exten => _X.,1,Set(DID=${EXTEN})
exten => _X.,n,Goto(s,1)

exten => s,1,Noop(Entering from-dahdi with DID == ${DID})
exten => s,n,Ringing()
exten => s,n,Set(DID=${IF($["${DID}"= ""]?s:${DID})})
exten => s,n,Noop(DID is now ${DID})
exten => s,n,GotoIf($["${CHANNEL:0:5}"="DAHDI"]?dahdiok:checkzap)
exten => s,n(checkzap),GotoIf($["${CHANNEL:0:3}"="Zap"]?zapok:neither)
exten => s,n(neither),Goto(from-pstn,${DID},1)
exten => s,n,Macro(Hangupcall,dummy)
exten => s,n(dahdiok),Noop(Is a DAHDi Channel)
exten => s,n,Set(CHAN=${CHANNEL:6})
exten => s,n,Set(CHAN=${CUT(CHAN,-,1)})
exten => s,n,Macro(from-dahdi-${CHAN},${DID},1)
exten => s,n,Noop(Returned from Macro from-dahdi-${CHAN})
exten => s,n,Goto(from-pstn,${DID},1)
exten => s,n(zapok),Noop(Is a Zaptel Channel)
exten => s,n,Set(CHAN=${CHANNEL:4})
exten => s,n,Set(CHAN=${CUT(CHAN,-,1)})
exten => s,n,Macro(from-dahdi-${CHAN},${DID},1)
exten => s,n,Noop(Returned from Macro from-dahdi-${CHAN})
exten => s,n,Goto(from-pstn,${DID},1)

;--== end of [from-dahdi] ==--;


[vm-callme]
include => vm-callme-custom
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n(repeat),Background(${MSG}&silence/2&vm-repeat&vm-starmain)
exten => s,n,WaitExten(15,)

exten => 5,1,Goto(s,repeat)

exten => #,1,Playback(vm-goodbye)
exten => #,n,Hangup

exten => *,1,Macro(get-vmcontext,${MBOX})
exten => *,n,VoiceMailMain(${MBOX}@${VMCONTEXT},s)

exten => i,1,Playback(pm-invalid-option)
exten => i,n,Goto(s,repeat)

exten => t,1,Playback(vm-goodbye)
exten => t,n,Hangup

exten => h,1,Hangup

;--== end of [vm-callme] ==--;


[macro-dial-confirm]
include => macro-dial-confirm-custom
exten => s,1,Set(DB(RG/${ARG4}/${CHANNEL})=RINGING)
exten => s,n,Set(__UNIQCHAN=${CHANNEL})
exten => s,n,Set(USE_CONFIRMATION=TRUE)
exten => s,n,Set(RINGGROUP_INDEX=${ARG4})
exten => s,n,Set(FORCE_CONFIRM=)
exten => s,n,Set(ARG4=)
exten => s,n,Macro(dial,${ARG1},${ARG2},${ARG3})
exten => s,n,Noop(Deleting: RG/${RINGGROUP_INDEX}/${CHANNEL} ${DB_DELETE(RG/${RINGGROUP_INDEX}/${CHANNEL})})
exten => s,n,Set(USE_CONFIRMATION=)
exten => s,n,Set(RINGGROUP_INDEX=)

;--== end of [macro-dial-confirm] ==--;


[macro-setmusic]
include => macro-setmusic-custom
exten => s,1,Set(CHANNEL(musicclass)=${ARG1})

;--== end of [macro-setmusic] ==--;


[macro-block-cf]
include => macro-block-cf-custom
exten => _X.,1,Hangup

exten => s-ANSWER,1,Noop(Call successfully answered - Hanging up now)
exten => s-ANSWER,n,Macro(hangupcall,)

;--== end of [macro-block-cf] ==--;


[macro-vm]
include => macro-vm-custom
exten => s,1,Macro(user-callerid,SKIPTTL)
exten => s,n,Set(VMGAIN=${IF($["foo${VM_GAIN}"!="foo"]?"g(${VM_GAIN})": )})
exten => s,n,Macro(blkvm-check,)
exten => s,n,GotoIf($["${GOSUB_RETVAL}" != "TRUE"]?vmx,1)
exten => s,n,Hangup

exten => vmx,1,Set(MEXTEN=${ARG1})
exten => vmx,n,Set(MMODE=${ARG2})
exten => vmx,n,Set(RETVM=${ARG3})
exten => vmx,n,Set(MODE=${IF($["${MMODE}"="BUSY"]?busy:unavail)})
exten => vmx,n,GotoIf($["${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)}" != "enabled"]?chknomsg)
exten => vmx,n,Set(VM_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/timeout)}" = "1"]?${DB_RESULT}:${VM_OPTS})})
exten => vmx,n(chknomsg),GotoIf($["${MMODE}"="NOMESSAGE"]?s-${MMODE},1)
exten => vmx,n,GotoIf($["${MMODE}" != "DIRECTDIAL"]?notdirect)
exten => vmx,n,Set(MODE=${IF($["${REGEX("[b]" ${VM_DDTYPE})}" = "1"]?busy:${MODE})})
exten => vmx,n(notdirect),Noop(Checking if ext ${MEXTEN} is enabled: ${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)})
exten => vmx,n,GotoIf($["${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)}" != "enabled"]?s-${MMODE},1)
exten => vmx,n,Macro(get-vmcontext,${MEXTEN})
exten => vmx,n,GotoIf($[(${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.wav)} = 1) || (${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.WAV)} = 1)]?tmpgreet)
exten => vmx,n,GotoIf($[(${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE}.wav)} = 0) && (${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE}.WAV)} = 0)]?nofile)
exten => vmx,n,Set(LOOPCOUNT=0)
exten => vmx,n,Set(VMX_REPEAT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/repeat)}" = "1"]?${DB_RESULT}:${VMX_REPEAT})})
exten => vmx,n(vmxtime),Set(VMX_TIMEOUT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timeout)}" = "1"]?${DB_RESULT}:${VMX_TIMEOUT})})
exten => vmx,n(vmxloops),Set(VMX_LOOPS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loops)}" = "1"]?${DB_RESULT}:${VMX_LOOPS})})
exten => vmx,n(vmxanswer),Answer
exten => vmx,n(loopstart),Read(ACTION,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE},1,skip,${VMX_REPEAT},${VMX_TIMEOUT})
exten => vmx,n,GotoIf($["${EXISTS(${ACTION})}" = "1"]?checkopt)
exten => vmx,n(noopt),Noop(Timeout: going to timeout dest)
exten => vmx,n,Set(VMX_OPTS=${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/timeout)})
exten => vmx,n(chktime),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/ext)}" = "0"]?dotime)
exten => vmx,n,Set(VMX_TIMEDEST_EXT=${DB_RESULT})
exten => vmx,n,Set(VMX_TIMEDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/context)}" = "1"]?${DB_RESULT}:${VMX_TIMEDEST_CONTEXT})})
exten => vmx,n(timepri),Set(VMX_TIMEDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/pri)}" = "1"]?${DB_RESULT}:${VMX_TIMEDEST_PRI})})
exten => vmx,n(dotime),Goto(${VMX_TIMEDEST_CONTEXT},${VMX_TIMEDEST_EXT},${VMX_TIMEDEST_PRI})
exten => vmx,n(checkopt),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/ext)}" = "1"]?doopt)
exten => vmx,n,GotoIf($["${ACTION}" = "0"]?o,1)
exten => vmx,n,GotoIf($["${ACTION}" = "*"]?adef,1)
exten => vmx,n,Set(LOOPCOUNT=$[${LOOPCOUNT} + 1])
exten => vmx,n,GotoIf($[${LOOPCOUNT} > ${VMX_LOOPS}]?toomany)
exten => vmx,n,Playback(pm-invalid-option&please-try-again)
exten => vmx,n,Goto(loopstart)
exten => vmx,n(toomany),Noop(Too Many invalid entries, got to invalid dest)
exten => vmx,n,Set(VMX_OPTS=${VMX_OPTS_LOOP})
exten => vmx,n,Set(VMX_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/loops)}" = "1"]?${DB_RESULT}:${VMX_OPTS})})
exten => vmx,n(chkloop),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/ext)}" = "0"]?doloop)
exten => vmx,n,Set(VMX_LOOPDEST_EXT=${DB_RESULT})
exten => vmx,n,Set(VMX_LOOPDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/context)}" = "1"]?${DB_RESULT}:${VMX_LOOPDEST_CONTEXT})})
exten => vmx,n(looppri),Set(VMX_LOOPDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/pri)}" = "1"]?${DB_RESULT}:${VMX_LOOPDEST_PRI})})
exten => vmx,n(doloop),Goto(${VMX_LOOPDEST_CONTEXT},${VMX_LOOPDEST_EXT},${VMX_LOOPDEST_PRI})
exten => vmx,n(doopt),Noop(Got a valid option: ${DB_RESULT})
exten => vmx,n,Set(VMX_EXT=${DB_RESULT})
exten => vmx,n,GotoIf($["${VMX_EXT}" != "dovm"]?getdest)
exten => vmx,n(vmxopts),Set(VMX_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/dovm)}" = "1"]?${DB_RESULT}:${VMX_OPTS_DOVM})})
exten => vmx,n(vmxdovm),Goto(dovm,1)
exten => vmx,n(getdest),Set(VMX_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => vmx,n(vmxpri),Set(VMX_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => vmx,n(vmxgoto),Goto(${VMX_CONTEXT},${VMX_EXT},${VMX_PRI})
exten => vmx,n(nofile),Noop(File for mode: ${MODE} does not exist, SYSTEMSTATUS: ${SYSTEMSTATUS}, going to normal voicemail)
exten => vmx,n,Goto(s-${MMODE},1)
exten => vmx,n(tmpgreet),Noop(Temporary Greeting Detected, going to normal voicemail)
exten => vmx,n,Goto(s-${MMODE},1)

exten => dovm,1,Noop(VMX Timeout - go to voicemail)
exten => dovm,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VMX_OPTS}${VMGAIN})
exten => dovm,n,Goto(exit-${VMSTATUS},1)

exten => s-BUSY,1,Noop(BUSY voicemail)
exten => s-BUSY,n,Macro(get-vmcontext,${MEXTEN})
exten => s-BUSY,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}b${VMGAIN})
exten => s-BUSY,n,Goto(exit-${VMSTATUS},1)

exten => s-NOMESSAGE,1,Noop(NOMESSAGE (beeb only) voicemail)
exten => s-NOMESSAGE,n,Macro(get-vmcontext,${MEXTEN})
exten => s-NOMESSAGE,n,VoiceMail(${MEXTEN}@${VMCONTEXT},s${VM_OPTS}${VMGAIN})
exten => s-NOMESSAGE,n,Goto(exit-${VMSTATUS},1)

exten => s-DIRECTDIAL,1,Noop(DIRECTDIAL voicemail)
exten => s-DIRECTDIAL,n,Macro(get-vmcontext,${MEXTEN})
exten => s-DIRECTDIAL,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}${VM_DDTYPE}${VMGAIN})
exten => s-DIRECTDIAL,n,Goto(exit-${VMSTATUS},1)

exten => _s-.,1,Macro(get-vmcontext,${MEXTEN})
exten => _s-.,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}u${VMGAIN})
exten => _s-.,n,Goto(exit-${VMSTATUS},1)

exten => o,1,Playback(one-moment-please)
exten => o,n,GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/ext)}" = "0"]?doopdef)
exten => o,n,Set(VMX_OPDEST_EXT=${DB_RESULT})
exten => o,n(opcontext),Set(VMX_OPDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => o,n(oppri),Set(VMX_OPDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => o,n,Goto(${VMX_OPDEST_CONTEXT},${VMX_OPDEST_EXT},${VMX_OPDEST_PRI})
exten => o,n(doopdef),GotoIf($["x${OPERATOR_XTN}"="x"]?nooper:from-internal,${OPERATOR_XTN},1)
exten => o,n(nooper),GotoIf($["x${FROM_DID}"="x"]?nodid)
exten => o,n,Dial(Local/${FROM_DID}@from-pstn,)
exten => o,n,Macro(hangup,)
exten => o,n(nodid),Dial(Local/s@from-pstn,)
exten => o,n,Macro(hangup,)

exten => a,1,Macro(get-vmcontext,${MEXTEN})
exten => a,n,GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/ext)}" = "0"]?adef,1)
exten => a,n,Set(VMX_ADEST_EXT=${DB_RESULT})
exten => a,n(acontext),Set(VMX_ADEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => a,n(apri),Set(VMX_ADEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => a,n,Goto(${VMX_ADEST_CONTEXT},${VMX_ADEST_EXT},${VMX_ADEST_PRI})

exten => adef,1,VoiceMailMain(${MEXTEN}@${VMCONTEXT})
exten => adef,n,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => adef,n,Hangup

exten => exit-FAILED,1,Playback(im-sorry&an-error-has-occured)
exten => exit-FAILED,n,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-FAILED,n,Hangup

exten => exit-SUCCESS,1,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-SUCCESS,n,Playback(goodbye)
exten => exit-SUCCESS,n,Hangup

exten => exit-USEREXIT,1,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-USEREXIT,n,Playback(goodbye)
exten => exit-USEREXIT,n,Hangup

exten => exit-RETURN,1,Noop(Returning From Voicemail because macro)

exten => t,1,Hangup

;--== end of [macro-vm] ==--;


[macro-exten-vm]
include => macro-exten-vm-custom
exten => s,1,Macro(user-callerid,)
exten => s,n,Set(RingGroupMethod=none)
exten => s,n,Set(__EXTTOCALL=${ARG2})
exten => s,n,Set(__PICKUPMARK=${ARG2})
exten => s,n,Set(RT=${IF($["${ARG1}"!="novm" | "${DB(CFU/${EXTTOCALL})}"!="" | "${DB(CFB/${EXTTOCALL})}"!="" | "${ARG3}"="1" | "${ARG4}"="1" | "${ARG5}"="1"]?${RINGTIMER}:)})
exten => s,n(checkrecord),Gosub(sub-record-check,s,1(exten,${EXTTOCALL},))
exten => s,n(macrodial),Macro(dial-one,${RT},${DIAL_OPTIONS},${EXTTOCALL})
exten => s,n,Set(SV_DIALSTATUS=${DIALSTATUS})
exten => s,n(calldocfu),GosubIf($[("${SV_DIALSTATUS}"="NOANSWER"|"${SV_DIALSTATUS}"="CHANUNAVAIL") & "${DB(CFU/${EXTTOCALL})}"!="" & "${SCREEN}"=""]?docfu,1())
exten => s,n(calldocfb),GosubIf($["${SV_DIALSTATUS}"="BUSY" & "${DB(CFB/${EXTTOCALL})}"!="" & "${SCREEN}"=""]?docfb,1())
exten => s,n,Set(DIALSTATUS=${SV_DIALSTATUS})
exten => s,n,ExecIf($[("${DIALSTATUS}"="NOANSWER"&"${ARG3}"="1")|("${DIALSTATUS}"="BUSY"&"${ARG4}"="1")|("${DIALSTATUS}"="CHANUNAVAIL"&"${ARG5}"="1")]?MacroExit())
exten => s,n,GotoIf($["${ARG1}"="novm"]?s-${DIALSTATUS},1)
exten => s,n,Macro(vm,${ARG1},${DIALSTATUS},${IVR_RETVM})

exten => docfu,1(docfu),ExecIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG3}"="1")]?StackPop())
exten => docfu,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG3}"="1")]?from-internal,${DB(CFU/${EXTTOCALL})},1)
exten => docfu,n,Set(RTCF=${IF($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="0"]?${RT}:${DB(AMPUSER/${EXTTOCALL}/cfringtimer)})})
exten => docfu,n,Dial(Local/${DB(CFU/${EXTTOCALL})}@from-internal/n,${RTCF},${DIAL_OPTIONS})
exten => docfu,n,Return()

exten => docfb,1(docfu),ExecIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG4}"="1")]?StackPop())
exten => docfb,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG4}"="1")]?from-internal,${DB(CFB/${EXTTOCALL})},1)
exten => docfb,n,Set(RTCF=${IF($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="0"]?${RT}:${DB(AMPUSER/${EXTTOCALL}/cfringtimer)})})
exten => docfb,n,Dial(Local/${DB(CFB/${EXTTOCALL})}@from-internal/n,${RTCF},${DIAL_OPTIONS})
exten => docfb,n,Return()

exten => s-BUSY,1,GotoIf($["${IVR_RETVM}"="RETURN" & "${IVR_CONTEXT}"!=""]?exit,1)
exten => s-BUSY,n,Playtones(busy)
exten => s-BUSY,n,Busy(20)

exten => _s-!,1,GotoIf($["${IVR_RETVM}"="RETURN" & "${IVR_CONTEXT}"!=""]?exit,1)
exten => _s-!,n,Playtones(congestion)
exten => _s-!,n,Congestion(10)

exten => exit,1,Playback(beep&line-busy-transfer-menu&silence/1)
exten => exit,n,MacroExit()

;--== end of [macro-exten-vm] ==--;


[macro-simple-dial]
include => macro-simple-dial-custom
exten => s,1,Set(__EXTTOCALL=${ARG1})
exten => s,n,Set(RT=${ARG2})
exten => s,n,Set(CFUEXT=${DB(CFU/${EXTTOCALL})})
exten => s,n,Set(CFBEXT=${DB(CFB/${EXTTOCALL})})
exten => s,n,Set(CWI_TMP=${CWIGNORE})
exten => s,n(macrodial),Macro(dial-one,${RT},${DIAL_OPTIONS},${EXTTOCALL})
exten => s,n,Set(__CWIGNORE=${CWI_TMP})
exten => s,n,Set(PR_DIALSTATUS=${DIALSTATUS})
exten => s,n(calldocfu),GosubIf($["${PR_DIALSTATUS}"="NOANSWER" & "${CFUEXT}"!=""]?docfu,1())
exten => s,n(calldocfb),GosubIf($["${PR_DIALSTATUS}"="BUSY" & "${CFBEXT}"!=""]?docfb,1())
exten => s,n,Set(DIALSTATUS=${PR_DIALSTATUS})
exten => s,n,Goto(s-${DIALSTATUS},1)

exten => docfu,1,GotoIf($["${DB(AMPUSER/${CFUEXT}/device)}" = "" ]?chlocal)
exten => docfu,n,Dial(Local/${CFUEXT}@ext-local,${RT},${DIAL_OPTIONS})
exten => docfu,n,Return()
exten => docfu,n(chlocal),Dial(Local/${CFUEXT}@from-internal/n,${RT},${DIAL_OPTIONS})
exten => docfu,n,Return()

exten => docfb,1,GotoIf($["${DB(AMPUSER/${CFBEXT}/device)}" = "" ]?chlocal)
exten => docfb,n,Dial(Local/${CFBEXT}@ext-local,${RT},${DIAL_OPTIONS})
exten => docfb,n,Return()
exten => docfb,n(chlocal),Dial(Local/${CFBEXT}@from-internal/n,${RT},${DIAL_OPTIONS})
exten => docfb,n,Return()

exten => _s-.,1,Noop(Extension is reporting ${EXTEN})

;--== end of [macro-simple-dial] ==--;


[macro-blkvm-setifempty]
include => macro-blkvm-setifempty-custom
exten => s,1,GotoIf($[!${EXISTS(${BLKVM_CHANNEL})}]?init)
exten => s,n,Set(GOSUB_RETVAL=${SHARED(BLKVM,${BLKVM_CHANNEL})})
exten => s,n,MacroExit()
exten => s,n(init),Set(__BLKVM_CHANNEL=${CHANNEL})
exten => s,n,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=TRUE)
exten => s,n,Set(GOSUB_RETVAL=TRUE)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-setifempty] ==--;


[macro-blkvm-set]
include => macro-blkvm-set-custom
exten => s,1,ExecIf($[!${EXISTS(${BLKVM_CHANNEL})} | "{ARG1}" = "reset"]?Set(__BLKVM_CHANNEL=${CHANNEL}))
exten => s,n,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=TRUE)
exten => s,n,Set(GOSUB_RETVAL=TRUE)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-set] ==--;


[macro-blkvm-clr]
include => macro-blkvm-clr-custom
exten => s,1,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=)
exten => s,n,Set(GOSUB_RETVAL=)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-clr] ==--;


[macro-blkvm-check]
include => macro-blkvm-check-custom
exten => s,1,Set(GOSUB_RETVAL=${SHARED(BLKVM,${BLKVM_CHANNEL})})
exten => s,n,ExecIf($["${GOSUB_RETVAL}"="" & "${CC_RECALL}"="1"]?Set(GOSUB_RETVAL=TRUE))
exten => s,n,MacroExit()

;--== end of [macro-blkvm-check] ==--;


[macro-hangupcall]
include => macro-hangupcall-custom
exten => s,1(start),GotoIf($["${USE_CONFIRMATION}"="" | "${RINGGROUP_INDEX}"="" | "${CHANNEL}"!="${UNIQCHAN}"]?theend)
exten => s,n(delrgi),Noop(Deleting: RG/${RINGGROUP_INDEX}/${CHANNEL} ${DB_DELETE(RG/${RINGGROUP_INDEX}/${CHANNEL})})
exten => s,n(theend),ExecIf($["${ONETOUCH_RECFILE}"!="" & "${CDR(recordingfile)}"=""]?Set(CDR(recordingfile)=${ONETOUCH_RECFILE}))
exten => s,n,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => s,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => s,n,Hangup
exten => s,n,MacroExit()

;--== end of [macro-hangupcall] ==--;


[macro-dial-one]
include => macro-dial-one-custom
exten => s,1,Set(DEXTEN=${ARG3})
exten => s,n,Set(DIALSTATUS_CW=)
exten => s,n,GosubIf($["${FROM_DID}"!="" & "${SCREEN}"="" & "${DB(AMPUSER/${DEXTEN}/screen)}"!=""]?screen,1())
exten => s,n,GosubIf($["${DB(CF/${DEXTEN})}"!=""]?cf,1())
exten => s,n,GotoIf($["${DEXTEN:-1}"="#" | "${DB(DND/${DEXTEN})}"=""]?skip1)
exten => s,n,Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=BUSY)
exten => s,n(skip1),GotoIf($["${DEXTEN}"=""]?nodial)
exten => s,n,GotoIf($["${DEXTEN:-1}"="#"]?continue)
exten => s,n,Set(EXTHASCW=${IF($["${CWIGNORE}"!=""]? :${DB(CW/${DEXTEN})})})
exten => s,n,GotoIf($["${EXTHASCW}"="" | "${DB(CFB/${DEXTEN})}"!="" | "${DB(CFU/${DEXTEN})}"!=""]?next1:cwinusebusy)
exten => s,n(next1),GotoIf($["${DB(CFU/${DEXTEN})}"!="" & ("${EXTENSION_STATE(${DEXTEN})}"="UNAVAILABLE" | "${EXTENSION_STATE(${DEXTEN})}"="UNKNOWN")]?docfu:skip3)
exten => s,n(docfu),Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=NOANSWER)
exten => s,n,Goto(nodial)
exten => s,n(skip3),GotoIf($["${EXTHASCW}"="" | "${DB(CFB/${DEXTEN})}"!=""]?next2:continue)
exten => s,n(next2),GotoIf($["${EXTENSION_STATE(${DEXTEN})}"="NOT_INUSE" | "${EXTENSION_STATE(${DEXTEN})}"="UNAVAILABLE" | "${EXTENSION_STATE(${DEXTEN})}"="UNKNOWN"]?continue)
exten => s,n,ExecIf($["${DB(CFB/${DEXTEN})}"!="" & "${CFIGNORE}"=""]?Set(DIALSTATUS=BUSY))
exten => s,n,GotoIf($["${EXTHASCW}"!="" | "${DEXTEN:-1}"="#"]?cwinusebusy)
exten => s,n,Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=BUSY)
exten => s,n,Goto(nodial)
exten => s,n(cwinusebusy),GotoIf($["${EXTHASCW}"!="" & "${CWINUSEBUSY}"="true"]?next3:continue)
exten => s,n(next3),ExecIf($["${EXTENSION_STATE(${DEXTEN})}"!="UNAVAILABLE" & "${EXTENSION_STATE(${DEXTEN})}"!="NOT_INUSE" & "${EXTENSION_STATE(${DEXTEN})}"!="UNKNOWN"]?Set(DIALSTATUS_CW=BUSY))
exten => s,n(continue),GotoIf($["${DEXTEN}"=""]?nodial)
exten => s,n,GosubIf($["${DEXTEN:-1}"!="#"]?dstring,1():dlocal,1())
exten => s,n,GotoIf($[${LEN(${DSTRING})}=0]?nodial)
exten => s,n,GotoIf($["${DEXTEN:-1}"="#"]?skiptrace)
exten => s,n,GosubIf($[${REGEX("^[\+]?[0-9]+$" ${CALLERID(number)})} = 1]?ctset,1():ctclear,1())
exten => s,n(skiptrace),Set(D_OPTIONS=${IF($["${NODEST}"!="" & ${REGEX("(M[(]auto-blkvm[)])" ${ARG2})} != 1]?${ARG2}M(auto-blkvm):${ARG2})})
exten => s,n,ExecIf($["${ALERT_INFO}"!=""]?SIPAddHeader(Alert-Info: ${ALERT_INFO}))
exten => s,n,ExecIf($["${SIPADDHEADER}"!=""]?SIPAddHeader(${SIPADDHEADER}))
exten => s,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => s,n,GosubIf($["${QUEUEWAIT}"!=""]?qwait,1())
exten => s,n,Set(__CWIGNORE=${CWIGNORE})
exten => s,n,Set(__KEEPCID=TRUE)
exten => s,n,GotoIf($["${USEGOTO}"="1"]?usegoto,1)
exten => s,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cidname)}" = "" || "${DB(AMPUSER/${AMPUSER}/cidname)}" = ""]?godial)
exten => s,n,Gosub(sub-presencestate-display,s,1(${EXTTOCALL}))
exten => s,n,Set(CONNECTEDLINE(name,i)=${DB(AMPUSER/${EXTTOCALL}/cidname)}${PRESENCESTATE_DISPLAY})
exten => s,n,Set(CONNECTEDLINE(num)=${EXTTOCALL})
exten => s,n,Set(D_OPTIONS=${D_OPTIONS}I)
exten => s,n(godial),Dial(${DSTRING},${ARG1},${D_OPTIONS})
exten => s,n,ExecIf($["${DIALSTATUS}"="ANSWER" & "${CALLER_DEST}"!=""]?MacroExit())
exten => s,n,ExecIf($["${DIALSTATUS_CW}"!=""]?Set(DIALSTATUS=${DIALSTATUS_CW}))
exten => s,n,GosubIf($[("${SCREEN}"!=""&("${DIALSTATUS}"="TORTURE"|"${DIALSTATUS}"="DONTCALL"))|"${DIALSTATUS}"="ANSWER"]?s-${DIALSTATUS},1())
exten => s,n,MacroExit()
exten => s,n(nodial),ExecIf($["${DIALSTATUS}" = ""]?Set(DIALSTATUS=NOANSWER))
exten => s,n,Noop(Returned from dial-one with nothing to call and DIALSTATUS: ${DIALSTATUS})
exten => s,n,MacroExit()

exten => h,1,Macro(hangupcall,)

exten => usegoto,1,Set(USEGOTO=)
exten => usegoto,n,Goto(from-internal,${DSTRING},1)

exten => screen,1,GotoIf($["${DB(AMPUSER/${DEXTEN}/screen)}"!="nomemory" | "${CALLERID(number)}"=""]?memory)
exten => screen,n,ExecIf($[${REGEX("^[0-9a-zA-Z ]+$" ${CALLERID(number)})} = 1]?System(rm -f ${ASTVARLIBDIR}/sounds/priv-callerintros/${CALLERID(number)}.*))
exten => screen,n(memory),Set(__SCREEN=${DB(AMPUSER/${DEXTEN}/screen)})
exten => screen,n,Set(__SCREEN_EXTEN=${DEXTEN})
exten => screen,n,Set(ARG2=${ARG2}p)
exten => screen,n,Return()

exten => cf,1,Set(CFAMPUSER=${IF($["${AMPUSER}"=""]?${CALLERID(number)}:${AMPUSER})})
exten => cf,n,ExecIf($["${DB(CF/${DEXTEN})}"="${CFAMPUSER}" | "${DB(CF/${DEXTEN})}"="${REALCALLERIDNUM}" | "${CUT(CUT(BLINDTRANSFER,-,1),/,1)}" = "${DB(CF/${DEXTEN})}" | "${DEXTEN}"="${DB(CF/${DEXTEN})}"]?Return())
exten => cf,n,ExecIf($["${DB(AMPUSER/${DEXTEN}/cfringtimer)}" != "0" & "${DB(AMPUSER/${DEXTEN}/cfringtimer)}" != ""]?Set(ARG1=${IF($["${DB(AMPUSER/${DEXTEN}/cfringtimer)}"="-1"]? : ${DB(AMPUSER/${DEXTEN}/cfringtimer)})}))
exten => cf,n,Set(DEXTEN=${IF($["${CFIGNORE}"=""]?"${DB(CF/${DEXTEN})}#": )})
exten => cf,n,ExecIf($["${DEXTEN}"!=""]?Return())
exten => cf,n,Set(DIALSTATUS=NOANSWER)
exten => cf,n,Return()

exten => qwait,1,ExecIf($["${SAVEDCIDNAME}" = ""]?Set(__SAVEDCIDNAME=${CALLERID(name)}))
exten => qwait,n,Set(ELAPSED=${MATH($[${EPOCH}+30-${QUEUEWAIT}]/60,int)})
exten => qwait,n,Set(CALLERID(name)=M${ELAPSED}:${SAVEDCIDNAME})
exten => qwait,n,Return()

exten => ctset,1,Set(DB(CALLTRACE/${DEXTEN})=${CALLERID(number)})
exten => ctset,n,Return()

exten => ctclear,1,Noop(Deleting: CALLTRACE/${DEXTEN} ${DB_DELETE(CALLTRACE/${DEXTEN})})
exten => ctclear,n,Return()

exten => dstring,1,Set(DSTRING=)
exten => dstring,n,Set(DEVICES=${DB(AMPUSER/${DEXTEN}/device)})
exten => dstring,n,ExecIf($["${DEVICES}"=""]?Return())
exten => dstring,n,ExecIf($["${DEVICES:0:1}"="&"]?Set(DEVICES=${DEVICES:1}))
exten => dstring,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => dstring,n,Set(ITER=1)
exten => dstring,n(begin),Set(THISDIAL=${DB(DEVICE/${CUT(DEVICES,&,${ITER})}/dial)})
exten => dstring,n,GosubIf($["${ASTCHANDAHDI}" = "1"]?zap2dahdi,1())
exten => dstring,n,Set(DSTRING=${DSTRING}${THISDIAL}&)
exten => dstring,n,Set(ITER=$[${ITER}+1])
exten => dstring,n,GotoIf($[${ITER}<=${LOOPCNT}]?begin)
exten => dstring,n,Set(DSTRING=${DSTRING:0:$[${LEN(${DSTRING})}-1]})
exten => dstring,n,Return()

exten => dlocal,1,Set(DSTRING=${IF($["${ARG1}"=""]?${DEXTEN:0:${MATH(${LEN(${DEXTEN})}-1,int)}}:Local/${DEXTEN:0:${MATH(${LEN(${DEXTEN})}-1,int)}}@from-internal/n)})
exten => dlocal,n,Set(USEGOTO=${IF($["${ARG1}"=""]?1:0)})
exten => dlocal,n,Return()

exten => zap2dahdi,1,ExecIf($["${THISDIAL}" = ""]?Return())
exten => zap2dahdi,n,Set(NEWDIAL=)
exten => zap2dahdi,n,Set(LOOPCNT2=${FIELDQTY(THISDIAL,&)})
exten => zap2dahdi,n,Set(ITER2=1)
exten => zap2dahdi,n(begin2),Set(THISPART2=${CUT(THISDIAL,&,${ITER2})})
exten => zap2dahdi,n,ExecIf($["${THISPART2:0:3}" = "ZAP"]?Set(THISPART2=DAHDI${THISPART2:3}))
exten => zap2dahdi,n,Set(NEWDIAL=${NEWDIAL}${THISPART2}&)
exten => zap2dahdi,n,Set(ITER2=$[${ITER2} + 1])
exten => zap2dahdi,n,GotoIf($[${ITER2} <= ${LOOPCNT2}]?begin2)
exten => zap2dahdi,n,Set(THISDIAL=${NEWDIAL:0:$[${LEN(${NEWDIAL})}-1]})
exten => zap2dahdi,n,Return()

exten => s-TORTURE,1,Goto(app-blackhole,musiconhold,1)
exten => s-TORTURE,n,Macro(hangupcall,)

exten => s-DONTCALL,1,Answer
exten => s-DONTCALL,n,Wait(1)
exten => s-DONTCALL,n,Zapateller()
exten => s-DONTCALL,n,Playback(ss-noservice)
exten => s-DONTCALL,n,Macro(hangupcall,)

exten => s-CHANUNAVAIL,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-CHANUNAVAIL,n,ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-CHANUNAVAIL,n,Return()

exten => s-NOANSWER,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-NOANSWER,n,ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-NOANSWER,n,Return()

exten => s-BUSY,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-BUSY,n,ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-BUSY,n,Return()

;--== end of [macro-dial-one] ==--;


[from-internal-additional]
include => from-internal-additional-custom
include => timeconditions-toggles
include => vmblast-grp
include => app-fax
include => ext-injections
include => ext-queues
include => app-queue-toggle
include => app-queue-caller-count
include => park-hints
include => app-recordings
include => app-blacklist
include => app-callwaiting-cwoff
include => app-callwaiting-cwon
include => app-cf-toggle
include => app-cf-busy-off
include => app-cf-busy-off-any
include => app-cf-busy-on
include => app-cf-busy-prompting-on
include => app-cf-off
include => app-cf-off-any
include => app-cf-on
include => app-cf-prompting-on
include => app-cf-unavailable-off
include => app-cf-unavailable-on
include => app-cf-unavailable-prompt-on
include => app-dnd-off
include => app-dnd-on
include => app-dnd-toggle
include => app-speeddial
include => app-dialvm
include => app-vmmain
include => ext-group
include => grps
include => app-calltrace
include => app-echo-test
include => app-speakextennum
include => app-speakingclock
include => app-pbdirectory
include => app-fmf-toggle
include => ext-findmefollow
include => fmgrps
include => app-dictate-record
include => app-dictate-send
include => app-gabcast
include => ext-meetme
include => app-userlogonoff
include => ext-local-confirm
include => findmefollow-ringallv2
include => app-pickup
include => app-zapbarge
include => app-chanspy
include => ext-test
include => ext-local
include => outbound-allroutes
exten => h,1,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => h,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => h,n,Macro(hangupcall,)

;--== end of [from-internal-additional] ==--;


[from-internal-noxfer-additional]
include => from-internal-noxfer-additional-custom
exten => h,1,Set(CDR(hangup_desc)=${DIALSTATUS})
exten => h,n,Set(CDR(hangup_code)=${HANGUPCAUSE})
exten => h,n,Macro(hangupcall,)

;--== end of [from-internal-noxfer-additional] ==--;


